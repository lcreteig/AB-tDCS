<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="Leon Reteig" />


<title>AB-tDCS</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.6/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.6/js/bootstrap.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
<script src="site_libs/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
<link href="site_libs/clean-0.1/clean.css" rel="stylesheet" />
<script src="site_libs/clean-0.1/clean.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<br>
<br>
<br>
&nbsp;
<p style="text-align: center;"><a href="https://lcreteig.github.io/AB-tDCS">Project website</a></p>
<p style="text-align: center;"> Data and other resources: <a href="https://osf.io/y6hsf/">Open Science Framework</a></p>
<p style="text-align: center;"> Source code: <a href="https://github.com/lcreteig/AB-tDCS">Github</a></p>
&nbsp;
<hr />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>



<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
</style>
<div class="container-fluid main-container">
  <div class="row">
     <div class="col-md-10">



<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-info"></span>
     
    About
  </a>
</li>
<li>
  <a href="AB-tDCS_paper.html">
    <span class="fa fa-newspaper"></span>
     
    Paper
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-file-code"></span>
     
    Analyses
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Individual differences</li>
    <li>
      <a href="AB-tDCS_change-from-baseline.html">Change from baseline</a>
    </li>
    <li>
      <a href="AB-tDCS_anodal-vs-cathodal.html">Anodal vs. cathodal</a>
    </li>
    <li>
      <a href="AB-tDCS_replication-analyses.html">Replication analyses</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Group-level</li>
    <li>
      <a href="AB-tDCS_group.html">Task</a>
    </li>
    <li>
      <a href="AB-tDCS_questionnaires.html">Questionnaires</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/lcreteig/AB-tDCS">
    <span class="fa fa-github"></span>
     
    Source
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->


<div id="header">
<h1 class="title">AB-tDCS</h1>
<h1 class="subtitle">Group-level analyses</h1>
<h4 class="author"><em>Leon Reteig</em></h4>
<h4 class="date"><em>28 May, 2019</em></h4>
</div>

<div id="content">
<div id="setup-environment" class="section level1">
<h1>Setup environment</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># Load packages</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(tidyverse)  <span class="co"># importing, transforming, and visualizing data frames</span></a></code></pre></div>
<pre><code>## ── Attaching packages ──────────────────────────────────────────────────────────────────────────────────────────────────────────────── tidyverse 1.2.1 ──</code></pre>
<pre><code>## ✔ ggplot2 3.1.0       ✔ purrr   0.2.5  
## ✔ tibble  2.1.1       ✔ dplyr   0.8.0.1
## ✔ tidyr   0.8.3       ✔ stringr 1.3.1  
## ✔ readr   1.1.1       ✔ forcats 0.3.0</code></pre>
<pre><code>## Warning: package &#39;tibble&#39; was built under R version 3.5.2</code></pre>
<pre><code>## Warning: package &#39;tidyr&#39; was built under R version 3.5.2</code></pre>
<pre><code>## Warning: package &#39;dplyr&#39; was built under R version 3.5.2</code></pre>
<pre><code>## ── Conflicts ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw">library</span>(here) <span class="co"># (relative) file paths</span></a></code></pre></div>
<pre><code>## here() starts at /Volumes/psychology$/Researchers/reteig/AB_tDCS-EEG</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">library</span>(knitr) <span class="co"># R notebook output</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="kw">library</span>(scales) <span class="co"># Percentage axis labels </span></a></code></pre></div>
<pre><code>## 
## Attaching package: &#39;scales&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     discard</code></pre>
<pre><code>## The following object is masked from &#39;package:readr&#39;:
## 
##     col_factor</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw">library</span>(afex) <span class="co"># analysis of factorial experiments (repeated measures anova)</span></a></code></pre></div>
<pre><code>## Loading required package: lme4</code></pre>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## 
## Attaching package: &#39;Matrix&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:tidyr&#39;:
## 
##     expand</code></pre>
<pre><code>## ************
## Welcome to afex. For support visit: http://afex.singmann.science/</code></pre>
<pre><code>## - Functions for ANOVAs: aov_car(), aov_ez(), and aov_4()
## - Methods for calculating p-values with mixed(): &#39;KR&#39;, &#39;S&#39;, &#39;LRT&#39;, and &#39;PB&#39;
## - &#39;afex_aov&#39; and &#39;mixed&#39; objects can be passed to emmeans() for follow-up tests
## - NEWS: library(&#39;emmeans&#39;) now needs to be called explicitly!
## - Get and set global package options with: afex_options()
## - Set orthogonal sum-to-zero contrasts globally: set_sum_contrasts()
## - For example analyses see: browseVignettes(&quot;afex&quot;)
## ************</code></pre>
<pre><code>## 
## Attaching package: &#39;afex&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:lme4&#39;:
## 
##     lmer</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw">library</span>(emmeans); <span class="kw">afex_options</span>(<span class="dt">emmeans_model =</span> <span class="st">&quot;multivariate&quot;</span>) <span class="co"># post-hoc tests / contrasts, based on multivariate model</span></a>
<a class="sourceLine" id="cb23-2" data-line-number="2"><span class="kw">library</span>(knitrhooks) <span class="co"># printing in rmarkdown outputs</span></a>
<a class="sourceLine" id="cb23-3" data-line-number="3">  <span class="kw">output_max_height</span>()</a>
<a class="sourceLine" id="cb23-4" data-line-number="4"><span class="co"># Source functions</span></a>
<a class="sourceLine" id="cb23-5" data-line-number="5"><span class="kw">source</span>(<span class="kw">here</span>(<span class="st">&quot;src&quot;</span>, <span class="st">&quot;func&quot;</span>, <span class="st">&quot;behavioral_analysis.R&quot;</span>)) <span class="co"># loading data and calculating measures</span></a>
<a class="sourceLine" id="cb23-6" data-line-number="6">load_data_path &lt;-<span class="st"> </span><span class="kw">here</span>(<span class="st">&quot;src&quot;</span>,<span class="st">&quot;func&quot;</span>,<span class="st">&quot;load_data.Rmd&quot;</span>) <span class="co"># for rerunning and displaying</span></a>
<a class="sourceLine" id="cb23-7" data-line-number="7">knitr<span class="op">::</span><span class="kw">read_chunk</span>(<span class="kw">here</span>(<span class="st">&quot;src&quot;</span>, <span class="st">&quot;func&quot;</span>, <span class="st">&quot;behavioral_analysis.R&quot;</span>)) <span class="co"># display code from file in this notebook</span></a></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw">print</span>(<span class="kw">sessionInfo</span>())</a></code></pre></div>
<pre style = "max-height:300px; overflow-y: auto;">## R version 3.5.1 (2018-07-02)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: OS X El Capitan 10.11.6
## 
## Matrix products: default
## BLAS: /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] knitrhooks_0.0.4 emmeans_1.3.0    afex_0.22-1      lme4_1.1-19     
##  [5] Matrix_1.2-14    scales_1.0.0     knitr_1.21       here_0.1        
##  [9] forcats_0.3.0    stringr_1.3.1    dplyr_0.8.0.1    purrr_0.2.5     
## [13] readr_1.1.1      tidyr_0.8.3      tibble_2.1.1     ggplot2_3.1.0   
## [17] tidyverse_1.2.1 
## 
## loaded via a namespace (and not attached):
##  [1] nlme_3.1-137      lubridate_1.7.4   httr_1.3.1       
##  [4] rprojroot_1.3-2   numDeriv_2016.8-1 tools_3.5.1      
##  [7] backports_1.1.3   R6_2.3.0          lazyeval_0.2.1   
## [10] questionr_0.6.3   colorspace_1.3-2  withr_2.1.2      
## [13] tidyselect_0.2.5  curl_3.2          compiler_3.5.1   
## [16] cli_1.0.1         rvest_0.3.2       xml2_1.2.0       
## [19] bookdown_0.9      mvtnorm_1.0-8     digest_0.6.18    
## [22] foreign_0.8-70    minqa_1.2.4       rmarkdown_1.11   
## [25] rio_0.5.10        pkgconfig_2.0.2   htmltools_0.3.6  
## [28] highr_0.7         rlang_0.3.4       readxl_1.1.0     
## [31] rstudioapi_0.8    shiny_1.2.0       generics_0.0.2   
## [34] jsonlite_1.6      zip_2.0.1         car_3.0-2        
## [37] magrittr_1.5      Rcpp_1.0.0        munsell_0.5.0    
## [40] abind_1.4-5       stringi_1.2.4     yaml_2.2.0       
## [43] carData_3.0-2     MASS_7.3-50       plyr_1.8.4       
## [46] grid_3.5.1        parallel_3.5.1    promises_1.0.1   
## [49] crayon_1.3.4      miniUI_0.1.1.1    lattice_0.20-35  
## [52] haven_1.1.2       splines_3.5.1     hms_0.4.2        
## [55] pillar_1.3.1      estimability_1.3  reshape2_1.4.3   
## [58] glue_1.3.0        evaluate_0.12     data.table_1.11.8
## [61] modelr_0.1.2      rmdformats_0.3.3  nloptr_1.2.1     
## [64] httpuv_1.4.5      cellranger_1.1.0  gtable_0.2.0     
## [67] assertthat_0.2.0  xfun_0.4          openxlsx_4.1.0   
## [70] mime_0.6          xtable_1.8-4      broom_0.5.1      
## [73] coda_0.19-2       later_0.7.5       lmerTest_3.0-1
</pre>
</div>
<div id="load-task-data" class="section level1">
<h1>Load task data</h1>
<div id="study-2" class="section level2">
<h2>Study 2</h2>
<p>The following participants are excluded from further analysis at this point, because of incomplete data:</p>
<ul>
<li><code>S03</code>, <code>S14</code>, <code>S29</code>, <code>S38</code>, <code>S43</code>, <code>S46</code>: their T1 performance in session 1 was less than 63% correct, so they were not invited back. This cutoff was determined based on a separate pilot study with 10 participants. It is two standard deviations below the mean of that sample.</li>
<li><code>S25</code> has no data for session 2, as they stopped responding to requests for scheduling the session</li>
<li><code>S31</code> was excluded as a precaution after session 1, as they developed a severe headache and we could not rule out the possibility this was related to the tDCS</li>
</ul>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">dataDir_study2 &lt;-<span class="st"> </span><span class="kw">here</span>(<span class="st">&quot;data&quot;</span>) <span class="co"># root folder with AB task data</span></a>
<a class="sourceLine" id="cb25-2" data-line-number="2">subs_incomplete &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;S03&quot;</span>, <span class="st">&quot;S14&quot;</span>, <span class="st">&quot;S25&quot;</span>, <span class="st">&quot;S29&quot;</span>, <span class="st">&quot;S31&quot;</span>, <span class="st">&quot;S38&quot;</span>, <span class="st">&quot;S43&quot;</span>, <span class="st">&quot;S46&quot;</span>) <span class="co"># don&#39;t try to load data from these participants</span></a>
<a class="sourceLine" id="cb25-3" data-line-number="3">df_study2 &lt;-<span class="st"> </span><span class="kw">load_data_study2</span>(dataDir_study2, subs_incomplete) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb25-4" data-line-number="4"><span class="st">  </span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># discard rows with data from incomplete subjects</span></a>
<a class="sourceLine" id="cb25-5" data-line-number="5"><span class="st">   </span><span class="co"># recode first.session (&quot;anodal&quot; or &quot;cathodal&quot;) to session.order (&quot;anodal first&quot;, &quot;cathodal first&quot;)</span></a>
<a class="sourceLine" id="cb25-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">first.session =</span> <span class="kw">parse_factor</span>(<span class="kw">paste</span>(first.session, <span class="st">&quot;first&quot;</span>), </a>
<a class="sourceLine" id="cb25-7" data-line-number="7">                                      <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;anodal first&quot;</span>, <span class="st">&quot;cathodal first&quot;</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb25-8" data-line-number="8"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">session.order =</span> first.session)</a>
<a class="sourceLine" id="cb25-9" data-line-number="9">n_study2 &lt;-<span class="st"> </span><span class="kw">n_distinct</span>(df_study2<span class="op">$</span>subject) <span class="co"># number of subjects in study 2</span></a></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="kw">kable</span>(<span class="kw">head</span>(df_study2,<span class="dv">13</span>), <span class="dt">digits =</span> <span class="dv">1</span>, <span class="dt">caption =</span> <span class="st">&quot;Data frame for study 2&quot;</span>)</a></code></pre></div>
<table>
<caption>Data frame for study 2</caption>
<thead>
<tr class="header">
<th align="left">subject</th>
<th align="left">session.order</th>
<th align="left">stimulation</th>
<th align="left">block</th>
<th align="left">lag</th>
<th align="right">trials</th>
<th align="right">T1</th>
<th align="right">T2</th>
<th align="right">T2.given.T1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">anodal</td>
<td align="left">pre</td>
<td align="left">3</td>
<td align="right">118</td>
<td align="right">0.8</td>
<td align="right">0.4</td>
<td align="right">0.4</td>
</tr>
<tr class="even">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">anodal</td>
<td align="left">pre</td>
<td align="left">8</td>
<td align="right">60</td>
<td align="right">0.8</td>
<td align="right">0.8</td>
<td align="right">0.8</td>
</tr>
<tr class="odd">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">anodal</td>
<td align="left">tDCS</td>
<td align="left">3</td>
<td align="right">126</td>
<td align="right">0.8</td>
<td align="right">0.3</td>
<td align="right">0.3</td>
</tr>
<tr class="even">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">anodal</td>
<td align="left">tDCS</td>
<td align="left">8</td>
<td align="right">65</td>
<td align="right">0.8</td>
<td align="right">0.7</td>
<td align="right">0.7</td>
</tr>
<tr class="odd">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">anodal</td>
<td align="left">post</td>
<td align="left">3</td>
<td align="right">122</td>
<td align="right">0.8</td>
<td align="right">0.2</td>
<td align="right">0.3</td>
</tr>
<tr class="even">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">anodal</td>
<td align="left">post</td>
<td align="left">8</td>
<td align="right">61</td>
<td align="right">0.7</td>
<td align="right">0.7</td>
<td align="right">0.7</td>
</tr>
<tr class="odd">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">cathodal</td>
<td align="left">pre</td>
<td align="left">3</td>
<td align="right">116</td>
<td align="right">0.8</td>
<td align="right">0.4</td>
<td align="right">0.4</td>
</tr>
<tr class="even">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">cathodal</td>
<td align="left">pre</td>
<td align="left">8</td>
<td align="right">60</td>
<td align="right">0.7</td>
<td align="right">0.8</td>
<td align="right">0.8</td>
</tr>
<tr class="odd">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">cathodal</td>
<td align="left">tDCS</td>
<td align="left">3</td>
<td align="right">129</td>
<td align="right">0.7</td>
<td align="right">0.4</td>
<td align="right">0.4</td>
</tr>
<tr class="even">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">cathodal</td>
<td align="left">tDCS</td>
<td align="left">8</td>
<td align="right">64</td>
<td align="right">0.7</td>
<td align="right">0.8</td>
<td align="right">0.9</td>
</tr>
<tr class="odd">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">cathodal</td>
<td align="left">post</td>
<td align="left">3</td>
<td align="right">128</td>
<td align="right">0.6</td>
<td align="right">0.4</td>
<td align="right">0.4</td>
</tr>
<tr class="even">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">cathodal</td>
<td align="left">post</td>
<td align="left">8</td>
<td align="right">62</td>
<td align="right">0.7</td>
<td align="right">0.8</td>
<td align="right">0.8</td>
</tr>
<tr class="odd">
<td align="left">S02</td>
<td align="left">cathodal first</td>
<td align="left">anodal</td>
<td align="left">pre</td>
<td align="left">3</td>
<td align="right">124</td>
<td align="right">1.0</td>
<td align="right">0.8</td>
<td align="right">0.8</td>
</tr>
</tbody>
</table>
<p>The data has the following columns:</p>
<ul>
<li><strong>subject</strong>: Participant ID, e.g. <code>S01</code>, <code>S12</code></li>
<li><strong>session.order</strong>: Whether participant received <code>anodal</code> or <code>cathodal</code> tDCS in the first session (<code>anodal_first</code> vs. <code>cathodal_first</code>).</li>
<li><strong>stimulation</strong>: Whether participant received <code>anodal</code> or <code>cathodal</code> tDCS</li>
<li><strong>block</strong>: Whether data is before (<code>pre), during (</code>tDCS<code>) or after (</code>post`) tDCS</li>
<li><strong>lag</strong>: Whether T2 followed T1 after two distractors (lag <code>3</code>) or after 7 distractors (lag <code>8</code>)</li>
<li><strong>trials</strong>: Number of trials per lag that the participant completed in this block</li>
<li><strong>T1</strong>: Proportion of trials (out of <code>trials</code>) in which T1 was identified correctly</li>
<li><strong>T2</strong>: Proportion of trials (out of <code>trials</code>) in which T2 was identified correctly</li>
<li><strong>T2.given.T1</strong>: Proportion of trials which T2 was identified correctly, out of the trials in which T1 was idenitified correctly (T2|T1).</li>
</ul>
<p>The number of trials vary from person-to-person, as some completed more trials in a 20-minute block than others (because responses were self-paced):</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">df_study2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb27-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(lag) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb27-3" data-line-number="3"><span class="st">  </span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(trials), <span class="kw">funs</span>(mean, min, max, sd)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb27-4" data-line-number="4"><span class="st">  </span><span class="kw">kable</span>(<span class="dt">caption =</span> <span class="st">&quot;Descriptive statistics for trial counts per lag&quot;</span>, <span class="dt">digits =</span> <span class="dv">0</span>)</a></code></pre></div>
<table>
<caption>Descriptive statistics for trial counts per lag</caption>
<thead>
<tr class="header">
<th align="left">lag</th>
<th align="right">mean</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">3</td>
<td align="right">130</td>
<td align="right">78</td>
<td align="right">163</td>
<td align="right">17</td>
</tr>
<tr class="even">
<td align="left">8</td>
<td align="right">65</td>
<td align="right">39</td>
<td align="right">87</td>
<td align="right">9</td>
</tr>
</tbody>
</table>
</div>
<div id="study-1" class="section level2">
<h2>Study 1</h2>
<p>These data were used for statistical analysis in London &amp; Slagter (2015)<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>, and were processed by the lead author:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1">dataPath_study1 &lt;-<span class="st"> </span><span class="kw">here</span>(<span class="st">&quot;data&quot;</span>,<span class="st">&quot;AB-tDCS_study1.txt&quot;</span>)</a>
<a class="sourceLine" id="cb28-2" data-line-number="2">data_study1_fromDisk &lt;-<span class="st"> </span><span class="kw">read.table</span>(dataPath_study1, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">dec =</span> <span class="st">&quot;,&quot;</span>)</a>
<a class="sourceLine" id="cb28-3" data-line-number="3"><span class="kw">glimpse</span>(data_study1_fromDisk)</a></code></pre></div>
<pre style = "max-height:300px; overflow-y: auto;">## Observations: 34
## Variables: 120
## $ SD_T1                           <dbl> 0.3313, 0.0289, -0.8027, -0.5381…
## $ MeanBLT1Acc                     <dbl> 0.8800, 0.8600, 0.8050, 0.8225, …
## $ First_Session                   <int> 1, 2, 1, 1, 2, 1, 2, 1, 2, 2, 1,…
## $ fileno                          <fct> pp4, pp6, pp7, pp9, pp10, pp11, …
## $ AB_HighLow                      <dbl> 2, 1, 2, 1, 1, 1, 1, 1, 2, 1, 1,…
## $ vb_T1_2_NP                      <dbl> 0.925, 0.875, 0.825, 0.625, 0.65…
## $ vb_T1_4_NP                      <dbl> 0.800, 0.825, 0.825, 0.825, 0.67…
## $ vb_T1_10_NP                     <dbl> 0.925, 0.925, 0.800, 0.775, 0.82…
## $ vb_T1_4_P                       <dbl> 0.850, 0.900, 0.825, 0.775, 0.62…
## $ vb_T1_10_P                      <dbl> 0.825, 0.900, 0.775, 0.825, 0.62…
## $ vb_NB_2_NP                      <dbl> 0.1351, 0.3429, 0.3636, 0.3600, …
## $ vb_NB_4_NP                      <dbl> 0.3125, 0.5455, 0.5455, 0.3030, …
## $ vb_NB_10_NP                     <dbl> 0.8378, 0.8108, 0.9688, 0.6129, …
## $ vb_NB_4_P                       <dbl> 0.2941, 0.5278, 0.6061, 0.3226, …
## $ vb_NB_10_P                      <dbl> 0.8485, 0.7778, 0.9032, 0.8182, …
## $ VB_AB                           <dbl> 0.7027, 0.4680, 0.6051, 0.2529, …
## $ VB_REC                          <dbl> 0.5253, 0.2654, 0.4233, 0.3099, …
## $ VB_PE                           <dbl> -0.0184, -0.0177, 0.0606, 0.0196…
## $ tb_T1_2_NP                      <dbl> 0.775, 0.875, 0.675, 0.725, 0.47…
## $ tb_T1_4_NP                      <dbl> 0.825, 0.825, 0.700, 0.750, 0.67…
## $ tb_T1_10_NP                     <dbl> 0.875, 0.900, 0.700, 0.825, 0.50…
## $ tb_T1_4_P                       <dbl> 0.875, 0.800, 0.700, 0.775, 0.65…
## $ tb_T1_10_P                      <dbl> 0.850, 0.925, 0.800, 0.825, 0.62…
## $ tb_NB_2_NP                      <dbl> 0.1290, 0.5143, 0.2222, 0.0690, …
## $ tb_NB_4_NP                      <dbl> 0.3333, 0.5455, 0.6071, 0.1333, …
## $ tb_NB_10_NP                     <dbl> 0.8286, 0.8611, 0.8571, 0.5152, …
## $ tb_NB_4_P                       <dbl> 0.3143, 0.6250, 0.5357, 0.4839, …
## $ tb_NB_10_P                      <dbl> 0.8529, 0.7568, 0.9375, 0.6667, …
## $ TB_AB                           <dbl> 0.6995, 0.3468, 0.6349, 0.4462, …
## $ TB_REC                          <dbl> 0.4952, 0.3157, 0.2500, 0.3818, …
## $ TB_PE                           <dbl> -0.0190, 0.0795, -0.0714, 0.3505…
## $ nb_T1_2_NP                      <dbl> 0.850, 0.850, 0.650, 0.725, 0.67…
## $ nb_T1_4_NP                      <dbl> 0.800, 0.850, 0.725, 0.675, 0.57…
## $ nb_T1_10_NP                     <dbl> 0.925, 0.825, 0.750, 0.850, 0.72…
## $ nb_T1_4_P                       <dbl> 0.850, 0.900, 0.675, 0.750, 0.87…
## $ nb_T1_10_P                      <dbl> 0.900, 0.825, 0.750, 0.800, 0.55…
## $ nb_NB_2_NP                      <dbl> 0.0588, 0.4412, 0.4615, 0.1034, …
## $ nb_NB_4_NP                      <dbl> 0.0938, 0.4412, 0.2414, 0.1481, …
## $ nb_NB_10_NP                     <dbl> 0.8649, 0.7576, 0.9667, 0.6765, …
## $ nb_NB_4_P                       <dbl> 0.4118, 0.7222, 0.4815, 0.3667, …
## $ nb_NB_10_P                      <dbl> 0.8333, 0.8485, 0.8333, 0.7188, …
## $ NB_AB                           <dbl> 0.8060, 0.3164, 0.5051, 0.5730, …
## $ NB_REC                          <dbl> 0.7711, 0.3164, 0.7253, 0.5283, …
## $ NB_PE                           <dbl> 0.3180, 0.2810, 0.2401, 0.2185, …
## $ vd_T1_2_NP                      <dbl> 0.925, 0.875, 0.800, 0.850, 0.57…
## $ vd_T1_4_NP                      <dbl> 0.850, 0.825, 0.825, 0.925, 0.70…
## $ vd_T1_10_NP                     <dbl> 0.850, 0.900, 0.825, 0.925, 0.75…
## $ vd_T1_4_P                       <dbl> 0.925, 0.775, 0.825, 0.750, 0.65…
## $ vd_T1_10_P                      <dbl> 0.925, 0.800, 0.725, 0.950, 0.57…
## $ vd_NB_2_NP                      <dbl> 0.0541, 0.2857, 0.3125, 0.1765, …
## $ vd_NB_4_NP                      <dbl> 0.2941, 0.4848, 0.4545, 0.2432, …
## $ vd_NB_10_NP                     <dbl> 1.0000, 0.6667, 0.9394, 0.7838, …
## $ vd_NB_4_P                       <dbl> 0.5135, 0.6774, 0.4848, 0.5000, …
## $ vd_NB_10_P                      <dbl> 0.8919, 0.8125, 0.9310, 0.8421, …
## $ VD_AB                           <dbl> 0.9459, 0.3810, 0.6269, 0.6073, …
## $ VD_REC                          <dbl> 0.7059, 0.1818, 0.4848, 0.5405, …
## $ VD_PE                           <dbl> 0.2194, 0.1926, 0.0303, 0.2568, …
## $ td_T1_2_NP                      <dbl> 0.950, 0.775, 0.625, 0.775, 0.52…
## $ td_T1_4_NP                      <dbl> 0.975, 0.800, 0.800, 0.750, 0.62…
## $ td_T1_10_NP                     <dbl> 0.975, 0.900, 0.800, 0.850, 0.57…
## $ td_T1_4_P                       <dbl> 0.875, 0.800, 0.800, 0.800, 0.60…
## $ td_T1_10_P                      <dbl> 0.875, 0.800, 0.850, 0.700, 0.52…
## $ td_NB_2_NP                      <dbl> 0.1579, 0.3226, 0.5200, 0.1290, …
## $ td_NB_4_NP                      <dbl> 0.4615, 0.4375, 0.3750, 0.2333, …
## $ td_NB_10_NP                     <dbl> 0.9487, 0.6944, 0.9375, 0.6471, …
## $ td_NB_4_P                       <dbl> 0.4571, 0.3750, 0.5625, 0.4063, …
## $ td_NB_10_P                      <dbl> 0.8857, 0.6875, 0.8529, 0.7143, …
## $ TD_AB                           <dbl> 0.7908, 0.3719, 0.4175, 0.5180, …
## $ TD_REC                          <dbl> 0.4872, 0.2569, 0.5625, 0.4137, …
## $ TD_PE                           <dbl> -0.0044, -0.0625, 0.1875, 0.1729…
## $ nd_T1_2_NP                      <dbl> 0.700, 0.800, 0.650, 0.775, 0.42…
## $ nd_T1_4_NP                      <dbl> 0.850, 0.850, 0.725, 0.850, 0.65…
## $ nd_T1_10_NP                     <dbl> 0.800, 0.825, 0.800, 0.850, 0.60…
## $ nd_T1_4_P                       <dbl> 0.850, 0.800, 0.775, 0.775, 0.72…
## $ nd_T1_10_P                      <dbl> 0.850, 0.750, 0.800, 0.850, 0.67…
## $ nd_NB_2_NP                      <dbl> 0.0000, 0.2188, 0.2692, 0.0968, …
## $ nd_NB_4_NP                      <dbl> 0.3824, 0.5000, 0.5172, 0.2353, …
## $ nd_NB_10_NP                     <dbl> 0.8750, 0.5758, 0.8125, 0.7941, …
## $ nd_NB_4_P                       <dbl> 0.4118, 0.5000, 0.5806, 0.5484, …
## $ nd_NB_10_P                      <dbl> 0.9118, 0.7667, 0.8438, 0.8235, …
## $ ND_AB                           <dbl> 0.8750, 0.3570, 0.5433, 0.6973, …
## $ ND_REC                          <dbl> 0.4926, 0.0758, 0.2953, 0.5588, …
## $ ND_PE                           <dbl> 0.0294, 0.0000, 0.0634, 0.3131, …
## $ AnoMinBl_Lag2_NP                <dbl> -0.01, 0.17, -0.14, -0.29, -0.03…
## $ AnoMinBl_Lag10_NP               <dbl> -0.01, 0.05, -0.11, -0.10, 0.12,…
## $ CathoMinBl_Lag2_NP              <dbl> 0.10, 0.04, 0.21, -0.05, -0.03, …
## $ CathoMinBl_Lag10_NP             <dbl> -0.05, 0.03, 0.00, -0.14, 0.06, …
## $ Tijdens_AnoMinBl_Lag2_NP        <dbl> -0.01, 0.17, -0.14, -0.29, -0.03…
## $ Tijdens_AnoMinBl_Lag10_NP       <dbl> -0.01, 0.05, -0.11, -0.10, 0.12,…
## $ Tijdens_CathoMinBl_Lag2_NP      <dbl> 0.10, 0.04, 0.21, -0.05, -0.03, …
## $ Tijdens_CathoMinBl_Lag10_NP     <dbl> -0.05, 0.03, 0.00, -0.14, 0.06, …
## $ Tijdens_AnoMinBL_AB             <dbl> 0.00, -0.12, 0.03, 0.19, 0.15, -…
## $ Tijdens_CathoMinBL_AB           <dbl> -0.16, -0.01, -0.21, -0.09, 0.09…
## $ Na_AnoMinBL_AB                  <dbl> 0.10, -0.15, -0.10, 0.32, 0.22, …
## $ Na_CathoMinBL_AB                <dbl> -0.07, -0.02, -0.08, 0.09, -0.12…
## $ Tijdens_AnoMinBL_PE             <dbl> 0.00, 0.10, -0.13, 0.33, -0.06, …
## $ Tijdens_CathoMinBL_PE           <dbl> -0.22, -0.26, 0.16, -0.08, 0.19,…
## $ Na_CathoMinBL_PE                <dbl> -0.19, -0.19, 0.03, 0.06, 0.03, …
## $ Na_AnoMinBL_PE                  <dbl> 0.34, 0.30, 0.18, 0.20, -0.02, 0…
## $ Tijdens_AnoMinBL_REC            <dbl> -0.03, 0.05, -0.17, 0.07, 0.05, …
## $ Tijdens_CathoMinBL_REC          <dbl> -0.22, 0.08, 0.08, -0.13, 0.17, …
## $ Na_CathoMinBL_REC               <dbl> -0.21, -0.11, -0.19, 0.02, -0.01…
## $ Na_AnoMinBL_REC                 <dbl> 0.25, 0.05, 0.30, 0.22, -0.01, 0…
## $ T1_Lag2_Tijdens_Ano_Min_BL_NP   <dbl> -0.15, 0.00, -0.15, 0.10, -0.18,…
## $ T1_Lag2_Tijdens_Catho_Min_BL_NP <dbl> 0.02, -0.10, -0.18, -0.08, -0.05…
## $ T1_Lag2_Na_Ano_Min_BL_NP        <dbl> -0.08, -0.03, -0.18, 0.10, 0.03,…
## $ T1_Lag2_Na_Catho_Min_BL_NP      <dbl> -0.23, -0.08, -0.15, -0.08, -0.1…
## $ T1_Lag4_Tijdens_Ano_Min_BL_NP   <dbl> 0.02, 0.00, -0.13, -0.08, 0.00, …
## $ T1_Lag4_Tijdens_Catho_Min_BL_NP <dbl> 0.13, -0.02, -0.02, -0.18, -0.08…
## $ T1_Lag4_Na_Catho_Min_BL_NP      <dbl> 0.00, 0.03, -0.10, -0.08, -0.05,…
## $ T1_Lag4_Na_Ano_Min_BL_NP        <dbl> 0.00, 0.03, -0.10, -0.15, -0.10,…
## $ Mean_BL_PE                      <dbl> 0.10, 0.09, 0.05, 0.14, 0.15, -0…
## $ ZVB_AB                          <dbl> 0.72613, -0.71847, 0.12559, -2.0…
## $ ZTB_AB                          <dbl> 0.97738, -1.74477, 0.47867, -0.9…
## $ ZNB_AB                          <dbl> 1.24043, -1.72891, -0.58440, -0.…
## $ ZVD_AB                          <dbl> 2.47191, -1.64491, 0.14714, 0.00…
## $ ZTD_AB                          <dbl> 1.39518, -1.23661, -0.94993, -0.…
## $ ZND_AB                          <dbl> 2.00765, -1.59142, -0.29725, 0.7…
## $ VB_T1_Acc_                      <dbl> 0.87, 0.89, 0.81, 0.77, 0.68, 0.…
## $ VD_T1_Acc_                      <dbl> 0.90, 0.84, 0.80, 0.88, 0.65, 0.…
</pre>
<p>We’ll use only a subset of columns, with the header structure <code>block/stim</code>_<code>target</code>_<code>lag</code>_<code>prime</code>, where:</p>
<ul>
<li><strong>block/stim</strong> is either:
<ol style="list-style-type: decimal">
<li><code>vb</code>: “anodal” tDCS, “pre” block (before tDCS)</li>
<li><code>tb</code>: “anodal” tDCS, “tDCS” block (during tDCS)</li>
<li><code>nb</code>: “anodal” tDCS, “post” block (after tDCS)</li>
<li><code>vd</code>: “cathodal” tDCS, “pre” block (before tDCS)</li>
<li><code>td</code>: “cathodal” tDCS, “tDCS” block (during tDCS)</li>
<li><code>nd</code>: “cathodal” tDCS, “post” block (after tDCS)</li>
</ol></li>
<li><strong>target</strong> is either:
<ol style="list-style-type: decimal">
<li><code>T1</code> (T1 accuracy): proportion of trials in which T1 was identified correctly</li>
<li><code>NB</code> (T2|T1 accuracy): proportion of trials in which T2 was identified correctly, given T1 was identified correctly</li>
</ol></li>
<li><strong>lag</strong> is either:
<ol style="list-style-type: decimal">
<li><code>2</code> (lag 2), when T2 followed T1 after 1 distractor</li>
<li><code>4</code> (lag 4), when T2 followed T1 after 3 distractors</li>
<li><code>10</code>, (lag 10), when T2 followed T1 after 9 distractors</li>
</ol></li>
<li><strong>prime</strong> is either:
<ol style="list-style-type: decimal">
<li><code>P</code> (prime): when the stimulus at lag 2 (in lag 4 or lag 10 trials) had the same identity as T2</li>
<li><code>NP</code> (no prime) when this was not the case. Study 2 had no primes, so we’ll only keep these.</li>
</ol></li>
</ul>
<p>We’ll also keep two more columns: <code>fileno</code> (participant ID) and <code>First_Session</code> (<code>1</code> meaning participants received anodal tDCS in the first session, <code>2</code> meaning participants received cathodal tDCS in the first session).</p>
<div id="reformat" class="section level3">
<h3>Reformat</h3>
<p>Now we’ll reformat the data to match the data frame for study 2:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1">format_study2 &lt;-<span class="st"> </span><span class="cf">function</span>(df) {</a>
<a class="sourceLine" id="cb29-2" data-line-number="2">  df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb29-3" data-line-number="3"><span class="st">    </span><span class="kw">select</span>(fileno, First_Session, <span class="kw">ends_with</span>(<span class="st">&quot;_NP&quot;</span>), <span class="op">-</span><span class="kw">contains</span>(<span class="st">&quot;Min&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># keep only relevant columns</span></a>
<a class="sourceLine" id="cb29-4" data-line-number="4"><span class="st">    </span><span class="kw">gather</span>(key, accuracy, <span class="op">-</span>fileno, <span class="op">-</span>First_Session) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># make long form</span></a>
<a class="sourceLine" id="cb29-5" data-line-number="5"><span class="st">    </span><span class="co"># split key column to create separate columns for each factor</span></a>
<a class="sourceLine" id="cb29-6" data-line-number="6"><span class="st">    </span><span class="kw">separate</span>(key, <span class="kw">c</span>(<span class="st">&quot;block&quot;</span>, <span class="st">&quot;stimulation&quot;</span>, <span class="st">&quot;target&quot;</span>, <span class="st">&quot;lag&quot;</span>), <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># split after 1st, 3rd, and 5th character</span></a>
<a class="sourceLine" id="cb29-7" data-line-number="7"><span class="st">    </span><span class="co"># convert to factors, relabel levels to match those in study 2</span></a>
<a class="sourceLine" id="cb29-8" data-line-number="8"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">block =</span> <span class="kw">factor</span>(block, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;v&quot;</span>, <span class="st">&quot;t&quot;</span>, <span class="st">&quot;n&quot;</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;pre&quot;</span>, <span class="st">&quot;tDCS&quot;</span>, <span class="st">&quot;post&quot;</span>)),</a>
<a class="sourceLine" id="cb29-9" data-line-number="9">           <span class="dt">stimulation =</span> <span class="kw">factor</span>(stimulation, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;b_&quot;</span>, <span class="st">&quot;d_&quot;</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;anodal&quot;</span>, <span class="st">&quot;cathodal&quot;</span>)),</a>
<a class="sourceLine" id="cb29-10" data-line-number="10">           <span class="dt">lag =</span> <span class="kw">factor</span>(lag, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;_2_NP&quot;</span>, <span class="st">&quot;_4_NP&quot;</span>, <span class="st">&quot;_10_NP&quot;</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">10</span>)),</a>
<a class="sourceLine" id="cb29-11" data-line-number="11">           <span class="dt">First_Session =</span> <span class="kw">factor</span>(First_Session, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;anodal first&quot;</span>,<span class="st">&quot;cathodal first&quot;</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb29-12" data-line-number="12"><span class="st">    </span><span class="kw">spread</span>(target, accuracy) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># create separate columns for T2.given.T1 and T1 performance</span></a>
<a class="sourceLine" id="cb29-13" data-line-number="13"><span class="st">    </span><span class="kw">rename</span>(<span class="dt">T2.given.T1 =</span> NB, <span class="dt">session.order =</span> First_Session, <span class="dt">subject =</span> fileno)<span class="co"># rename columns to match those in study 2</span></a>
<a class="sourceLine" id="cb29-14" data-line-number="14">}</a></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1">df_study1 &lt;-<span class="st"> </span><span class="kw">format_study2</span>(data_study1_fromDisk)</a>
<a class="sourceLine" id="cb30-2" data-line-number="2">n_study1 &lt;-<span class="st"> </span><span class="kw">n_distinct</span>(df_study1<span class="op">$</span>subject) <span class="co"># number of subjects in study 1</span></a></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1"><span class="kw">kable</span>(<span class="kw">head</span>(df_study1,<span class="dv">19</span>), <span class="dt">digits =</span> <span class="dv">1</span>, <span class="dt">caption =</span> <span class="st">&quot;Data frame for study 1&quot;</span>)</a></code></pre></div>
<table>
<caption>Data frame for study 1</caption>
<thead>
<tr class="header">
<th align="left">subject</th>
<th align="left">session.order</th>
<th align="left">block</th>
<th align="left">stimulation</th>
<th align="left">lag</th>
<th align="right">T2.given.T1</th>
<th align="right">T1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">pre</td>
<td align="left">anodal</td>
<td align="left">2</td>
<td align="right">0.3</td>
<td align="right">0.6</td>
</tr>
<tr class="even">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">pre</td>
<td align="left">anodal</td>
<td align="left">4</td>
<td align="right">0.3</td>
<td align="right">0.7</td>
</tr>
<tr class="odd">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">pre</td>
<td align="left">anodal</td>
<td align="left">10</td>
<td align="right">0.7</td>
<td align="right">0.8</td>
</tr>
<tr class="even">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">pre</td>
<td align="left">cathodal</td>
<td align="left">2</td>
<td align="right">0.2</td>
<td align="right">0.6</td>
</tr>
<tr class="odd">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">pre</td>
<td align="left">cathodal</td>
<td align="left">4</td>
<td align="right">0.4</td>
<td align="right">0.7</td>
</tr>
<tr class="even">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">pre</td>
<td align="left">cathodal</td>
<td align="left">10</td>
<td align="right">0.8</td>
<td align="right">0.8</td>
</tr>
<tr class="odd">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">tDCS</td>
<td align="left">anodal</td>
<td align="left">2</td>
<td align="right">0.3</td>
<td align="right">0.5</td>
</tr>
<tr class="even">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">tDCS</td>
<td align="left">anodal</td>
<td align="left">4</td>
<td align="right">0.4</td>
<td align="right">0.7</td>
</tr>
<tr class="odd">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">tDCS</td>
<td align="left">anodal</td>
<td align="left">10</td>
<td align="right">0.8</td>
<td align="right">0.5</td>
</tr>
<tr class="even">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">tDCS</td>
<td align="left">cathodal</td>
<td align="left">2</td>
<td align="right">0.1</td>
<td align="right">0.5</td>
</tr>
<tr class="odd">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">tDCS</td>
<td align="left">cathodal</td>
<td align="left">4</td>
<td align="right">0.3</td>
<td align="right">0.6</td>
</tr>
<tr class="even">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">tDCS</td>
<td align="left">cathodal</td>
<td align="left">10</td>
<td align="right">0.8</td>
<td align="right">0.6</td>
</tr>
<tr class="odd">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">post</td>
<td align="left">anodal</td>
<td align="left">2</td>
<td align="right">0.3</td>
<td align="right">0.7</td>
</tr>
<tr class="even">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">post</td>
<td align="left">anodal</td>
<td align="left">4</td>
<td align="right">0.5</td>
<td align="right">0.6</td>
</tr>
<tr class="odd">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">post</td>
<td align="left">anodal</td>
<td align="left">10</td>
<td align="right">0.9</td>
<td align="right">0.7</td>
</tr>
<tr class="even">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">post</td>
<td align="left">cathodal</td>
<td align="left">2</td>
<td align="right">0.2</td>
<td align="right">0.4</td>
</tr>
<tr class="odd">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">post</td>
<td align="left">cathodal</td>
<td align="left">4</td>
<td align="right">0.4</td>
<td align="right">0.6</td>
</tr>
<tr class="even">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">post</td>
<td align="left">cathodal</td>
<td align="left">10</td>
<td align="right">0.7</td>
<td align="right">0.6</td>
</tr>
<tr class="odd">
<td align="left">pp11</td>
<td align="left">anodal first</td>
<td align="left">pre</td>
<td align="left">anodal</td>
<td align="left">2</td>
<td align="right">0.5</td>
<td align="right">1.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="group-analysis" class="section level1">
<h1>Group analysis</h1>
<div id="line-plots-cf.london-slagter-2015" class="section level2 tabset tabset-fade tabset-pills">
<h2>Line plots cf. London &amp; Slagter (2015)</h2>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1">plot_lines &lt;-<span class="st"> </span><span class="cf">function</span>(df) {</a>
<a class="sourceLine" id="cb32-2" data-line-number="2">  df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb32-3" data-line-number="3"><span class="st">  </span><span class="kw">gather</span>(target, proportion_correct, T1, T2.given.T1) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># so T1 vs. T2|T1 can be used as a factor</span></a>
<a class="sourceLine" id="cb32-4" data-line-number="4"><span class="st">  </span></a>
<a class="sourceLine" id="cb32-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(lag, proportion_correct, <span class="dt">color =</span> block, <span class="dt">linetype =</span> target)) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-6" data-line-number="6"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>stimulation) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-7" data-line-number="7"><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="kw">aes</span>(<span class="dt">group =</span> <span class="kw">interaction</span>(target,block)), <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="dt">width =</span> <span class="fl">0.2</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-8" data-line-number="8"><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.data =</span> mean_se, <span class="dt">geom =</span> <span class="st">&quot;errorbar&quot;</span>, <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="dt">width =</span> <span class="fl">0.2</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="st">&quot;Lag&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-10" data-line-number="10"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;Percentage correct&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,.<span class="dv">1</span>), <span class="dt">labels =</span> scales<span class="op">::</span><span class="kw">percent_format</span>())</a>
<a class="sourceLine" id="cb32-11" data-line-number="11">}</a></code></pre></div>
<div id="study-1-1" class="section level3">
<h3>Study 1</h3>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="kw">plot_lines</span>(df_study1)</a></code></pre></div>
<div class="figure">
<img src="AB-tDCS_group_files/figure-html/lag%20line%20plot%20study%201-1.png" alt="Group effects of tDCS in study 1" width="576" />
<p class="caption">
Group effects of tDCS in study 1
</p>
</div>
</div>
<div id="study-2-1" class="section level3">
<h3>Study 2</h3>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1"><span class="kw">plot_lines</span>(df_study2)</a></code></pre></div>
<div class="figure">
<img src="AB-tDCS_group_files/figure-html/lag%20line%20plot%20study%202-1.png" alt="Group effects of tDCS in study 2" width="576" />
<p class="caption">
Group effects of tDCS in study 2
</p>
</div>
<p><strong>Stray observations:</strong></p>
<ul>
<li>T1 performance comparable between both studies</li>
<li>Lag 8 performance is comparable to lag 10 (although a little bit lower)</li>
<li>Blink at lag 3 is about 10-15 percentage points less than lag 2</li>
<li>Slopes differ a bit in study 1, in study 2 especially anodal tDCS lag 8 stands out</li>
<li>In both studies, performance at lag 2/3 across anodal/cathodal tDCS and blocks is basically identical</li>
</ul>
</div>
</div>
<div id="rm-anova" class="section level2 tabset tabset-fade">
<h2>RM ANOVA</h2>
<div id="study-1---t2t1" class="section level3">
<h3>Study 1 - T2|T1</h3>
<ul>
<li><strong>DV</strong>: <code>T2.given.T1</code>: Proportion of trials which T2 was identified correctly, out of the trials in which T1 was idenitified correctly (T2|T1).</li>
<li><strong>Between-subject factor</strong>: <code>session.order</code>, 2 levels: Whether participant received <em>anodal</em> or <em>cathodal</em> tDCS in the first session (<code>anodal_first</code> vs. <code>cathodal_first</code>).</li>
<li><strong>Within-subject factors</strong>:
<ol style="list-style-type: decimal">
<li><code>block</code>, 3 levels: Whether data is before (<em>pre</em>), during (<em>tDCS</em>) or after (<em>post</em>) tDCS</li>
<li><code>stimulation</code>, 2 levels: Whether participant received <em>anodal</em> or <em>cathodal</em> tDCS</li>
<li><code>lag</code>, 3 levels: Whether T2 followed T1 after 1 distractor (<em>lag 2</em>), 3 distractors, (<em>lag 4</em>), or after 9 distractors (<em>lag 10</em>).</li>
</ol></li>
<li><strong>Subject identifier</strong>: <code>subject</code> (n = 34).</li>
</ul>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1">aov_study1 &lt;-<span class="st"> </span><span class="kw">aov_car</span>(T2.given.T1 <span class="op">~</span><span class="st"> </span>session.order <span class="op">+</span><span class="st"> </span><span class="kw">Error</span>(subject<span class="op">/</span>(block<span class="op">*</span>stimulation<span class="op">*</span>lag)), </a>
<a class="sourceLine" id="cb35-2" data-line-number="2">        <span class="dt">data =</span> df_study1)</a></code></pre></div>
<pre><code>## Contrasts set to contr.sum for the following variables: session.order</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="kw">kable</span>(<span class="kw">nice</span>(aov_study1), <span class="dt">caption =</span> <span class="st">&quot;Study 1: RM ANOVA on T2|T1 performance&quot;</span>)</a></code></pre></div>
<table>
<caption>Study 1: RM ANOVA on T2|T1 performance</caption>
<thead>
<tr class="header">
<th align="left">Effect</th>
<th align="left">df</th>
<th align="left">MSE</th>
<th align="left">F</th>
<th align="left">ges</th>
<th align="left">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">session.order</td>
<td align="left">1, 32</td>
<td align="left">0.23</td>
<td align="left">0.06</td>
<td align="left">.0010</td>
<td align="left">.81</td>
</tr>
<tr class="even">
<td align="left">block</td>
<td align="left">1.89, 60.49</td>
<td align="left">0.01</td>
<td align="left">9.14 ***</td>
<td align="left">.009</td>
<td align="left">.0004</td>
</tr>
<tr class="odd">
<td align="left">session.order:block</td>
<td align="left">1.89, 60.49</td>
<td align="left">0.01</td>
<td align="left">1.99</td>
<td align="left">.002</td>
<td align="left">.15</td>
</tr>
<tr class="even">
<td align="left">stimulation</td>
<td align="left">1, 32</td>
<td align="left">0.01</td>
<td align="left">0.18</td>
<td align="left">.0001</td>
<td align="left">.67</td>
</tr>
<tr class="odd">
<td align="left">session.order:stimulation</td>
<td align="left">1, 32</td>
<td align="left">0.01</td>
<td align="left">17.05 ***</td>
<td align="left">.01</td>
<td align="left">.0002</td>
</tr>
<tr class="even">
<td align="left">lag</td>
<td align="left">1.89, 60.35</td>
<td align="left">0.06</td>
<td align="left">311.79 ***</td>
<td align="left">.71</td>
<td align="left">&lt;.0001</td>
</tr>
<tr class="odd">
<td align="left">session.order:lag</td>
<td align="left">1.89, 60.35</td>
<td align="left">0.06</td>
<td align="left">0.77</td>
<td align="left">.006</td>
<td align="left">.46</td>
</tr>
<tr class="even">
<td align="left">block:stimulation</td>
<td align="left">1.81, 58.01</td>
<td align="left">0.01</td>
<td align="left">1.50</td>
<td align="left">.001</td>
<td align="left">.23</td>
</tr>
<tr class="odd">
<td align="left">session.order:block:stimulation</td>
<td align="left">1.81, 58.01</td>
<td align="left">0.01</td>
<td align="left">5.25 **</td>
<td align="left">.004</td>
<td align="left">.010</td>
</tr>
<tr class="even">
<td align="left">block:lag</td>
<td align="left">3.43, 109.90</td>
<td align="left">0.01</td>
<td align="left">3.66 *</td>
<td align="left">.005</td>
<td align="left">.01</td>
</tr>
<tr class="odd">
<td align="left">session.order:block:lag</td>
<td align="left">3.43, 109.90</td>
<td align="left">0.01</td>
<td align="left">1.54</td>
<td align="left">.002</td>
<td align="left">.20</td>
</tr>
<tr class="even">
<td align="left">stimulation:lag</td>
<td align="left">1.44, 46.15</td>
<td align="left">0.01</td>
<td align="left">0.05</td>
<td align="left">&lt;.0001</td>
<td align="left">.91</td>
</tr>
<tr class="odd">
<td align="left">session.order:stimulation:lag</td>
<td align="left">1.44, 46.15</td>
<td align="left">0.01</td>
<td align="left">3.48 +</td>
<td align="left">.004</td>
<td align="left">.05</td>
</tr>
<tr class="even">
<td align="left">block:stimulation:lag</td>
<td align="left">3.35, 107.08</td>
<td align="left">0.01</td>
<td align="left">0.83</td>
<td align="left">.001</td>
<td align="left">.49</td>
</tr>
<tr class="odd">
<td align="left">session.order:block:stimulation:lag</td>
<td align="left">3.35, 107.08</td>
<td align="left">0.01</td>
<td align="left">0.70</td>
<td align="left">.001</td>
<td align="left">.57</td>
</tr>
</tbody>
</table>
<div id="main-effect-of-lag" class="section level4">
<h4>Main effect of lag</h4>
<p>This is the attentional blink: T2 is seen more often in the long lag(s).</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="kw">afex_plot</span>(aov_study1, <span class="dt">x =</span> <span class="st">&quot;lag&quot;</span>, <span class="dt">error =</span> <span class="st">&quot;within&quot;</span>)</a></code></pre></div>
<div class="figure">
<img src="AB-tDCS_group_files/figure-html/study%201%20-%20plot%20lag-1.png" alt="Study 1 - Attentional blink (main effect of Lag)" width="576" />
<p class="caption">
Study 1 - Attentional blink (main effect of Lag)
</p>
</div>
</div>
<div id="main-effect-of-block" class="section level4">
<h4>Main effect of block</h4>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="kw">afex_plot</span>(aov_study1, <span class="dt">x =</span> <span class="st">&quot;block&quot;</span>, <span class="dt">error =</span> <span class="st">&quot;within&quot;</span>)</a></code></pre></div>
<div class="figure">
<img src="AB-tDCS_group_files/figure-html/study%201%20-%20plot%20block-1.png" alt="Study 1 - main effect of Block" width="576" />
<p class="caption">
Study 1 - main effect of Block
</p>
</div>
<p>Appears to be a time-on-task / fatigue effect: participants get worse each block.</p>
</div>
<div id="interaction-block-by-stimulation-by-lag" class="section level4">
<h4>Interaction: block by stimulation by lag</h4>
<p>The hypothesized effect was that anodal stimulation improves (compared to <code>pre</code> block) the attentional blink (short-lag T2 performance), but it was not significant.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="kw">afex_plot</span>(aov_study1, <span class="dt">x =</span> <span class="st">&quot;block&quot;</span>, <span class="dt">trace =</span>  <span class="st">&quot;stimulation&quot;</span>, <span class="dt">panel =</span> <span class="st">&quot;lag&quot;</span>, </a>
<a class="sourceLine" id="cb40-2" data-line-number="2">          <span class="dt">factor_levels =</span> <span class="kw">list</span>(<span class="dt">lag =</span> <span class="kw">c</span>(<span class="st">&quot;lag 2&quot;</span>,<span class="st">&quot;lag 4&quot;</span>,<span class="st">&quot;lag 10&quot;</span>)), <span class="dt">error =</span> <span class="st">&quot;within&quot;</span>)</a></code></pre></div>
<div class="figure">
<img src="AB-tDCS_group_files/figure-html/study%201%20-%20plot%20hypothesis-1.png" alt="Study 1 - hypothesized interaction: Block by Stimulation by Lag" width="576" />
<p class="caption">
Study 1 - hypothesized interaction: Block by Stimulation by Lag
</p>
</div>
<p>Indeed, only a main effect of lag is clearly visible. If anything, the largest difference is in lag 2 though, but in the opposite direction (cathodal slightly improves performance; anodal slightly decreases performance).</p>
</div>
<div id="interaction-stimulation-by-session-order" class="section level4">
<h4>Interaction: stimulation by session order</h4>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1"><span class="kw">afex_plot</span>(aov_study1, <span class="dt">x =</span> <span class="st">&quot;stimulation&quot;</span>, <span class="dt">trace =</span> <span class="st">&quot;session.order&quot;</span>, <span class="dt">error =</span> <span class="st">&quot;none&quot;</span>)</a></code></pre></div>
<div class="figure">
<img src="AB-tDCS_group_files/figure-html/study%201%20-%20plot%20stimulation%20by%20session%20order-1.png" alt="Study 1 - Stimulation by Session Order" width="576" />
<p class="caption">
Study 1 - Stimulation by Session Order
</p>
</div>
<p><em>stimulation</em> and <em>session.order</em> are not orthogonal: their interaction makes up a new factor <em>session</em>, with 2 levels:</p>
<ul>
<li>session 1:
<ol style="list-style-type: decimal">
<li><em>session.order</em> = anodal first, <em>stimulation</em> = anodal</li>
<li><em>session.order</em> = cathodal first, <em>stimulation</em> = cathodal</li>
</ol></li>
<li>session 2:
<ol style="list-style-type: decimal">
<li><em>session.order</em> = anodal first, <em>stimulation</em> = cathodal</li>
<li><em>session.order</em> = cathodal first, <em>stimulation</em> = anodal</li>
</ol></li>
</ul>
<p>So my take is this “interaction” actually reflects an across-session learning effect: participants simply do better in their 2nd session than in their 1st.</p>
</div>
<div id="interaction-stimulation-by-session-order-by-block" class="section level4">
<h4>Interaction: stimulation by session order by block</h4>
<p>There is apparently also a higher order interaction, with <em>block</em>:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1"><span class="kw">afex_plot</span>(aov_study1, <span class="dt">x =</span> <span class="st">&quot;stimulation&quot;</span>, <span class="dt">trace =</span> <span class="st">&quot;session.order&quot;</span>, <span class="dt">panel =</span> <span class="st">&quot;block&quot;</span>, <span class="dt">error =</span> <span class="st">&quot;none&quot;</span>)</a></code></pre></div>
<div class="figure">
<img src="AB-tDCS_group_files/figure-html/study%201%20-%20plot%20threeway-1.png" alt="Study 1 - Stimulation by Session Order by Block" width="576" />
<p class="caption">
Study 1 - Stimulation by Session Order by Block
</p>
</div>
<p>Seems that the crossover interaction (the learning effect) is mostly present in the first two blocks, not the last. This makes sense intuitively: in the third block of the 1st session, participants already performed the task for 40 minutes, so the difference in “time-on-task” between session 1 and 2 is not so great.</p>
</div>
</div>
<div id="study-2---t2t1" class="section level3">
<h3>Study 2 - T2|T1</h3>
<ul>
<li><strong>DV</strong>: <code>T2.given.T1</code>: Proportion of trials which T2 was identified correctly, out of the trials in which T1 was idenitified correctly (T2|T1).</li>
<li><strong>Within-subject factors</strong>:
<ol style="list-style-type: decimal">
<li><code>block</code>, 3 levels: Whether data is before (<em>pre</em>), during (<em>tDCS</em>) or after (<em>post</em>) tDCS</li>
<li><code>stimulation</code>, 2 levels: Whether participant received <em>anodal</em> or <em>cathodal</em> tDCS</li>
<li><code>lag</code>, 2 levels: Whether T2 followed T1 after 2 distractors (<em>lag 3</em>), or after 7 distractors (<em>lag 8</em>).</li>
</ol></li>
<li><strong>Subject identifier</strong>: <code>subject</code> (n = 40).</li>
</ul>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1">aov_study2 &lt;-<span class="st"> </span><span class="kw">aov_car</span>(T2.given.T1 <span class="op">~</span><span class="st"> </span>session.order <span class="op">+</span><span class="st"> </span><span class="kw">Error</span>(subject<span class="op">/</span>(block<span class="op">*</span>stimulation<span class="op">*</span>lag)), </a>
<a class="sourceLine" id="cb43-2" data-line-number="2">        <span class="dt">data =</span> df_study2)</a></code></pre></div>
<pre><code>## Contrasts set to contr.sum for the following variables: session.order</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1"><span class="kw">kable</span>(<span class="kw">nice</span>(aov_study2), <span class="dt">caption =</span> <span class="st">&quot;Study 2: RM ANOVA on T2|T1 performance&quot;</span>)</a></code></pre></div>
<table>
<caption>Study 2: RM ANOVA on T2|T1 performance</caption>
<thead>
<tr class="header">
<th align="left">Effect</th>
<th align="left">df</th>
<th align="left">MSE</th>
<th align="left">F</th>
<th align="left">ges</th>
<th align="left">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">session.order</td>
<td align="left">1, 38</td>
<td align="left">0.19</td>
<td align="left">0.33</td>
<td align="left">.006</td>
<td align="left">.57</td>
</tr>
<tr class="even">
<td align="left">block</td>
<td align="left">1.91, 72.71</td>
<td align="left">0.00</td>
<td align="left">1.13</td>
<td align="left">.0007</td>
<td align="left">.33</td>
</tr>
<tr class="odd">
<td align="left">session.order:block</td>
<td align="left">1.91, 72.71</td>
<td align="left">0.00</td>
<td align="left">0.29</td>
<td align="left">.0002</td>
<td align="left">.74</td>
</tr>
<tr class="even">
<td align="left">stimulation</td>
<td align="left">1, 38</td>
<td align="left">0.01</td>
<td align="left">2.47</td>
<td align="left">.002</td>
<td align="left">.12</td>
</tr>
<tr class="odd">
<td align="left">session.order:stimulation</td>
<td align="left">1, 38</td>
<td align="left">0.01</td>
<td align="left">5.55 *</td>
<td align="left">.005</td>
<td align="left">.02</td>
</tr>
<tr class="even">
<td align="left">lag</td>
<td align="left">1, 38</td>
<td align="left">0.04</td>
<td align="left">432.11 ***</td>
<td align="left">.63</td>
<td align="left">&lt;.0001</td>
</tr>
<tr class="odd">
<td align="left">session.order:lag</td>
<td align="left">1, 38</td>
<td align="left">0.04</td>
<td align="left">0.48</td>
<td align="left">.002</td>
<td align="left">.49</td>
</tr>
<tr class="even">
<td align="left">block:stimulation</td>
<td align="left">1.91, 72.51</td>
<td align="left">0.00</td>
<td align="left">0.28</td>
<td align="left">.0001</td>
<td align="left">.75</td>
</tr>
<tr class="odd">
<td align="left">session.order:block:stimulation</td>
<td align="left">1.91, 72.51</td>
<td align="left">0.00</td>
<td align="left">1.93</td>
<td align="left">.0008</td>
<td align="left">.15</td>
</tr>
<tr class="even">
<td align="left">block:lag</td>
<td align="left">1.70, 64.73</td>
<td align="left">0.00</td>
<td align="left">1.67</td>
<td align="left">.0009</td>
<td align="left">.20</td>
</tr>
<tr class="odd">
<td align="left">session.order:block:lag</td>
<td align="left">1.70, 64.73</td>
<td align="left">0.00</td>
<td align="left">0.24</td>
<td align="left">.0001</td>
<td align="left">.75</td>
</tr>
<tr class="even">
<td align="left">stimulation:lag</td>
<td align="left">1, 38</td>
<td align="left">0.00</td>
<td align="left">0.10</td>
<td align="left">&lt;.0001</td>
<td align="left">.75</td>
</tr>
<tr class="odd">
<td align="left">session.order:stimulation:lag</td>
<td align="left">1, 38</td>
<td align="left">0.00</td>
<td align="left">5.84 *</td>
<td align="left">.002</td>
<td align="left">.02</td>
</tr>
<tr class="even">
<td align="left">block:stimulation:lag</td>
<td align="left">1.77, 67.17</td>
<td align="left">0.00</td>
<td align="left">2.77 +</td>
<td align="left">.001</td>
<td align="left">.08</td>
</tr>
<tr class="odd">
<td align="left">session.order:block:stimulation:lag</td>
<td align="left">1.77, 67.17</td>
<td align="left">0.00</td>
<td align="left">7.25 **</td>
<td align="left">.003</td>
<td align="left">.002</td>
</tr>
</tbody>
</table>
<div id="main-effect-of-lag-1" class="section level4">
<h4>Main effect of lag</h4>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1"><span class="kw">afex_plot</span>(aov_study2, <span class="dt">x =</span> <span class="st">&quot;lag&quot;</span>, <span class="dt">error =</span> <span class="st">&quot;within&quot;</span>)</a></code></pre></div>
<div class="figure">
<img src="AB-tDCS_group_files/figure-html/study%202%20-%20plot%20lag-1.png" alt="Study 2 - Attentional blink (main effect of Lag)" width="576" />
<p class="caption">
Study 2 - Attentional blink (main effect of Lag)
</p>
</div>
<p>Again simply the attentional blink.</p>
</div>
<div id="interaction-block-by-stimulation-by-lag-1" class="section level4">
<h4>Interaction: block by stimulation by lag</h4>
<p>Like in study 1, this was the hypothesized effect, but it is not significant.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1"><span class="kw">afex_plot</span>(aov_study2, <span class="dt">x =</span> <span class="st">&quot;block&quot;</span>, <span class="dt">trace =</span>  <span class="st">&quot;stimulation&quot;</span>, </a>
<a class="sourceLine" id="cb47-2" data-line-number="2">          <span class="dt">panel =</span> <span class="st">&quot;lag&quot;</span>, <span class="dt">factor_levels =</span> <span class="kw">list</span>(<span class="dt">lag =</span> <span class="kw">c</span>(<span class="st">&quot;lag 3&quot;</span>,<span class="st">&quot;lag 8&quot;</span>)), <span class="dt">error =</span> <span class="st">&quot;within&quot;</span>)</a></code></pre></div>
<div class="figure">
<img src="AB-tDCS_group_files/figure-html/study%202%20-%20plot%20hypothesis-1.png" alt="Study 2 - hypothesized interaction: Block by Stimulation by Lag" width="576" />
<p class="caption">
Study 2 - hypothesized interaction: Block by Stimulation by Lag
</p>
</div>
<p>Doesn’t look like much, but as it’s trending (<em>p</em> = 0.076), let’s look at the contrasts anyway:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1"><span class="kw">pairs</span>(<span class="kw">emmeans</span>(aov_study2, <span class="op">~</span>block<span class="op">|</span>stimulation<span class="op">*</span>lag))</a></code></pre></div>
<pre>## stimulation = anodal, lag = X3:
##  contrast        estimate          SE df t.ratio p.value
##  pre - tDCS  -0.005663926 0.011400399 38  -0.497  0.8733
##  pre - post  -0.013178892 0.010860117 38  -1.214  0.4527
##  tDCS - post -0.007514966 0.012618269 38  -0.596  0.8233
## 
## stimulation = cathodal, lag = X3:
##  contrast        estimate          SE df t.ratio p.value
##  pre - tDCS   0.007320928 0.010723949 38   0.683  0.7749
##  pre - post   0.005415115 0.010932528 38   0.495  0.8740
##  tDCS - post -0.001905813 0.009633767 38  -0.198  0.9787
## 
## stimulation = anodal, lag = X8:
##  contrast        estimate          SE df t.ratio p.value
##  pre - tDCS   0.031798698 0.009290106 38   3.423  0.0042
##  pre - post   0.028782443 0.012952982 38   2.222  0.0803
##  tDCS - post -0.003016255 0.012365722 38  -0.244  0.9678
## 
## stimulation = cathodal, lag = X8:
##  contrast        estimate          SE df t.ratio p.value
##  pre - tDCS   0.003560723 0.010499609 38   0.339  0.9387
##  pre - post   0.001785099 0.011831544 38   0.151  0.9875
##  tDCS - post -0.001775624 0.010991797 38  -0.162  0.9857
## 
## Results are averaged over the levels of: session.order 
## P value adjustment: tukey method for comparing a family of 3 estimates
</pre>
<p>The only significant change is in the anodal, lag 8 condition: T2 performance goes down compared to baseline. But because this is not the case for the short lag, this should not be considered an effect on the attentional blink.</p>
</div>
<div id="interaction-stimulation-by-session-order-1" class="section level4">
<h4>Interaction: stimulation by session order</h4>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1"><span class="kw">afex_plot</span>(aov_study2, <span class="dt">x =</span> <span class="st">&quot;stimulation&quot;</span>, <span class="dt">trace =</span> <span class="st">&quot;session.order&quot;</span>, <span class="dt">error =</span> <span class="st">&quot;none&quot;</span>)</a></code></pre></div>
<div class="figure">
<img src="AB-tDCS_group_files/figure-html/study%202%20-%20plot%20stimulation%20by%20session%20order-1.png" alt="Study 2 - Stimulation by Session Order" width="576" />
<p class="caption">
Study 2 - Stimulation by Session Order
</p>
</div>
<p>In study 1, this interaction also occured and looked like a cross-session learning effect: performance improves in the 2nd session compared to the first. However, here this is only visible for the “anodal first” group.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1"><span class="kw">pairs</span>(<span class="kw">emmeans</span>(aov_study2, <span class="op">~</span>stimulation<span class="op">|</span>session.order))</a></code></pre></div>
<pre>## session.order = anodal first:
##  contrast              estimate         SE df t.ratio p.value
##  anodal - cathodal -0.034609422 0.01307247 38  -2.648  0.0117
## 
## session.order = cathodal first:
##  contrast              estimate         SE df t.ratio p.value
##  anodal - cathodal  0.006929334 0.01182449 38   0.586  0.5613
## 
## Results are averaged over the levels of: lag, block
</pre>
<p>Indeed, the difference is only significant for the “anodal first” group. It’s unlikely, but in principle this could indicate that anodal has a carryover effect, while cathodal does not.</p>
</div>
<div id="interaction-stimulation-by-session-order-by-lag" class="section level4">
<h4>Interaction: stimulation by session order by lag</h4>
<p>Apparently this also interacts with Lag (which it also did not do in study 1):</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1"><span class="kw">afex_plot</span>(aov_study2, <span class="dt">x =</span> <span class="st">&quot;stimulation&quot;</span>, <span class="dt">trace =</span> <span class="st">&quot;session.order&quot;</span>, <span class="dt">panel =</span> <span class="st">&quot;lag&quot;</span>, </a>
<a class="sourceLine" id="cb51-2" data-line-number="2">          <span class="dt">factor_levels =</span> <span class="kw">list</span>(<span class="dt">lag =</span> <span class="kw">c</span>(<span class="st">&quot;lag 3&quot;</span>,<span class="st">&quot;lag 8&quot;</span>)), <span class="dt">error =</span> <span class="st">&quot;none&quot;</span>)</a></code></pre></div>
<div class="figure">
<img src="AB-tDCS_group_files/figure-html/study%202%20-%20plot%20stimulation%20by%20lag%20by%20session%20order-1.png" alt="Study 2 - Stimulation by Session Order by Lag" width="576" />
<p class="caption">
Study 2 - Stimulation by Session Order by Lag
</p>
</div>
<p>Interesting: the two-way interaction between <em>stimulation</em> and <em>session order</em> shows no learning effect for both groups (only anodal first). However, this higher-order interaction does seem to show a change in the cathodal group also. But the interaction is only visible in the the short lag condition. That makes sense, as there is not much room for improvement in the long lag condition.</p>
</div>
<div id="interaction-stimulation-by-session-order-by-lag-by-block" class="section level4">
<h4>Interaction: stimulation by session order by lag by block</h4>
<p>Then, there is a yet higher order interaction, also with <em>block</em>:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1"><span class="kw">afex_plot</span>(aov_study2, <span class="dt">x =</span> <span class="st">&quot;stimulation&quot;</span>, <span class="dt">trace =</span> <span class="kw">c</span>(<span class="st">&quot;session.order&quot;</span>,<span class="st">&quot;lag&quot;</span>), </a>
<a class="sourceLine" id="cb52-2" data-line-number="2">          <span class="dt">panel =</span> <span class="st">&quot;block&quot;</span>, <span class="dt">data_plot =</span> <span class="ot">FALSE</span>, <span class="dt">factor_levels =</span> <span class="kw">list</span>(<span class="dt">lag =</span> <span class="kw">c</span>(<span class="st">&quot;lag 3&quot;</span>,<span class="st">&quot;lag 8&quot;</span>)), <span class="dt">error =</span> <span class="st">&quot;none&quot;</span>)</a></code></pre></div>
<div class="figure">
<img src="AB-tDCS_group_files/figure-html/study%202%20-%20plot%20four-way%20with%20block-1.png" alt="Study 2 - four way interaction, centered on Block" width="576" />
<p class="caption">
Study 2 - four way interaction, centered on Block
</p>
</div>
<p>This suggests that the three-way interaction (cross-session learning effect for short lag) mostly occurs in the <code>pre</code> block. Similar to the three-way interaction in study 1 (<em>stimulation</em> by <em>session order</em> by <em>block</em>), the “learning effect across sessions” (crossover in short lag trials) diminishes over blocks. This makes sense because the difference between sessions in “task experience” also diminishes over blocks (in the <code>pre</code> block, participants are doing the task for the first time in session 1, but in the later blocks of session 1, they’ve built up experience).</p>
<p>However, another take on the four-way interaction is the following: it is actually the hypothesized effect (three-way interaction of <em>stimulation</em>, <em>block</em>, and <em>lag</em>), but it only occurs for a certain session order:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" data-line-number="1"><span class="kw">afex_plot</span>(aov_study2, <span class="dt">x =</span> <span class="st">&quot;block&quot;</span>, <span class="dt">trace =</span> <span class="kw">c</span>(<span class="st">&quot;stimulation&quot;</span>,<span class="st">&quot;lag&quot;</span>), <span class="dt">panel =</span> <span class="st">&quot;session.order&quot;</span>, <span class="dt">data_plot =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb53-2" data-line-number="2">          <span class="dt">factor_levels =</span> <span class="kw">list</span>(<span class="dt">lag =</span> <span class="kw">c</span>(<span class="st">&quot;lag 3&quot;</span>,<span class="st">&quot;lag 8&quot;</span>)), <span class="dt">error =</span> <span class="st">&quot;none&quot;</span>)</a></code></pre></div>
<div class="figure">
<img src="AB-tDCS_group_files/figure-html/study%202%20-%20plot%20four-way%20with%20first%20session-1.png" alt="Study 2 - four way interaction, centered on Session Order" width="576" />
<p class="caption">
Study 2 - four way interaction, centered on Session Order
</p>
</div>
<p>Most of the changes occur in the “anodal first” group. There we can actually see the hypothesized effect: increased performance on short-lag trials during/after tDCS compared to before. That said, the biggest difference between anodal and cathodal is in the baseline already, and only decreases in the <em>tDCS</em>- and <em>post</em>-blocks. Also, in the “cathodal first” group, the direction of the “effect” is reversed (and again the differences are largest in the baseline).</p>
<p>Still, lets’s look at the hypothesized three-way interaction separately for each “group” (anodal first, cathodal first):</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" data-line-number="1"><span class="kw">joint_tests</span>(aov_study2, <span class="dt">by =</span> <span class="st">&quot;session.order&quot;</span>)</a></code></pre></div>
<pre>## session.order = anodal first:
##  model term            df1 df2 F.ratio p.value
##  lag                     1  38 183.573  <.0001
##  stimulation             1  38   7.009  0.0117
##  block                   2  38   0.956  0.3935
##  lag:stimulation         1  38   1.998  0.1656
##  lag:block               2  38   0.958  0.3926
##  stimulation:block       2  38   0.372  0.6920
##  lag:stimulation:block   2  38  10.938  0.0002
## 
## session.order = cathodal first:
##  model term            df1 df2 F.ratio p.value
##  lag                     1  38 256.284  <.0001
##  stimulation             1  38   0.343  0.5613
##  block                   2  38   0.149  0.8624
##  lag:stimulation         1  38   4.163  0.0483
##  lag:block               2  38   1.833  0.1738
##  stimulation:block       2  38   1.642  0.2070
##  lag:stimulation:block   2  38   0.684  0.5106
</pre>
<p>Indeed, so the three-way interaction is significant in the “anodal first” group, but not the “cathodal first” group.</p>
<p>Finally, let’s also look at the pairwise contrasts for <em>block</em> for each combination of factors:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1"><span class="kw">pairs</span>(<span class="kw">emmeans</span>(aov_study2, <span class="op">~</span>block<span class="op">|</span>session.order<span class="op">*</span>stimulation<span class="op">*</span>lag))</a></code></pre></div>
<pre>## session.order = anodal first, stimulation = anodal, lag = X3:
##  contrast         estimate         SE df t.ratio p.value
##  pre - tDCS  -0.0197991551 0.01690952 38  -1.171  0.4775
##  pre - post  -0.0421606435 0.01610816 38  -2.617  0.0331
##  tDCS - post -0.0223614884 0.01871592 38  -1.195  0.4635
## 
## session.order = cathodal first, stimulation = anodal, lag = X3:
##  contrast         estimate         SE df t.ratio p.value
##  pre - tDCS   0.0084713025 0.01529524 38   0.554  0.8451
##  pre - post   0.0158028597 0.01457038 38   1.085  0.5293
##  tDCS - post  0.0073315572 0.01692918 38   0.433  0.9021
## 
## session.order = anodal first, stimulation = cathodal, lag = X3:
##  contrast         estimate         SE df t.ratio p.value
##  pre - tDCS   0.0356591448 0.01590619 38   2.242  0.0770
##  pre - post   0.0349156795 0.01621556 38   2.153  0.0927
##  tDCS - post -0.0007434653 0.01428919 38  -0.052  0.9985
## 
## session.order = cathodal first, stimulation = cathodal, lag = X3:
##  contrast         estimate         SE df t.ratio p.value
##  pre - tDCS  -0.0210172897 0.01438769 38  -1.461  0.3209
##  pre - post  -0.0240854502 0.01466752 38  -1.642  0.2408
##  tDCS - post -0.0030681605 0.01292505 38  -0.237  0.9694
## 
## session.order = anodal first, stimulation = anodal, lag = X8:
##  contrast         estimate         SE df t.ratio p.value
##  pre - tDCS   0.0392051802 0.01377945 38   2.845  0.0190
##  pre - post   0.0428061346 0.01921238 38   2.228  0.0792
##  tDCS - post  0.0036009544 0.01834133 38   0.196  0.9790
## 
## session.order = cathodal first, stimulation = anodal, lag = X8:
##  contrast         estimate         SE df t.ratio p.value
##  pre - tDCS   0.0243922150 0.01246398 38   1.957  0.1369
##  pre - post   0.0147587514 0.01737825 38   0.849  0.6751
##  tDCS - post -0.0096334636 0.01659036 38  -0.581  0.8312
## 
## session.order = anodal first, stimulation = cathodal, lag = X8:
##  contrast         estimate         SE df t.ratio p.value
##  pre - tDCS   0.0006259651 0.01557344 38   0.040  0.9991
##  pre - post  -0.0057515814 0.01754902 38  -0.328  0.9426
##  tDCS - post -0.0063775465 0.01630347 38  -0.391  0.9193
## 
## session.order = cathodal first, stimulation = cathodal, lag = X8:
##  contrast         estimate         SE df t.ratio p.value
##  pre - tDCS   0.0064954810 0.01408670 38   0.461  0.8898
##  pre - post   0.0093217803 0.01587368 38   0.587  0.8278
##  tDCS - post  0.0028262994 0.01474704 38   0.192  0.9800
## 
## P value adjustment: tukey method for comparing a family of 3 estimates
</pre>
<p>The <code>pre - post</code> contrast for lag 3, anodal stimulation in the anodal-first group is indeed significant (but the <code>pre - tDCS</code> difference is not). There is also an effect for lag 8, the <code>pre - tDCS</code> contrast is significant there (but not <code>pre - post</code>).</p>
<hr />
<p>However, all in all, I favor the 1st interpretation of the four-way interaction (i.e. in terms of the learning effect, which does not occur at lag 8):</p>
<ul>
<li>It’s more consistent with study 1 (also occurs there, albeit in slightly different form)</li>
<li>Unless there’s really a carryover effect, it’s not clear why the hypothesized effect would only occur in the “anodal first” group. A learning effect seems more intuitive.</li>
<li>The differences between the two stimulation sessions (anodal and cathodal) are most pronounced <em>before</em> tDCS onset.</li>
</ul>
</div>
</div>
<div id="study-2---t1" class="section level3">
<h3>Study 2 - T1</h3>
<ul>
<li><strong>DV</strong>: <code>T1</code>: Proportion of trials in which T1 was identified correctly.</li>
<li><strong>Between-subject factor</strong>: <code>session.order</code>, 2 levels: Whether participant received <em>anodal</em> or <em>cathodal</em> tDCS in the first session (<code>anodal_first</code> vs. <code>cathodal_first</code>).</li>
<li><strong>Within-subject factors</strong>:
<ol style="list-style-type: decimal">
<li><code>block</code>, 3 levels: Whether data is before (<em>pre</em>), during (<em>tDCS</em>) or after (<em>post</em>) tDCS</li>
<li><code>stimulation</code>, 2 levels: Whether participant received <em>anodal</em> or <em>cathodal</em> tDCS</li>
<li><code>lag</code>, 2 levels: Whether T2 followed T1 after 2 distractors (<em>lag 3</em>), or after 7 distractors (<em>lag 8</em>).</li>
</ol></li>
<li><strong>Subject identifier</strong>: <code>subject</code> (n = 40).</li>
</ul>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" data-line-number="1">aov_study2_T1 &lt;-<span class="st"> </span><span class="kw">aov_car</span>(T1 <span class="op">~</span><span class="st"> </span>session.order <span class="op">+</span><span class="st"> </span><span class="kw">Error</span>(subject<span class="op">/</span>(block<span class="op">*</span>stimulation<span class="op">*</span>lag)), </a>
<a class="sourceLine" id="cb56-2" data-line-number="2">        <span class="dt">data =</span> df_study2)</a></code></pre></div>
<pre><code>## Contrasts set to contr.sum for the following variables: session.order</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" data-line-number="1"><span class="kw">kable</span>(<span class="kw">nice</span>(aov_study2_T1), <span class="dt">caption =</span> <span class="st">&quot;Study 2: RM ANOVA on T1 performance&quot;</span>)</a></code></pre></div>
<table>
<caption>Study 2: RM ANOVA on T1 performance</caption>
<thead>
<tr class="header">
<th align="left">Effect</th>
<th align="left">df</th>
<th align="left">MSE</th>
<th align="left">F</th>
<th align="left">ges</th>
<th align="left">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">session.order</td>
<td align="left">1, 38</td>
<td align="left">0.09</td>
<td align="left">0.96</td>
<td align="left">.02</td>
<td align="left">.33</td>
</tr>
<tr class="even">
<td align="left">block</td>
<td align="left">1.89, 71.87</td>
<td align="left">0.00</td>
<td align="left">6.64 **</td>
<td align="left">.010</td>
<td align="left">.003</td>
</tr>
<tr class="odd">
<td align="left">session.order:block</td>
<td align="left">1.89, 71.87</td>
<td align="left">0.00</td>
<td align="left">0.60</td>
<td align="left">.0009</td>
<td align="left">.54</td>
</tr>
<tr class="even">
<td align="left">stimulation</td>
<td align="left">1, 38</td>
<td align="left">0.01</td>
<td align="left">0.00</td>
<td align="left">&lt;.0001</td>
<td align="left">&gt;.99</td>
</tr>
<tr class="odd">
<td align="left">session.order:stimulation</td>
<td align="left">1, 38</td>
<td align="left">0.01</td>
<td align="left">11.24 **</td>
<td align="left">.03</td>
<td align="left">.002</td>
</tr>
<tr class="even">
<td align="left">lag</td>
<td align="left">1, 38</td>
<td align="left">0.00</td>
<td align="left">29.23 ***</td>
<td align="left">.01</td>
<td align="left">&lt;.0001</td>
</tr>
<tr class="odd">
<td align="left">session.order:lag</td>
<td align="left">1, 38</td>
<td align="left">0.00</td>
<td align="left">0.04</td>
<td align="left">&lt;.0001</td>
<td align="left">.84</td>
</tr>
<tr class="even">
<td align="left">block:stimulation</td>
<td align="left">1.92, 73.08</td>
<td align="left">0.00</td>
<td align="left">0.24</td>
<td align="left">.0002</td>
<td align="left">.78</td>
</tr>
<tr class="odd">
<td align="left">session.order:block:stimulation</td>
<td align="left">1.92, 73.08</td>
<td align="left">0.00</td>
<td align="left">9.94 ***</td>
<td align="left">.007</td>
<td align="left">.0002</td>
</tr>
<tr class="even">
<td align="left">block:lag</td>
<td align="left">1.93, 73.20</td>
<td align="left">0.00</td>
<td align="left">1.91</td>
<td align="left">.001</td>
<td align="left">.16</td>
</tr>
<tr class="odd">
<td align="left">session.order:block:lag</td>
<td align="left">1.93, 73.20</td>
<td align="left">0.00</td>
<td align="left">0.19</td>
<td align="left">.0001</td>
<td align="left">.82</td>
</tr>
<tr class="even">
<td align="left">stimulation:lag</td>
<td align="left">1, 38</td>
<td align="left">0.00</td>
<td align="left">0.31</td>
<td align="left">&lt;.0001</td>
<td align="left">.58</td>
</tr>
<tr class="odd">
<td align="left">session.order:stimulation:lag</td>
<td align="left">1, 38</td>
<td align="left">0.00</td>
<td align="left">0.96</td>
<td align="left">.0003</td>
<td align="left">.33</td>
</tr>
<tr class="even">
<td align="left">block:stimulation:lag</td>
<td align="left">1.86, 70.75</td>
<td align="left">0.00</td>
<td align="left">0.31</td>
<td align="left">.0002</td>
<td align="left">.72</td>
</tr>
<tr class="odd">
<td align="left">session.order:block:stimulation:lag</td>
<td align="left">1.86, 70.75</td>
<td align="left">0.00</td>
<td align="left">0.53</td>
<td align="left">.0004</td>
<td align="left">.58</td>
</tr>
</tbody>
</table>
<div id="main-effect-of-lag-2" class="section level4">
<h4>Main effect of lag</h4>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" data-line-number="1"><span class="kw">afex_plot</span>(aov_study2_T1, <span class="dt">x =</span> <span class="st">&quot;lag&quot;</span>, <span class="dt">error =</span> <span class="st">&quot;within&quot;</span>)</a></code></pre></div>
<div class="figure">
<img src="AB-tDCS_group_files/figure-html/study%202%20T1-%20plot%20lag-1.png" alt="Study 2 - T1 main effect of Lag" width="576" />
<p class="caption">
Study 2 - T1 main effect of Lag
</p>
</div>
<p>Like T2|T1, T1 performance is also worse for the short lag (though only a little). Seems to be mostly driven by a few participants with relatively bad short-lag performance for T1. This effect was also reported in study 1.</p>
</div>
<div id="main-effect-of-block-1" class="section level4">
<h4>Main effect of block</h4>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" data-line-number="1"><span class="kw">afex_plot</span>(aov_study2_T1, <span class="dt">x =</span> <span class="st">&quot;block&quot;</span>, <span class="dt">error =</span> <span class="st">&quot;within&quot;</span>)</a></code></pre></div>
<div class="figure">
<img src="AB-tDCS_group_files/figure-html/study%202%20T1%20-%20plot%20block-1.png" alt="Study 2 - T1 main effect of Block" width="576" />
<p class="caption">
Study 2 - T1 main effect of Block
</p>
</div>
<p>T1 performance seems to decrease slightly over the session. In study 1 this was also the case, for T1 and T2|T1, though here there was no effect of block on T2|T1.</p>
</div>
<div id="interaction-stimulation-by-session-order-2" class="section level4">
<h4>Interaction: stimulation by session order</h4>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" data-line-number="1"><span class="kw">afex_plot</span>(aov_study2_T1, <span class="dt">x =</span> <span class="st">&quot;stimulation&quot;</span>, <span class="dt">trace =</span> <span class="st">&quot;session.order&quot;</span>, <span class="dt">error =</span> <span class="st">&quot;none&quot;</span>)</a></code></pre></div>
<div class="figure">
<img src="AB-tDCS_group_files/figure-html/study%202%20T1%20-%20plot%20stimulation%20by%20session%20order-1.png" alt="Study 2 - T1: Stimulation by Session Order" width="576" />
<p class="caption">
Study 2 - T1: Stimulation by Session Order
</p>
</div>
<p>This interaction was also present for T2|T1 in both studies. There it seemed to reflect a learning effect, but here it goes in the opposite direction: T1 performance is worse in the 2nd session than the first…</p>
</div>
<div id="interaction-stimulation-by-session-order-by-block-1" class="section level4">
<h4>Interaction: stimulation by session order by block</h4>
<p>There is also a higher-order interaction with Block:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" data-line-number="1"><span class="kw">afex_plot</span>(aov_study2_T1, <span class="dt">x =</span> <span class="st">&quot;stimulation&quot;</span>, <span class="dt">trace =</span>  <span class="st">&quot;session.order&quot;</span>, <span class="dt">panel =</span> <span class="st">&quot;block&quot;</span>, <span class="dt">error =</span> <span class="st">&quot;none&quot;</span>)</a></code></pre></div>
<div class="figure">
<img src="AB-tDCS_group_files/figure-html/study%202%20-%20T1%20plot%20threeway-1.png" alt="Study 2 - T1: Stimulation by Session Order by Block" width="576" />
<p class="caption">
Study 2 - T1: Stimulation by Session Order by Block
</p>
</div>
<p>The two-way interaction is strongest in the later two blocks. Again, this is the inverse of the learning effect, which was strongest in the first block.</p>
</div>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>London, R. E., &amp; Slagter, H. A. (2015). Effects of transcranial direct current stimulation over left dorsolateral pFC on the attentional blink depend on individual baseline performance. <em>Journal of Cognitive Neuroscience, 27(12)</em>, 2382-2393. doi: <a href="https://doi.org/10.1162/jocn_a_00867">10.1162/jocn_a_00867</a><a href="#fnref1" class="footnote-back">↩</a></p></li>
</ol>
</div>
</div>

&nbsp;
<hr />
<p style="text-align: center;"><a href="https://lcreteig.github.io">Leon Reteig</a></p>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://twitter.com/leonreteig" class="fa fa-twitter"></a>
    <a href="https://github.com/lcreteig" class="fa fa-github"></a>
</p>

    </div>
    <div class="col-md-2">
      <div id="toc">
      	<button type="button" class="close">×</button>
        <ul>
        <li><a href="#setup-environment">Setup environment</a></li>
        <li><a href="#load-task-data">Load task data</a><ul>
        <li><a href="#study-2">Study 2</a></li>
        <li><a href="#study-1">Study 1</a></li>
        </ul></li>
        <li><a href="#group-analysis">Group analysis</a><ul>
        <li><a href="#line-plots-cf.london-slagter-2015">Line plots cf. London &amp; Slagter (2015)</a></li>
        <li><a href="#rm-anova">RM ANOVA</a></li>
        </ul></li>
        </ul>
      </div>
    </div>
  </div>
</div>

<script>
$(document).ready(function () {

  // add bootstrap table styles to pandoc tables
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');

});
</script>

<script>
$(document).ready(function () {
 	 	$('#content img')
 	  .addClass("image-thumb");
      $('#content img')
 	  .addClass("image-lb");
  $('#content').magnificPopup({
	      type:'image',
	      closeOnContentClick: false,
	      delegate: 'img',
	      gallery: {enabled: true },
	      image: {
	        verticalFit: true,
          titleSrc: 'alt'
	      }
 	    });
 	});
</script>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
