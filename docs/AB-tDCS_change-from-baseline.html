<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="pandoc" />

        <meta name="author" content="Leon Reteig" />
    
    
    <title>AB-tDCS</title>

        <script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="site_libs/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" />
    <script src="site_libs/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
    <script src="site_libs/navigation-1.1/tabsets.js"></script>
    <link href="site_libs/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
    <script src="site_libs/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
    <link href="site_libs/clean-0.1/clean.css" rel="stylesheet" />
    <script src="site_libs/clean-0.1/clean.js"></script>
    <link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
    <link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
        <br>
    <br>
    <br>
    &nbsp;
    <p style="text-align: center;"><a href="https://lcreteig.github.io/AB-tDCS">Project website</a></p>
    <p style="text-align: center;"> Data and other resources: <a href="https://osf.io/y6hsf/">Open Science Framework</a></p>
    <p style="text-align: center;"> Source code: <a href="https://github.com/lcreteig/AB-tDCS">Github</a></p>
    &nbsp;
    <hr />
    
    
        <style type="text/css">code{white-space: pre;}</style>
    <style type="text/css">
      a.sourceLine { display: inline-block; line-height: 1.25; }
      a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
      a.sourceLine:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode { white-space: pre; position: relative; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      code.sourceCode { white-space: pre-wrap; }
      a.sourceLine { text-indent: -1em; padding-left: 1em; }
      }
      pre.numberSource a.sourceLine
        { position: relative; left: -4em; }
      pre.numberSource a.sourceLine::before
        { content: attr(data-line-number);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; pointer-events: all; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
          color: #aaaaaa;
        }
      pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
      div.sourceCode
        {  }
      @media screen {
      a.sourceLine::before { text-decoration: underline; }
      }
      code span.al { color: #ff0000; font-weight: bold; } /* Alert */
      code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
      code span.at { color: #7d9029; } /* Attribute */
      code span.bn { color: #40a070; } /* BaseN */
      code span.bu { } /* BuiltIn */
      code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
      code span.ch { color: #4070a0; } /* Char */
      code span.cn { color: #880000; } /* Constant */
      code span.co { color: #60a0b0; font-style: italic; } /* Comment */
      code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
      code span.do { color: #ba2121; font-style: italic; } /* Documentation */
      code span.dt { color: #902000; } /* DataType */
      code span.dv { color: #40a070; } /* DecVal */
      code span.er { color: #ff0000; font-weight: bold; } /* Error */
      code span.ex { } /* Extension */
      code span.fl { color: #40a070; } /* Float */
      code span.fu { color: #06287e; } /* Function */
      code span.im { } /* Import */
      code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
      code span.kw { color: #007020; font-weight: bold; } /* Keyword */
      code span.op { color: #666666; } /* Operator */
      code span.ot { color: #007020; } /* Other */
      code span.pp { color: #bc7a00; } /* Preprocessor */
      code span.sc { color: #4070a0; } /* SpecialChar */
      code span.ss { color: #bb6688; } /* SpecialString */
      code span.st { color: #4070a0; } /* String */
      code span.va { color: #19177c; } /* Variable */
      code span.vs { color: #4070a0; } /* VerbatimString */
      code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    </style>
    
    
    <!-- tabsets -->
    <script>
      $(document).ready(function () {
	  window.buildTabsets("toc");
      });
      $(document).ready(function () {
	  $('.tabset-dropdown > .nav-tabs > li').click(function () {
	      $(this).parent().toggleClass('nav-tabs-open')
	  });
      });
    </script>

    <!-- code folding -->
    
    <!-- code download -->
    
    <!-- tabsets dropdown -->

    <style type="text/css">
      .tabset-dropdown > .nav-tabs {
	  display: inline-table;
	  max-height: 500px;
	  min-height: 44px;
	  overflow-y: auto;
	  background: white;
	  border: 1px solid #ddd;
	  border-radius: 4px;
      }
      
      .tabset-dropdown > .nav-tabs > li.active:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
	  content: "&#xe258;";
	  border: none;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs > li.active {
	  display: block;
      }

      .tabset-dropdown > .nav-tabs > li.active a {
  	  padding: 0 15px !important;
      }

      .tabset-dropdown > .nav-tabs > li > a,
      .tabset-dropdown > .nav-tabs > li > a:focus,
      .tabset-dropdown > .nav-tabs > li > a:hover {
	  border: none;
	  display: inline-block;
	  border-radius: 4px;
	  background-color: transparent;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li {
	  display: block;
	  float: none;
      }
      
      .tabset-dropdown > .nav-tabs > li {
	  display: none;
	  margin-left: 0 !important;
      }
    </style>
    
</head>

<body class="preload">

      <!-- html_clean start -->
   <div class="container-fluid main-container">
     <div class="row">
       <div class="col-md-10">
               
   
      
   <div class="navbar navbar-default  navbar-fixed-top" role="navigation">
     <div class="container">
       <div class="navbar-header">
         <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
           <span class="icon-bar"></span>
           <span class="icon-bar"></span>
           <span class="icon-bar"></span>
         </button>
         <a class="navbar-brand" href="index.html"></a>
       </div>
       <div id="navbar" class="navbar-collapse collapse">
         <ul class="nav navbar-nav">
           <li>
     <a href="index.html">
       <span class="fas fa-info"></span>
        
       About
     </a>
   </li>
   <li>
     <a href="AB-tDCS_paper.html">
       <span class="fas fa-newspaper"></span>
        
       Paper
     </a>
   </li>
   <li class="dropdown">
     <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
       <span class="fas fa-file-code"></span>
        
       Analyses
        
       <span class="caret"></span>
     </a>
     <ul class="dropdown-menu" role="menu">
       <li class="dropdown-header">Individual differences</li>
       <li>
         <a href="AB-tDCS_change-from-baseline.html">Change from baseline</a>
       </li>
       <li>
         <a href="AB-tDCS_anodal-vs-cathodal.html">Anodal vs. cathodal</a>
       </li>
       <li>
         <a href="AB-tDCS_replication-analyses.html">Replication analyses</a>
       </li>
       <li class="divider"></li>
       <li class="dropdown-header">Group-level</li>
       <li>
         <a href="AB-tDCS_group.html">Task</a>
       </li>
       <li>
         <a href="AB-tDCS_questionnaires.html">Questionnaires</a>
       </li>
     </ul>
   </li>
         </ul>
         <ul class="nav navbar-nav navbar-right">
           <li>
     <a href="https://github.com/lcreteig/AB-tDCS">
       <span class="fas fa-github"></span>
        
       Source
     </a>
   </li>
         </ul>
       </div><!--/.nav-collapse -->
     </div><!--/.container -->
   </div><!--/.navbar -->
        
      <h1 class="title">AB-tDCS</h1>
         <h1 class="subtitle">Change from baseline analyses</h1>
   
      
      <!-- html_clean authors -->
         <h4 class="author"><em>Leon Reteig</em></h4>
            <h4 class="date"><em>22 May, 2021</em></h4>
      
      
   
<!-- Don't indent these lines or it will mess pre blocks indentation --> 
<div id="content">
<div id="setup-environment" class="section level1">
<h1>Setup environment</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># Load packages</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(tidyverse)  <span class="co"># importing, transforming, and visualizing data frames</span></a></code></pre></div>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.0 ──</code></pre>
<pre><code>## ✓ ggplot2 3.3.3     ✓ purrr   0.3.4
## ✓ tibble  3.0.6     ✓ dplyr   1.0.4
## ✓ tidyr   1.1.2     ✓ stringr 1.4.0
## ✓ readr   1.4.0     ✓ forcats 0.5.1</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">library</span>(here) <span class="co"># (relative) file paths</span></a></code></pre></div>
<pre><code>## here() starts at /Users/leonreteig/AB-tDCS</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">library</span>(knitr) <span class="co"># R notebook output</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw">library</span>(scales) <span class="co"># Percentage axis labels </span></a></code></pre></div>
<pre><code>## 
## Attaching package: &#39;scales&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     discard</code></pre>
<pre><code>## The following object is masked from &#39;package:readr&#39;:
## 
##     col_factor</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">library</span>(ggm) <span class="co"># partial correlations</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="kw">library</span>(BayesFactor) <span class="co"># Bayesian statistics</span></a></code></pre></div>
<pre><code>## Loading required package: coda</code></pre>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## 
## Attaching package: &#39;Matrix&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:tidyr&#39;:
## 
##     expand, pack, unpack</code></pre>
<pre><code>## ************
## Welcome to BayesFactor 0.9.12-4.2. If you have questions, please contact Richard Morey (richarddmorey@gmail.com).
## 
## Type BFManual() to open the manual.
## ************</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw">library</span>(knitrhooks) <span class="co"># printing in rmarkdown outputs</span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2">  <span class="kw">output_max_height</span>()</a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="co"># Source functions</span></a>
<a class="sourceLine" id="cb17-4" data-line-number="4"><span class="kw">source</span>(<span class="kw">here</span>(<span class="st">&quot;src&quot;</span>, <span class="st">&quot;func&quot;</span>, <span class="st">&quot;behavioral_analysis.R&quot;</span>)) <span class="co"># loading data and calculating measures</span></a>
<a class="sourceLine" id="cb17-5" data-line-number="5">knitr<span class="op">::</span><span class="kw">read_chunk</span>(<span class="kw">here</span>(<span class="st">&quot;src&quot;</span>, <span class="st">&quot;func&quot;</span>, <span class="st">&quot;behavioral_analysis.R&quot;</span>)) <span class="co"># display code from file in this notebook</span></a>
<a class="sourceLine" id="cb17-6" data-line-number="6">load_data_path &lt;-<span class="st"> </span><span class="kw">here</span>(<span class="st">&quot;src&quot;</span>,<span class="st">&quot;func&quot;</span>,<span class="st">&quot;load_data.Rmd&quot;</span>) <span class="co"># for rerunning and displaying</span></a>
<a class="sourceLine" id="cb17-7" data-line-number="7"><span class="kw">source</span>(<span class="kw">here</span>(<span class="st">&quot;src&quot;</span>, <span class="st">&quot;lib&quot;</span>, <span class="st">&quot;corr_change_baseline.R&quot;</span>)) <span class="co"># variance test / baseline vs. change-from-baseline correlation </span></a></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw">print</span>(<span class="kw">sessionInfo</span>())</a></code></pre></div>
<pre style = "max-height:300px; overflow-y: auto;">## R version 3.6.2 (2019-12-12)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS Catalina 10.15.7
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices datasets  utils     methods   base     
## 
## other attached packages:
##  [1] knitrhooks_0.0.4       BayesFactor_0.9.12-4.2 Matrix_1.3-2          
##  [4] coda_0.19-4            ggm_2.5                scales_1.1.1          
##  [7] knitr_1.31             here_1.0.1             forcats_0.5.1         
## [10] stringr_1.4.0          dplyr_1.0.4            purrr_0.3.4           
## [13] readr_1.4.0            tidyr_1.1.2            tibble_3.0.6          
## [16] ggplot2_3.3.3          tidyverse_1.3.0       
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_1.0.6         lubridate_1.7.9.2  mvtnorm_1.1-1      lattice_0.20-41   
##  [5] gtools_3.8.2       assertthat_0.2.1   rprojroot_2.0.2    digest_0.6.27     
##  [9] R6_2.5.0           cellranger_1.1.0   backports_1.2.1    MatrixModels_0.5-0
## [13] reprex_1.0.0       evaluate_0.14      httr_1.4.2         pillar_1.4.7      
## [17] rlang_0.4.10       readxl_1.3.1       rstudioapi_0.13    rmarkdown_2.7     
## [21] igraph_1.2.6       munsell_0.5.0      broom_0.7.4.9000   compiler_3.6.2    
## [25] modelr_0.1.8       xfun_0.21          pkgconfig_2.0.3    htmltools_0.5.1.1 
## [29] tidyselect_1.1.0   bookdown_0.21      crayon_1.4.1       dbplyr_2.1.0      
## [33] withr_2.4.1        grid_3.6.2         jsonlite_1.7.2     gtable_0.3.0      
## [37] lifecycle_1.0.0    DBI_1.1.1          magrittr_2.0.1     rmdformats_1.0.1  
## [41] cli_2.3.0          stringi_1.5.3      pbapply_1.4-3      renv_0.12.5-72    
## [45] fs_1.5.0           xml2_1.3.2         ellipsis_0.3.1     generics_0.1.0    
## [49] vctrs_0.3.6        tools_3.6.2        glue_1.4.2         hms_1.0.0         
## [53] parallel_3.6.2     yaml_2.2.1         colorspace_2.0-0   rvest_0.3.6       
## [57] haven_2.3.1
</pre>
</div>
<div id="load-task-data" class="section level1">
<h1>Load task data</h1>
<div id="study-2" class="section level2">
<h2>Study 2</h2>
<p>The following participants are excluded from further analysis at this point, because of incomplete data:</p>
<ul>
<li><code>S03</code>, <code>S14</code>, <code>S29</code>, <code>S38</code>, <code>S43</code>, <code>S46</code>: their T1 performance in session 1 was less than 63% correct, so they were not invited back. This cutoff was determined based on a separate pilot study with 10 participants. It is two standard deviations below the mean of that sample.</li>
<li><code>S25</code> has no data for session 2, as they stopped responding to requests for scheduling the session</li>
<li><code>S31</code> was excluded as a precaution after session 1, as they developed a severe headache and we could not rule out the possibility this was related to the tDCS</li>
</ul>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">dataDir_study2 &lt;-<span class="st"> </span><span class="kw">here</span>(<span class="st">&quot;data&quot;</span>) <span class="co"># root folder with AB task data</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2">subs_incomplete &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;S03&quot;</span>, <span class="st">&quot;S14&quot;</span>, <span class="st">&quot;S25&quot;</span>, <span class="st">&quot;S29&quot;</span>, <span class="st">&quot;S31&quot;</span>, <span class="st">&quot;S38&quot;</span>, <span class="st">&quot;S43&quot;</span>, <span class="st">&quot;S46&quot;</span>) <span class="co"># don&#39;t try to load data from these participants</span></a>
<a class="sourceLine" id="cb19-3" data-line-number="3">df_study2 &lt;-<span class="st"> </span><span class="kw">load_data_study2</span>(dataDir_study2, subs_incomplete) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-4" data-line-number="4"><span class="st">  </span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># discard rows with data from incomplete subjects</span></a>
<a class="sourceLine" id="cb19-5" data-line-number="5"><span class="st">   </span><span class="co"># recode first.session (&quot;anodal&quot; or &quot;cathodal&quot;) to session.order (&quot;anodal first&quot;, &quot;cathodal first&quot;)</span></a>
<a class="sourceLine" id="cb19-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">first.session =</span> <span class="kw">parse_factor</span>(<span class="kw">paste</span>(first.session, <span class="st">&quot;first&quot;</span>), </a>
<a class="sourceLine" id="cb19-7" data-line-number="7">                                      <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;anodal first&quot;</span>, <span class="st">&quot;cathodal first&quot;</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-8" data-line-number="8"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">session.order =</span> first.session)</a>
<a class="sourceLine" id="cb19-9" data-line-number="9">n_study2 &lt;-<span class="st"> </span><span class="kw">n_distinct</span>(df_study2<span class="op">$</span>subject) <span class="co"># number of subjects in study 2</span></a></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw">kable</span>(<span class="kw">head</span>(df_study2,<span class="dv">13</span>), <span class="dt">digits =</span> <span class="dv">1</span>, <span class="dt">caption =</span> <span class="st">&quot;Data frame for study 2&quot;</span>)</a></code></pre></div>
<table>
<caption>Data frame for study 2</caption>
<thead>
<tr class="header">
<th align="left">subject</th>
<th align="left">session.order</th>
<th align="left">stimulation</th>
<th align="left">block</th>
<th align="left">lag</th>
<th align="right">trials</th>
<th align="right">T1</th>
<th align="right">T2</th>
<th align="right">T2.given.T1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">anodal</td>
<td align="left">pre</td>
<td align="left">3</td>
<td align="right">118</td>
<td align="right">0.8</td>
<td align="right">0.4</td>
<td align="right">0.4</td>
</tr>
<tr class="even">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">anodal</td>
<td align="left">pre</td>
<td align="left">8</td>
<td align="right">60</td>
<td align="right">0.8</td>
<td align="right">0.8</td>
<td align="right">0.8</td>
</tr>
<tr class="odd">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">anodal</td>
<td align="left">tDCS</td>
<td align="left">3</td>
<td align="right">126</td>
<td align="right">0.8</td>
<td align="right">0.3</td>
<td align="right">0.3</td>
</tr>
<tr class="even">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">anodal</td>
<td align="left">tDCS</td>
<td align="left">8</td>
<td align="right">65</td>
<td align="right">0.8</td>
<td align="right">0.7</td>
<td align="right">0.7</td>
</tr>
<tr class="odd">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">anodal</td>
<td align="left">post</td>
<td align="left">3</td>
<td align="right">122</td>
<td align="right">0.8</td>
<td align="right">0.2</td>
<td align="right">0.3</td>
</tr>
<tr class="even">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">anodal</td>
<td align="left">post</td>
<td align="left">8</td>
<td align="right">61</td>
<td align="right">0.7</td>
<td align="right">0.7</td>
<td align="right">0.7</td>
</tr>
<tr class="odd">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">cathodal</td>
<td align="left">pre</td>
<td align="left">3</td>
<td align="right">116</td>
<td align="right">0.8</td>
<td align="right">0.4</td>
<td align="right">0.4</td>
</tr>
<tr class="even">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">cathodal</td>
<td align="left">pre</td>
<td align="left">8</td>
<td align="right">60</td>
<td align="right">0.7</td>
<td align="right">0.8</td>
<td align="right">0.8</td>
</tr>
<tr class="odd">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">cathodal</td>
<td align="left">tDCS</td>
<td align="left">3</td>
<td align="right">129</td>
<td align="right">0.7</td>
<td align="right">0.4</td>
<td align="right">0.4</td>
</tr>
<tr class="even">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">cathodal</td>
<td align="left">tDCS</td>
<td align="left">8</td>
<td align="right">64</td>
<td align="right">0.7</td>
<td align="right">0.8</td>
<td align="right">0.9</td>
</tr>
<tr class="odd">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">cathodal</td>
<td align="left">post</td>
<td align="left">3</td>
<td align="right">128</td>
<td align="right">0.6</td>
<td align="right">0.4</td>
<td align="right">0.4</td>
</tr>
<tr class="even">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">cathodal</td>
<td align="left">post</td>
<td align="left">8</td>
<td align="right">62</td>
<td align="right">0.7</td>
<td align="right">0.8</td>
<td align="right">0.8</td>
</tr>
<tr class="odd">
<td align="left">S02</td>
<td align="left">cathodal first</td>
<td align="left">anodal</td>
<td align="left">pre</td>
<td align="left">3</td>
<td align="right">124</td>
<td align="right">1.0</td>
<td align="right">0.8</td>
<td align="right">0.8</td>
</tr>
</tbody>
</table>
<p>The data has the following columns:</p>
<ul>
<li><strong>subject</strong>: Participant ID, e.g. <code>S01</code>, <code>S12</code></li>
<li><strong>session.order</strong>: Whether participant received <code>anodal</code> or <code>cathodal</code> tDCS in the first session (<code>anodal_first</code> vs. <code>cathodal_first</code>).</li>
<li><strong>stimulation</strong>: Whether participant received <code>anodal</code> or <code>cathodal</code> tDCS</li>
<li><strong>block</strong>: Whether data is before (<code>pre), during (</code>tDCS<code>) or after (</code>post`) tDCS</li>
<li><strong>lag</strong>: Whether T2 followed T1 after two distractors (lag <code>3</code>) or after 7 distractors (lag <code>8</code>)</li>
<li><strong>trials</strong>: Number of trials per lag that the participant completed in this block</li>
<li><strong>T1</strong>: Proportion of trials (out of <code>trials</code>) in which T1 was identified correctly</li>
<li><strong>T2</strong>: Proportion of trials (out of <code>trials</code>) in which T2 was identified correctly</li>
<li><strong>T2.given.T1</strong>: Proportion of trials which T2 was identified correctly, out of the trials in which T1 was idenitified correctly (T2|T1).</li>
</ul>
<p>The number of trials vary from person-to-person, as some completed more trials in a 20-minute block than others (because responses were self-paced):</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">df_study2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(lag) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-3" data-line-number="3"><span class="st">  </span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(trials), <span class="kw">funs</span>(mean, min, max, sd)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-4" data-line-number="4"><span class="st">  </span><span class="kw">kable</span>(<span class="dt">caption =</span> <span class="st">&quot;Descriptive statistics for trial counts per lag&quot;</span>, <span class="dt">digits =</span> <span class="dv">0</span>)</a></code></pre></div>
<pre><code>## Warning: `funs()` was deprecated in dplyr 0.8.0.
## Please use a list of either functions or lambdas: 
## 
##   # Simple named list: 
##   list(mean = mean, median = median)
## 
##   # Auto named with `tibble::lst()`: 
##   tibble::lst(mean, median)
## 
##   # Using lambdas
##   list(~ mean(., trim = .2), ~ median(., na.rm = TRUE))</code></pre>
<table>
<caption>Descriptive statistics for trial counts per lag</caption>
<thead>
<tr class="header">
<th align="left">lag</th>
<th align="right">mean</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">3</td>
<td align="right">130</td>
<td align="right">78</td>
<td align="right">163</td>
<td align="right">17</td>
</tr>
<tr class="even">
<td align="left">8</td>
<td align="right">65</td>
<td align="right">39</td>
<td align="right">87</td>
<td align="right">9</td>
</tr>
</tbody>
</table>
</div>
<div id="study-1" class="section level2">
<h2>Study 1</h2>
<p>These data were used for statistical analysis in London &amp; Slagter (2021)<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>, and were processed by the lead author:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1">dataPath_study1 &lt;-<span class="st"> </span><span class="kw">here</span>(<span class="st">&quot;data&quot;</span>,<span class="st">&quot;AB-tDCS_study1.txt&quot;</span>)</a>
<a class="sourceLine" id="cb23-2" data-line-number="2">data_study1_fromDisk &lt;-<span class="st"> </span><span class="kw">read.table</span>(dataPath_study1, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">dec =</span> <span class="st">&quot;,&quot;</span>)</a>
<a class="sourceLine" id="cb23-3" data-line-number="3"><span class="kw">glimpse</span>(data_study1_fromDisk)</a></code></pre></div>
<pre style = "max-height:300px; overflow-y: auto;">## Rows: 34
## Columns: 120
## $ SD_T1                           <dbl> 0.3313, 0.0289, -0.8027, -0.5381, -2.…
## $ MeanBLT1Acc                     <dbl> 0.8800, 0.8600, 0.8050, 0.8225, 0.665…
## $ First_Session                   <int> 1, 2, 1, 1, 2, 1, 2, 1, 2, 2, 1, 2, 1…
## $ fileno                          <fct> pp4, pp6, pp7, pp9, pp10, pp11, pp12,…
## $ AB_HighLow                      <dbl> 2, 1, 2, 1, 1, 1, 1, 1, 2, 1, 1, 2, 1…
## $ vb_T1_2_NP                      <dbl> 0.925, 0.875, 0.825, 0.625, 0.650, 0.…
## $ vb_T1_4_NP                      <dbl> 0.800, 0.825, 0.825, 0.825, 0.675, 0.…
## $ vb_T1_10_NP                     <dbl> 0.925, 0.925, 0.800, 0.775, 0.825, 0.…
## $ vb_T1_4_P                       <dbl> 0.850, 0.900, 0.825, 0.775, 0.625, 0.…
## $ vb_T1_10_P                      <dbl> 0.825, 0.900, 0.775, 0.825, 0.625, 0.…
## $ vb_NB_2_NP                      <dbl> 0.1351, 0.3429, 0.3636, 0.3600, 0.346…
## $ vb_NB_4_NP                      <dbl> 0.3125, 0.5455, 0.5455, 0.3030, 0.296…
## $ vb_NB_10_NP                     <dbl> 0.8378, 0.8108, 0.9688, 0.6129, 0.727…
## $ vb_NB_4_P                       <dbl> 0.2941, 0.5278, 0.6061, 0.3226, 0.520…
## $ vb_NB_10_P                      <dbl> 0.8485, 0.7778, 0.9032, 0.8182, 0.680…
## $ VB_AB                           <dbl> 0.7027, 0.4680, 0.6051, 0.2529, 0.381…
## $ VB_REC                          <dbl> 0.5253, 0.2654, 0.4233, 0.3099, 0.431…
## $ VB_PE                           <dbl> -0.0184, -0.0177, 0.0606, 0.0196, 0.2…
## $ tb_T1_2_NP                      <dbl> 0.775, 0.875, 0.675, 0.725, 0.475, 0.…
## $ tb_T1_4_NP                      <dbl> 0.825, 0.825, 0.700, 0.750, 0.675, 0.…
## $ tb_T1_10_NP                     <dbl> 0.875, 0.900, 0.700, 0.825, 0.500, 0.…
## $ tb_T1_4_P                       <dbl> 0.875, 0.800, 0.700, 0.775, 0.650, 0.…
## $ tb_T1_10_P                      <dbl> 0.850, 0.925, 0.800, 0.825, 0.625, 0.…
## $ tb_NB_2_NP                      <dbl> 0.1290, 0.5143, 0.2222, 0.0690, 0.315…
## $ tb_NB_4_NP                      <dbl> 0.3333, 0.5455, 0.6071, 0.1333, 0.370…
## $ tb_NB_10_NP                     <dbl> 0.8286, 0.8611, 0.8571, 0.5152, 0.850…
## $ tb_NB_4_P                       <dbl> 0.3143, 0.6250, 0.5357, 0.4839, 0.538…
## $ tb_NB_10_P                      <dbl> 0.8529, 0.7568, 0.9375, 0.6667, 0.680…
## $ TB_AB                           <dbl> 0.6995, 0.3468, 0.6349, 0.4462, 0.534…
## $ TB_REC                          <dbl> 0.4952, 0.3157, 0.2500, 0.3818, 0.479…
## $ TB_PE                           <dbl> -0.0190, 0.0795, -0.0714, 0.3505, 0.1…
## $ nb_T1_2_NP                      <dbl> 0.850, 0.850, 0.650, 0.725, 0.675, 0.…
## $ nb_T1_4_NP                      <dbl> 0.800, 0.850, 0.725, 0.675, 0.575, 0.…
## $ nb_T1_10_NP                     <dbl> 0.925, 0.825, 0.750, 0.850, 0.725, 0.…
## $ nb_T1_4_P                       <dbl> 0.850, 0.900, 0.675, 0.750, 0.875, 0.…
## $ nb_T1_10_P                      <dbl> 0.900, 0.825, 0.750, 0.800, 0.550, 0.…
## $ nb_NB_2_NP                      <dbl> 0.0588, 0.4412, 0.4615, 0.1034, 0.296…
## $ nb_NB_4_NP                      <dbl> 0.0938, 0.4412, 0.2414, 0.1481, 0.478…
## $ nb_NB_10_NP                     <dbl> 0.8649, 0.7576, 0.9667, 0.6765, 0.896…
## $ nb_NB_4_P                       <dbl> 0.4118, 0.7222, 0.4815, 0.3667, 0.685…
## $ nb_NB_10_P                      <dbl> 0.8333, 0.8485, 0.8333, 0.7188, 0.818…
## $ NB_AB                           <dbl> 0.8060, 0.3164, 0.5051, 0.5730, 0.600…
## $ NB_REC                          <dbl> 0.7711, 0.3164, 0.7253, 0.5283, 0.418…
## $ NB_PE                           <dbl> 0.3180, 0.2810, 0.2401, 0.2185, 0.207…
## $ vd_T1_2_NP                      <dbl> 0.925, 0.875, 0.800, 0.850, 0.575, 0.…
## $ vd_T1_4_NP                      <dbl> 0.850, 0.825, 0.825, 0.925, 0.700, 0.…
## $ vd_T1_10_NP                     <dbl> 0.850, 0.900, 0.825, 0.925, 0.750, 0.…
## $ vd_T1_4_P                       <dbl> 0.925, 0.775, 0.825, 0.750, 0.650, 0.…
## $ vd_T1_10_P                      <dbl> 0.925, 0.800, 0.725, 0.950, 0.575, 0.…
## $ vd_NB_2_NP                      <dbl> 0.0541, 0.2857, 0.3125, 0.1765, 0.173…
## $ vd_NB_4_NP                      <dbl> 0.2941, 0.4848, 0.4545, 0.2432, 0.428…
## $ vd_NB_10_NP                     <dbl> 1.0000, 0.6667, 0.9394, 0.7838, 0.766…
## $ vd_NB_4_P                       <dbl> 0.5135, 0.6774, 0.4848, 0.5000, 0.500…
## $ vd_NB_10_P                      <dbl> 0.8919, 0.8125, 0.9310, 0.8421, 0.608…
## $ VD_AB                           <dbl> 0.9459, 0.3810, 0.6269, 0.6073, 0.592…
## $ VD_REC                          <dbl> 0.7059, 0.1818, 0.4848, 0.5405, 0.338…
## $ VD_PE                           <dbl> 0.2194, 0.1926, 0.0303, 0.2568, 0.071…
## $ td_T1_2_NP                      <dbl> 0.950, 0.775, 0.625, 0.775, 0.525, 0.…
## $ td_T1_4_NP                      <dbl> 0.975, 0.800, 0.800, 0.750, 0.625, 0.…
## $ td_T1_10_NP                     <dbl> 0.975, 0.900, 0.800, 0.850, 0.575, 0.…
## $ td_T1_4_P                       <dbl> 0.875, 0.800, 0.800, 0.800, 0.600, 0.…
## $ td_T1_10_P                      <dbl> 0.875, 0.800, 0.850, 0.700, 0.525, 0.…
## $ td_NB_2_NP                      <dbl> 0.1579, 0.3226, 0.5200, 0.1290, 0.142…
## $ td_NB_4_NP                      <dbl> 0.4615, 0.4375, 0.3750, 0.2333, 0.320…
## $ td_NB_10_NP                     <dbl> 0.9487, 0.6944, 0.9375, 0.6471, 0.826…
## $ td_NB_4_P                       <dbl> 0.4571, 0.3750, 0.5625, 0.4063, 0.583…
## $ td_NB_10_P                      <dbl> 0.8857, 0.6875, 0.8529, 0.7143, 0.666…
## $ TD_AB                           <dbl> 0.7908, 0.3719, 0.4175, 0.5180, 0.683…
## $ TD_REC                          <dbl> 0.4872, 0.2569, 0.5625, 0.4137, 0.506…
## $ TD_PE                           <dbl> -0.0044, -0.0625, 0.1875, 0.1729, 0.2…
## $ nd_T1_2_NP                      <dbl> 0.700, 0.800, 0.650, 0.775, 0.425, 0.…
## $ nd_T1_4_NP                      <dbl> 0.850, 0.850, 0.725, 0.850, 0.650, 0.…
## $ nd_T1_10_NP                     <dbl> 0.800, 0.825, 0.800, 0.850, 0.600, 0.…
## $ nd_T1_4_P                       <dbl> 0.850, 0.800, 0.775, 0.775, 0.725, 0.…
## $ nd_T1_10_P                      <dbl> 0.850, 0.750, 0.800, 0.850, 0.675, 0.…
## $ nd_NB_2_NP                      <dbl> 0.0000, 0.2188, 0.2692, 0.0968, 0.235…
## $ nd_NB_4_NP                      <dbl> 0.3824, 0.5000, 0.5172, 0.2353, 0.384…
## $ nd_NB_10_NP                     <dbl> 0.8750, 0.5758, 0.8125, 0.7941, 0.708…
## $ nd_NB_4_P                       <dbl> 0.4118, 0.5000, 0.5806, 0.5484, 0.482…
## $ nd_NB_10_P                      <dbl> 0.9118, 0.7667, 0.8438, 0.8235, 0.629…
## $ ND_AB                           <dbl> 0.8750, 0.3570, 0.5433, 0.6973, 0.473…
## $ ND_REC                          <dbl> 0.4926, 0.0758, 0.2953, 0.5588, 0.323…
## $ ND_PE                           <dbl> 0.0294, 0.0000, 0.0634, 0.3131, 0.098…
## $ AnoMinBl_Lag2_NP                <dbl> -0.01, 0.17, -0.14, -0.29, -0.03, 0.0…
## $ AnoMinBl_Lag10_NP               <dbl> -0.01, 0.05, -0.11, -0.10, 0.12, -0.0…
## $ CathoMinBl_Lag2_NP              <dbl> 0.10, 0.04, 0.21, -0.05, -0.03, 0.09,…
## $ CathoMinBl_Lag10_NP             <dbl> -0.05, 0.03, 0.00, -0.14, 0.06, 0.00,…
## $ Tijdens_AnoMinBl_Lag2_NP        <dbl> -0.01, 0.17, -0.14, -0.29, -0.03, 0.0…
## $ Tijdens_AnoMinBl_Lag10_NP       <dbl> -0.01, 0.05, -0.11, -0.10, 0.12, -0.0…
## $ Tijdens_CathoMinBl_Lag2_NP      <dbl> 0.10, 0.04, 0.21, -0.05, -0.03, 0.09,…
## $ Tijdens_CathoMinBl_Lag10_NP     <dbl> -0.05, 0.03, 0.00, -0.14, 0.06, 0.00,…
## $ Tijdens_AnoMinBL_AB             <dbl> 0.00, -0.12, 0.03, 0.19, 0.15, -0.08,…
## $ Tijdens_CathoMinBL_AB           <dbl> -0.16, -0.01, -0.21, -0.09, 0.09, -0.…
## $ Na_AnoMinBL_AB                  <dbl> 0.10, -0.15, -0.10, 0.32, 0.22, -0.04…
## $ Na_CathoMinBL_AB                <dbl> -0.07, -0.02, -0.08, 0.09, -0.12, -0.…
## $ Tijdens_AnoMinBL_PE             <dbl> 0.00, 0.10, -0.13, 0.33, -0.06, -0.06…
## $ Tijdens_CathoMinBL_PE           <dbl> -0.22, -0.26, 0.16, -0.08, 0.19, -0.0…
## $ Na_CathoMinBL_PE                <dbl> -0.19, -0.19, 0.03, 0.06, 0.03, 0.31,…
## $ Na_AnoMinBL_PE                  <dbl> 0.34, 0.30, 0.18, 0.20, -0.02, 0.06, …
## $ Tijdens_AnoMinBL_REC            <dbl> -0.03, 0.05, -0.17, 0.07, 0.05, 0.07,…
## $ Tijdens_CathoMinBL_REC          <dbl> -0.22, 0.08, 0.08, -0.13, 0.17, -0.03…
## $ Na_CathoMinBL_REC               <dbl> -0.21, -0.11, -0.19, 0.02, -0.01, 0.1…
## $ Na_AnoMinBL_REC                 <dbl> 0.25, 0.05, 0.30, 0.22, -0.01, 0.13, …
## $ T1_Lag2_Tijdens_Ano_Min_BL_NP   <dbl> -0.15, 0.00, -0.15, 0.10, -0.18, 0.00…
## $ T1_Lag2_Tijdens_Catho_Min_BL_NP <dbl> 0.02, -0.10, -0.18, -0.08, -0.05, -0.…
## $ T1_Lag2_Na_Ano_Min_BL_NP        <dbl> -0.08, -0.03, -0.18, 0.10, 0.03, -0.1…
## $ T1_Lag2_Na_Catho_Min_BL_NP      <dbl> -0.23, -0.08, -0.15, -0.08, -0.15, -0…
## $ T1_Lag4_Tijdens_Ano_Min_BL_NP   <dbl> 0.02, 0.00, -0.13, -0.08, 0.00, 0.05,…
## $ T1_Lag4_Tijdens_Catho_Min_BL_NP <dbl> 0.13, -0.02, -0.02, -0.18, -0.08, 0.0…
## $ T1_Lag4_Na_Catho_Min_BL_NP      <dbl> 0.00, 0.03, -0.10, -0.08, -0.05, 0.13…
## $ T1_Lag4_Na_Ano_Min_BL_NP        <dbl> 0.00, 0.03, -0.10, -0.15, -0.10, 0.02…
## $ Mean_BL_PE                      <dbl> 0.10, 0.09, 0.05, 0.14, 0.15, -0.13, …
## $ ZVB_AB                          <dbl> 0.72613, -0.71847, 0.12559, -2.04185,…
## $ ZTB_AB                          <dbl> 0.97738, -1.74477, 0.47867, -0.97793,…
## $ ZNB_AB                          <dbl> 1.24043, -1.72891, -0.58440, -0.17267…
## $ ZVD_AB                          <dbl> 2.47191, -1.64491, 0.14714, 0.00446, …
## $ ZTD_AB                          <dbl> 1.39518, -1.23661, -0.94993, -0.31845…
## $ ZND_AB                          <dbl> 2.00765, -1.59142, -0.29725, 0.77327,…
## $ VB_T1_Acc_                      <dbl> 0.87, 0.89, 0.81, 0.77, 0.68, 0.95, 0…
## $ VD_T1_Acc_                      <dbl> 0.90, 0.84, 0.80, 0.88, 0.65, 0.90, 0…
</pre>
<p>We’ll use only a subset of columns, with the header structure <code>block/stim</code>_<code>target</code>_<code>lag</code>_<code>prime</code>, where:</p>
<ul>
<li><strong>block/stim</strong> is either:
<ol style="list-style-type: decimal">
<li><code>vb</code>: “anodal” tDCS, “pre” block (before tDCS)</li>
<li><code>tb</code>: “anodal” tDCS, “tDCS” block (during tDCS)</li>
<li><code>nb</code>: “anodal” tDCS, “post” block (after tDCS)</li>
<li><code>vd</code>: “cathodal” tDCS, “pre” block (before tDCS)</li>
<li><code>td</code>: “cathodal” tDCS, “tDCS” block (during tDCS)</li>
<li><code>nd</code>: “cathodal” tDCS, “post” block (after tDCS)</li>
</ol></li>
<li><strong>target</strong> is either:
<ol style="list-style-type: decimal">
<li><code>T1</code> (T1 accuracy): proportion of trials in which T1 was identified correctly</li>
<li><code>NB</code> (T2|T1 accuracy): proportion of trials in which T2 was identified correctly, given T1 was identified correctly</li>
</ol></li>
<li><strong>lag</strong> is either:
<ol style="list-style-type: decimal">
<li><code>2</code> (lag 2), when T2 followed T1 after 1 distractor</li>
<li><code>4</code> (lag 4), when T2 followed T1 after 3 distractors</li>
<li><code>10</code>, (lag 10), when T2 followed T1 after 9 distractors</li>
</ol></li>
<li><strong>prime</strong> is either:
<ol style="list-style-type: decimal">
<li><code>P</code> (prime): when the stimulus at lag 2 (in lag 4 or lag 10 trials) had the same identity as T2</li>
<li><code>NP</code> (no prime) when this was not the case. Study 2 had no primes, so we’ll only keep these.</li>
</ol></li>
</ul>
<p>We’ll also keep two more columns: <code>fileno</code> (participant ID) and <code>First_Session</code> (<code>1</code> meaning participants received anodal tDCS in the first session, <code>2</code> meaning participants received cathodal tDCS in the first session).</p>
<div id="reformat" class="section level3">
<h3>Reformat</h3>
<p>Now we’ll reformat the data to match the data frame for study 2:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1">format_study2 &lt;-<span class="st"> </span><span class="cf">function</span>(df) {</a>
<a class="sourceLine" id="cb24-2" data-line-number="2">  df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-3" data-line-number="3"><span class="st">    </span><span class="kw">select</span>(fileno, First_Session, <span class="kw">ends_with</span>(<span class="st">&quot;_NP&quot;</span>), <span class="op">-</span><span class="kw">contains</span>(<span class="st">&quot;Min&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># keep only relevant columns</span></a>
<a class="sourceLine" id="cb24-4" data-line-number="4"><span class="st">    </span><span class="kw">gather</span>(key, accuracy, <span class="op">-</span>fileno, <span class="op">-</span>First_Session) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># make long form</span></a>
<a class="sourceLine" id="cb24-5" data-line-number="5"><span class="st">    </span><span class="co"># split key column to create separate columns for each factor</span></a>
<a class="sourceLine" id="cb24-6" data-line-number="6"><span class="st">    </span><span class="kw">separate</span>(key, <span class="kw">c</span>(<span class="st">&quot;block&quot;</span>, <span class="st">&quot;stimulation&quot;</span>, <span class="st">&quot;target&quot;</span>, <span class="st">&quot;lag&quot;</span>), <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># split after 1st, 3rd, and 5th character</span></a>
<a class="sourceLine" id="cb24-7" data-line-number="7"><span class="st">    </span><span class="co"># convert to factors, relabel levels to match those in study 2</span></a>
<a class="sourceLine" id="cb24-8" data-line-number="8"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">block =</span> <span class="kw">factor</span>(block, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;v&quot;</span>, <span class="st">&quot;t&quot;</span>, <span class="st">&quot;n&quot;</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;pre&quot;</span>, <span class="st">&quot;tDCS&quot;</span>, <span class="st">&quot;post&quot;</span>)),</a>
<a class="sourceLine" id="cb24-9" data-line-number="9">           <span class="dt">stimulation =</span> <span class="kw">factor</span>(stimulation, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;b_&quot;</span>, <span class="st">&quot;d_&quot;</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;anodal&quot;</span>, <span class="st">&quot;cathodal&quot;</span>)),</a>
<a class="sourceLine" id="cb24-10" data-line-number="10">           <span class="dt">lag =</span> <span class="kw">factor</span>(lag, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;_2_NP&quot;</span>, <span class="st">&quot;_4_NP&quot;</span>, <span class="st">&quot;_10_NP&quot;</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">10</span>)),</a>
<a class="sourceLine" id="cb24-11" data-line-number="11">           <span class="dt">First_Session =</span> <span class="kw">factor</span>(First_Session, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;anodal first&quot;</span>,<span class="st">&quot;cathodal first&quot;</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-12" data-line-number="12"><span class="st">    </span><span class="kw">spread</span>(target, accuracy) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># create separate columns for T2.given.T1 and T1 performance</span></a>
<a class="sourceLine" id="cb24-13" data-line-number="13"><span class="st">    </span><span class="kw">rename</span>(<span class="dt">T2.given.T1 =</span> NB, <span class="dt">session.order =</span> First_Session, <span class="dt">subject =</span> fileno)<span class="co"># rename columns to match those in study 2</span></a>
<a class="sourceLine" id="cb24-14" data-line-number="14">}</a></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">df_study1 &lt;-<span class="st"> </span><span class="kw">format_study2</span>(data_study1_fromDisk)</a>
<a class="sourceLine" id="cb25-2" data-line-number="2">n_study1 &lt;-<span class="st"> </span><span class="kw">n_distinct</span>(df_study1<span class="op">$</span>subject) <span class="co"># number of subjects in study 1</span></a></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="kw">kable</span>(<span class="kw">head</span>(df_study1,<span class="dv">19</span>), <span class="dt">digits =</span> <span class="dv">1</span>, <span class="dt">caption =</span> <span class="st">&quot;Data frame for study 1&quot;</span>)</a></code></pre></div>
<table>
<caption>Data frame for study 1</caption>
<thead>
<tr class="header">
<th align="left">subject</th>
<th align="left">session.order</th>
<th align="left">block</th>
<th align="left">stimulation</th>
<th align="left">lag</th>
<th align="right">T2.given.T1</th>
<th align="right">T1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">pre</td>
<td align="left">anodal</td>
<td align="left">2</td>
<td align="right">0.3</td>
<td align="right">0.6</td>
</tr>
<tr class="even">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">pre</td>
<td align="left">anodal</td>
<td align="left">4</td>
<td align="right">0.3</td>
<td align="right">0.7</td>
</tr>
<tr class="odd">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">pre</td>
<td align="left">anodal</td>
<td align="left">10</td>
<td align="right">0.7</td>
<td align="right">0.8</td>
</tr>
<tr class="even">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">pre</td>
<td align="left">cathodal</td>
<td align="left">2</td>
<td align="right">0.2</td>
<td align="right">0.6</td>
</tr>
<tr class="odd">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">pre</td>
<td align="left">cathodal</td>
<td align="left">4</td>
<td align="right">0.4</td>
<td align="right">0.7</td>
</tr>
<tr class="even">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">pre</td>
<td align="left">cathodal</td>
<td align="left">10</td>
<td align="right">0.8</td>
<td align="right">0.8</td>
</tr>
<tr class="odd">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">tDCS</td>
<td align="left">anodal</td>
<td align="left">2</td>
<td align="right">0.3</td>
<td align="right">0.5</td>
</tr>
<tr class="even">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">tDCS</td>
<td align="left">anodal</td>
<td align="left">4</td>
<td align="right">0.4</td>
<td align="right">0.7</td>
</tr>
<tr class="odd">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">tDCS</td>
<td align="left">anodal</td>
<td align="left">10</td>
<td align="right">0.8</td>
<td align="right">0.5</td>
</tr>
<tr class="even">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">tDCS</td>
<td align="left">cathodal</td>
<td align="left">2</td>
<td align="right">0.1</td>
<td align="right">0.5</td>
</tr>
<tr class="odd">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">tDCS</td>
<td align="left">cathodal</td>
<td align="left">4</td>
<td align="right">0.3</td>
<td align="right">0.6</td>
</tr>
<tr class="even">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">tDCS</td>
<td align="left">cathodal</td>
<td align="left">10</td>
<td align="right">0.8</td>
<td align="right">0.6</td>
</tr>
<tr class="odd">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">post</td>
<td align="left">anodal</td>
<td align="left">2</td>
<td align="right">0.3</td>
<td align="right">0.7</td>
</tr>
<tr class="even">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">post</td>
<td align="left">anodal</td>
<td align="left">4</td>
<td align="right">0.5</td>
<td align="right">0.6</td>
</tr>
<tr class="odd">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">post</td>
<td align="left">anodal</td>
<td align="left">10</td>
<td align="right">0.9</td>
<td align="right">0.7</td>
</tr>
<tr class="even">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">post</td>
<td align="left">cathodal</td>
<td align="left">2</td>
<td align="right">0.2</td>
<td align="right">0.4</td>
</tr>
<tr class="odd">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">post</td>
<td align="left">cathodal</td>
<td align="left">4</td>
<td align="right">0.4</td>
<td align="right">0.6</td>
</tr>
<tr class="even">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">post</td>
<td align="left">cathodal</td>
<td align="left">10</td>
<td align="right">0.7</td>
<td align="right">0.6</td>
</tr>
<tr class="odd">
<td align="left">pp11</td>
<td align="left">anodal first</td>
<td align="left">pre</td>
<td align="left">anodal</td>
<td align="left">2</td>
<td align="right">0.5</td>
<td align="right">1.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="change-from-baseline" class="section level1">
<h1>Change from baseline</h1>
<div id="calculate-change-scores" class="section level2">
<h2>Calculate change scores</h2>
<p>First we calculate attentional blink magnitude: the difference between short-lag and long-lag T2|T1 performance.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">calc_ABmag &lt;-<span class="st"> </span><span class="cf">function</span>(df) {</a>
<a class="sourceLine" id="cb27-2" data-line-number="2">  df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-3" data-line-number="3"><span class="st">    </span><span class="kw">group_by</span>(subject, session.order, stimulation, block) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># for each unique factor combination</span></a>
<a class="sourceLine" id="cb27-4" data-line-number="4"><span class="st">    </span><span class="kw">summarise</span>(<span class="dt">AB.magnitude =</span> <span class="kw">last</span>(T2.given.T1) <span class="op">-</span><span class="st"> </span><span class="kw">first</span>(T2.given.T1), <span class="co"># subtract lags to replace data with AB magnitude,</span></a>
<a class="sourceLine" id="cb27-5" data-line-number="5">              <span class="dt">T1.short =</span> <span class="kw">first</span>(T1)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># also keep T1 performance for short lag, to use as a covariate later</span></a>
<a class="sourceLine" id="cb27-6" data-line-number="6"><span class="st">    </span><span class="kw">ungroup</span>()</a>
<a class="sourceLine" id="cb27-7" data-line-number="7">}</a></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1">ABmag_study1 &lt;-<span class="st"> </span><span class="kw">calc_ABmag</span>(df_study1)</a>
<a class="sourceLine" id="cb28-2" data-line-number="2">ABmag_study2 &lt;-<span class="st"> </span><span class="kw">calc_ABmag</span>(df_study2)</a>
<a class="sourceLine" id="cb28-3" data-line-number="3"><span class="kw">kable</span>(<span class="kw">head</span>(ABmag_study2,<span class="dv">7</span>), <span class="dt">digits =</span> <span class="dv">2</span>, <span class="dt">caption =</span> <span class="st">&quot;AB magnitude data frame in study 2&quot;</span>)</a></code></pre></div>
<table>
<caption>AB magnitude data frame in study 2</caption>
<thead>
<tr class="header">
<th align="left">subject</th>
<th align="left">session.order</th>
<th align="left">stimulation</th>
<th align="left">block</th>
<th align="right">AB.magnitude</th>
<th align="right">T1.short</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">anodal</td>
<td align="left">pre</td>
<td align="right">0.44</td>
<td align="right">0.76</td>
</tr>
<tr class="even">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">anodal</td>
<td align="left">tDCS</td>
<td align="right">0.44</td>
<td align="right">0.82</td>
</tr>
<tr class="odd">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">anodal</td>
<td align="left">post</td>
<td align="right">0.42</td>
<td align="right">0.76</td>
</tr>
<tr class="even">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">cathodal</td>
<td align="left">pre</td>
<td align="right">0.38</td>
<td align="right">0.75</td>
</tr>
<tr class="odd">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">cathodal</td>
<td align="left">tDCS</td>
<td align="right">0.49</td>
<td align="right">0.66</td>
</tr>
<tr class="even">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">cathodal</td>
<td align="left">post</td>
<td align="right">0.43</td>
<td align="right">0.60</td>
</tr>
<tr class="odd">
<td align="left">S02</td>
<td align="left">cathodal first</td>
<td align="left">anodal</td>
<td align="left">pre</td>
<td align="right">0.19</td>
<td align="right">0.95</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>AB.magnitude</strong>: the difference in T2|T1 performance at the longest lag (study 1: lag 10, study 2: lag 8) vs. the shortest lag (study 1: lag 2, study 2: lag 3)</li>
<li><strong>T1.short</strong>: % T1 correct at the short lag, for use as a covariate in the partial correlation analysis</li>
</ul>
<p>Next, we calculate change from baseline for both of these measures:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1">calc_change_scores &lt;-<span class="st"> </span><span class="cf">function</span>(df) {</a>
<a class="sourceLine" id="cb29-2" data-line-number="2">  df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb29-3" data-line-number="3"><span class="st">    </span><span class="kw">gather</span>(measure, performance, AB.magnitude, T1.short) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb29-4" data-line-number="4"><span class="st">    </span><span class="kw">group_by</span>(subject, session.order, stimulation, measure) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb29-5" data-line-number="5"><span class="st">    </span><span class="kw">summarise</span>(<span class="dt">baseline =</span> <span class="kw">first</span>(performance), </a>
<a class="sourceLine" id="cb29-6" data-line-number="6">              <span class="dt">during =</span> <span class="kw">nth</span>(performance,<span class="dv">2</span>) <span class="op">-</span><span class="st"> </span>baseline,</a>
<a class="sourceLine" id="cb29-7" data-line-number="7">              <span class="dt">after =</span> <span class="kw">last</span>(performance) <span class="op">-</span><span class="st"> </span>baseline) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb29-8" data-line-number="8"><span class="st">    </span><span class="kw">gather</span>(change, change.score, during, after) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb29-9" data-line-number="9"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">change =</span> <span class="kw">fct_recode</span>(change, <span class="st">&quot;tDCS - baseline&quot;</span> =<span class="st"> &quot;during&quot;</span>, <span class="st">&quot;post - baseline&quot;</span> =<span class="st"> &quot;after&quot;</span>),</a>
<a class="sourceLine" id="cb29-10" data-line-number="10">           <span class="dt">change =</span> <span class="kw">fct_relevel</span>(change, <span class="st">&quot;tDCS - baseline&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb29-11" data-line-number="11"><span class="st">    </span><span class="kw">arrange</span>(subject, stimulation)</a>
<a class="sourceLine" id="cb29-12" data-line-number="12">}</a></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1">ABmagChange_study1 &lt;-<span class="st"> </span><span class="kw">calc_change_scores</span>(ABmag_study1)</a>
<a class="sourceLine" id="cb30-2" data-line-number="2">ABmagChange_study2 &lt;-<span class="st"> </span><span class="kw">calc_change_scores</span>(ABmag_study2)</a>
<a class="sourceLine" id="cb30-3" data-line-number="3"><span class="kw">kable</span>(<span class="kw">head</span>(ABmagChange_study2,<span class="dv">9</span>), <span class="dt">digits =</span> <span class="dv">2</span>, <span class="dt">caption =</span> <span class="st">&quot;Change scores data frame in study 2&quot;</span>)</a></code></pre></div>
<table>
<caption>Change scores data frame in study 2</caption>
<thead>
<tr class="header">
<th align="left">subject</th>
<th align="left">session.order</th>
<th align="left">stimulation</th>
<th align="left">measure</th>
<th align="right">baseline</th>
<th align="left">change</th>
<th align="right">change.score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">anodal</td>
<td align="left">AB.magnitude</td>
<td align="right">0.44</td>
<td align="left">tDCS - baseline</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">anodal</td>
<td align="left">T1.short</td>
<td align="right">0.76</td>
<td align="left">tDCS - baseline</td>
<td align="right">0.05</td>
</tr>
<tr class="odd">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">anodal</td>
<td align="left">AB.magnitude</td>
<td align="right">0.44</td>
<td align="left">post - baseline</td>
<td align="right">-0.02</td>
</tr>
<tr class="even">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">anodal</td>
<td align="left">T1.short</td>
<td align="right">0.76</td>
<td align="left">post - baseline</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">cathodal</td>
<td align="left">AB.magnitude</td>
<td align="right">0.38</td>
<td align="left">tDCS - baseline</td>
<td align="right">0.10</td>
</tr>
<tr class="even">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">cathodal</td>
<td align="left">T1.short</td>
<td align="right">0.75</td>
<td align="left">tDCS - baseline</td>
<td align="right">-0.09</td>
</tr>
<tr class="odd">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">cathodal</td>
<td align="left">AB.magnitude</td>
<td align="right">0.38</td>
<td align="left">post - baseline</td>
<td align="right">0.05</td>
</tr>
<tr class="even">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">cathodal</td>
<td align="left">T1.short</td>
<td align="right">0.75</td>
<td align="left">post - baseline</td>
<td align="right">-0.15</td>
</tr>
<tr class="odd">
<td align="left">S02</td>
<td align="left">cathodal first</td>
<td align="left">anodal</td>
<td align="left">AB.magnitude</td>
<td align="right">0.19</td>
<td align="left">tDCS - baseline</td>
<td align="right">-0.02</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>baseline</strong> is the score in the “pre” block for this <em>measure</em> (<code>AB.magnitude</code> or <code>T1.short</code>)</li>
<li><strong>change</strong> indicates whether the change score is comparing the “pre” block with the “tDCS” block (<code>tDCS-baseline</code>) or with the “post” block (<code>post - baseline</code>)</li>
<li><strong>change.score</strong> is the difference in the scores between the blocks (as indicated in the <em>change</em> column)</li>
</ul>
</div>
<div id="plots" class="section level2 tabset tabset-fade tabset-pills">
<h2>Plots</h2>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1">plot_change_from_baseline &lt;-<span class="st"> </span><span class="cf">function</span>(df)</a>
<a class="sourceLine" id="cb31-2" data-line-number="2">  <span class="kw">ggplot</span>(<span class="kw">filter</span>(df, measure <span class="op">==</span><span class="st"> &quot;AB.magnitude&quot;</span>), <span class="kw">aes</span>(baseline, change.score)) <span class="op">+</span></a>
<a class="sourceLine" id="cb31-3" data-line-number="3"><span class="st">  </span><span class="kw">facet_grid</span>(change <span class="op">~</span><span class="st"> </span>stimulation) <span class="op">+</span></a>
<a class="sourceLine" id="cb31-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb31-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb31-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb31-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_rug</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb31-8" data-line-number="8"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;Baseline AB magnitude (%)&quot;</span>, <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,.<span class="dv">2</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">labels =</span> scales<span class="op">::</span><span class="kw">percent_format</span>(<span class="dt">accuracy =</span> <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb31-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;Change in AB magnitude (%)&quot;</span>, <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span>.<span class="dv">4</span>,.<span class="dv">4</span>,.<span class="dv">1</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span>.<span class="dv">4</span>,.<span class="dv">4</span>), <span class="dt">labels =</span> scales<span class="op">::</span><span class="kw">percent_format</span>(<span class="dt">accuracy =</span> <span class="dv">1</span>))</a></code></pre></div>
<div id="study-1-1" class="section level3">
<h3>Study 1</h3>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="kw">plot_change_from_baseline</span>(ABmagChange_study1)</a></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<div class="figure">
<img src="AB-tDCS_change-from-baseline_files/figure-html/change%20from%20baseline%20plot%20study%201-1.png" alt="Study 1: change from baseline as a function of baseline performance" width="576" />
<p class="caption">
Study 1: change from baseline as a function of baseline performance
</p>
</div>
</div>
<div id="study-2-1" class="section level3">
<h3>Study 2</h3>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1"><span class="kw">plot_change_from_baseline</span>(ABmagChange_study2)</a></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<div class="figure">
<img src="AB-tDCS_change-from-baseline_files/figure-html/change%20from%20baseline%20plot%20study%202-1.png" alt="Study 2: change from baseline as a function of baseline performance" width="576" />
<p class="caption">
Study 2: change from baseline as a function of baseline performance
</p>
</div>
</div>
</div>
<div id="statistics" class="section level2">
<h2>Statistics</h2>
<div id="partial-correlations" class="section level3 tabset tabset-fade tabset-pills">
<h3>Partial correlations</h3>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1">pcorr_change_baseline &lt;-<span class="st"> </span><span class="cf">function</span>(df) {</a>
<a class="sourceLine" id="cb36-2" data-line-number="2">  df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb36-3" data-line-number="3"><span class="st">    </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb36-4" data-line-number="4"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">session.order =</span> <span class="kw">as.numeric</span>(session.order)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># dummy code</span></a>
<a class="sourceLine" id="cb36-5" data-line-number="5"><span class="st">    </span><span class="kw">nest_legacy</span>(baseline, change.score, <span class="dt">.key =</span> <span class="st">&#39;value_col&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># combine the two performance columns into a list</span></a>
<a class="sourceLine" id="cb36-6" data-line-number="6"><span class="st">    </span><span class="co"># make 2 separate list-columns: AB.magnitude and T1. short</span></a>
<a class="sourceLine" id="cb36-7" data-line-number="7"><span class="st">    </span><span class="kw">spread</span>(<span class="dt">key =</span> measure, <span class="dt">value =</span> value_col) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># each contains two vectors: baseline performance and change score</span></a>
<a class="sourceLine" id="cb36-8" data-line-number="8"><span class="st">    </span><span class="kw">unnest_legacy</span>(AB.magnitude, T1.short, <span class="dt">.sep =</span> <span class="st">&#39;_&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># make all 2x2 combinations into 4 columns</span></a>
<a class="sourceLine" id="cb36-9" data-line-number="9"><span class="st">    </span><span class="kw">select</span>(<span class="op">-</span>T1.short_baseline) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># drop the baseline value for T1.short: not used in partial correlation</span></a>
<a class="sourceLine" id="cb36-10" data-line-number="10"><span class="st">    </span><span class="kw">group_by</span>(stimulation,change) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># for anodal/cathodal during/after</span></a>
<a class="sourceLine" id="cb36-11" data-line-number="11"><span class="st">    </span><span class="co"># make a data frame out of all 4 columns we need for the partial correlation</span></a>
<a class="sourceLine" id="cb36-12" data-line-number="12"><span class="st">    </span><span class="kw">nest_legacy</span>(session.order, AB.magnitude_baseline, AB.magnitude_change.score, T1.short_change.score) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb36-13" data-line-number="13"><span class="st">    </span><span class="co"># partial correlation between baseline and T2|T1 change score, given session order and T1 change score</span></a>
<a class="sourceLine" id="cb36-14" data-line-number="14"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">r =</span> <span class="kw">map_dbl</span>(data, <span class="op">~</span><span class="kw">pcor</span>(<span class="kw">c</span>(<span class="st">&quot;AB.magnitude_baseline&quot;</span>,<span class="st">&quot;AB.magnitude_change.score&quot;</span>,</a>
<a class="sourceLine" id="cb36-15" data-line-number="15">                                     <span class="st">&quot;session.order&quot;</span>, <span class="st">&quot;T1.short_change.score&quot;</span>), <span class="kw">var</span>(.)))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb36-16" data-line-number="16"><span class="st">    </span><span class="kw">group_by</span>(stimulation,change) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb36-17" data-line-number="17"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">stats =</span> <span class="kw">list</span>(<span class="kw">as.data.frame</span>(<span class="kw">pcor.test</span>(r, <span class="dv">2</span>, <span class="kw">n_distinct</span>(df<span class="op">$</span>subject))))) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># significance of partial correlations</span></a>
<a class="sourceLine" id="cb36-18" data-line-number="18"><span class="st">    </span><span class="kw">unnest_legacy</span>(stats, <span class="dt">.drop =</span> <span class="ot">TRUE</span>) <span class="co"># combine all into one data frame</span></a>
<a class="sourceLine" id="cb36-19" data-line-number="19">}</a></code></pre></div>
<p>Partial correlation between:</p>
<ul>
<li>baseline AB magnitude</li>
<li>AB magnitude change from baseline (tDCS - baseline; post - baseline)</li>
</ul>
<p>Given (adjusing for):</p>
<ul>
<li>session order</li>
<li>change from baseline in T1 accuracy at lag 2</li>
</ul>
<div id="study-1-2" class="section level4">
<h4>Study 1</h4>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="kw">kable</span>(<span class="kw">pcorr_change_baseline</span>(ABmagChange_study1),</a>
<a class="sourceLine" id="cb37-2" data-line-number="2">      <span class="dt">digits =</span> <span class="dv">3</span>, <span class="dt">caption =</span> <span class="st">&quot;Study 1: partial correlation change from baseline&quot;</span>)</a></code></pre></div>
<table>
<caption>Study 1: partial correlation change from baseline</caption>
<thead>
<tr class="header">
<th align="left">stimulation</th>
<th align="left">change</th>
<th align="right">r</th>
<th align="right">tval</th>
<th align="right">df</th>
<th align="right">pvalue</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">anodal</td>
<td align="left">tDCS - baseline</td>
<td align="right">-0.676</td>
<td align="right">-5.031</td>
<td align="right">30</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">anodal</td>
<td align="left">post - baseline</td>
<td align="right">-0.427</td>
<td align="right">-2.588</td>
<td align="right">30</td>
<td align="right">0.015</td>
</tr>
<tr class="odd">
<td align="left">cathodal</td>
<td align="left">tDCS - baseline</td>
<td align="right">-0.230</td>
<td align="right">-1.295</td>
<td align="right">30</td>
<td align="right">0.205</td>
</tr>
<tr class="even">
<td align="left">cathodal</td>
<td align="left">post - baseline</td>
<td align="right">-0.381</td>
<td align="right">-2.258</td>
<td align="right">30</td>
<td align="right">0.031</td>
</tr>
</tbody>
</table>
<p>In study 1, all correlations except for <code>cathodal, tDCS - baseline</code> are significant (without correcting for multiple comparisons). The correlation for <code>anodal, tDCS - baseline</code> is the strongest.</p>
</div>
<div id="study-2-2" class="section level4">
<h4>Study 2</h4>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="kw">kable</span>(<span class="kw">pcorr_change_baseline</span>(ABmagChange_study2),</a>
<a class="sourceLine" id="cb38-2" data-line-number="2">      <span class="dt">digits =</span> <span class="dv">3</span>, <span class="dt">caption =</span> <span class="st">&quot;Study 2: partial correlation change from baseline&quot;</span>)</a></code></pre></div>
<table>
<caption>Study 2: partial correlation change from baseline</caption>
<thead>
<tr class="header">
<th align="left">stimulation</th>
<th align="left">change</th>
<th align="right">r</th>
<th align="right">tval</th>
<th align="right">df</th>
<th align="right">pvalue</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">anodal</td>
<td align="left">tDCS - baseline</td>
<td align="right">-0.149</td>
<td align="right">-0.906</td>
<td align="right">36</td>
<td align="right">0.371</td>
</tr>
<tr class="even">
<td align="left">anodal</td>
<td align="left">post - baseline</td>
<td align="right">-0.425</td>
<td align="right">-2.818</td>
<td align="right">36</td>
<td align="right">0.008</td>
</tr>
<tr class="odd">
<td align="left">cathodal</td>
<td align="left">tDCS - baseline</td>
<td align="right">-0.303</td>
<td align="right">-1.906</td>
<td align="right">36</td>
<td align="right">0.065</td>
</tr>
<tr class="even">
<td align="left">cathodal</td>
<td align="left">post - baseline</td>
<td align="right">-0.443</td>
<td align="right">-2.969</td>
<td align="right">36</td>
<td align="right">0.005</td>
</tr>
</tbody>
</table>
<p>In study 2, only two correlations are significant: both <code>post - baseline</code>. So the <code>anodal, tDCS - baseline</code> correlation that was the focus of study 1 is not significant here.</p>
</div>
</div>
<div id="variance-tests" class="section level3 tabset tabset-fade tabset-pills">
<h3>Variance tests</h3>
<p>There are two problems with assessing the correlation between <code>baseline</code> and change from baseline (<code>retest - baseline</code>, e.g. <code>tDCS - baseline</code>)<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>.</p>
<ol style="list-style-type: decimal">
<li><strong>Mathematical coupling</strong>. The <code>baseline</code> term shows up in both variables, introducing a spurious covariance. This may result in a correlation (negative, because <code>baseline</code> is subtracted) of up to <em>r</em> = -0.71 (Tu and Gilthorpe, 2007)<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>, even when <code>baseline</code> and <code>retest</code> are randomly sampled from the same distribution.</li>
<li><strong>Regression to the mean</strong>. Purely due to measurement error, extreme scores will tend to be less extreme upon another measurement, which also introduces a spurious relation between the two variables.</li>
</ol>
<p>One solution to regression to the mean is to compare the variances in the baseline and retest. Regression to the mean is a random process, so the variances are expected to be the same. However, if there is truly a relation between <code>baseline</code> and <code>retest - baseline</code>, the variance in the retest should be less than in the baseline: if high-performers become worse, and low-performers become better, so the scores in the retest should be closer together.</p>
<p>Maloney and Rastogi (1970)<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a> (equation in Tu &amp; Gilthorpe (2007)) and Myrtek and Foerster (1986)<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a> (equation in Jin (1992)<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a>) propose t-statistics for such tests (which are identical). Further (somewhat counterintuitively), Tu &amp; Gilthorpe (2007) show that testing the variance between <code>baseline</code> and <code>retest</code> is equivalent to testing the significance of the correlation between <code>baseline - retest</code> and <code>baseline + retest</code> (as in Maloney &amp; Rastogi (1970)). Because the sign is now opposite in both variables, the covariance is no longer biased towards either. This illustrates how variance tests also adress mathematical coupling.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1">var_test &lt;-<span class="st"> </span><span class="cf">function</span>(df) {</a>
<a class="sourceLine" id="cb39-2" data-line-number="2">df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb39-3" data-line-number="3"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb39-4" data-line-number="4"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>T1.short, <span class="op">-</span>session.order) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># drop columns we don&#39;t need</span></a>
<a class="sourceLine" id="cb39-5" data-line-number="5"><span class="st">  </span><span class="kw">spread</span>(block, AB.magnitude) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># create 3 columns of scores, one for each block</span></a>
<a class="sourceLine" id="cb39-6" data-line-number="6"><span class="st">  </span><span class="kw">gather</span>(condition, retest, tDCS, post) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># gather the tdcs and post blocks into one &quot;retest score&quot; column</span></a>
<a class="sourceLine" id="cb39-7" data-line-number="7"><span class="st">  </span><span class="kw">unite</span>(comparison, stimulation, condition) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># create all 2x2 combinations for the correlations</span></a>
<a class="sourceLine" id="cb39-8" data-line-number="8"><span class="st">  </span><span class="kw">group_by</span>(comparison) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># for each of these</span></a>
<a class="sourceLine" id="cb39-9" data-line-number="9"><span class="st">  </span><span class="kw">nest_legacy</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># make a data frame out of the test and retest columns</span></a>
<a class="sourceLine" id="cb39-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">stats =</span> <span class="kw">map</span>(data, <span class="op">~</span><span class="kw">as.data.frame</span>(<span class="kw">corr_change_baseline</span>(.<span class="op">$</span>pre, .<span class="op">$</span>retest)))) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># apply the variance test</span></a>
<a class="sourceLine" id="cb39-11" data-line-number="11"><span class="st">  </span><span class="kw">unnest_legacy</span>(stats, <span class="dt">.drop =</span> <span class="ot">TRUE</span>) <span class="co"># unpack list into data frame, drop the data</span></a>
<a class="sourceLine" id="cb39-12" data-line-number="12">}</a></code></pre></div>
<p>Variance tests between:</p>
<ul>
<li>baseline AB magnitude (<code>pre</code> block)</li>
<li>retest AB magnitude (<code>tDCS</code> or <code>post</code> block)</li>
</ul>
<div id="study-1-3" class="section level4">
<h4>Study 1</h4>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="kw">kable</span>(<span class="kw">var_test</span>(ABmag_study1), <span class="dt">digits =</span> <span class="dv">3</span>, <span class="dt">caption =</span> <span class="st">&quot;Study 1: test of variance in baseline vs. retest&quot;</span>)</a></code></pre></div>
<table>
<caption>Study 1: test of variance in baseline vs. retest</caption>
<thead>
<tr class="header">
<th align="left">comparison</th>
<th align="right">r</th>
<th align="right">df</th>
<th align="right">t</th>
<th align="right">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">anodal_tDCS</td>
<td align="right">0.270</td>
<td align="right">32</td>
<td align="right">1.584</td>
<td align="right">0.123</td>
</tr>
<tr class="even">
<td align="left">cathodal_tDCS</td>
<td align="right">-0.198</td>
<td align="right">32</td>
<td align="right">-1.141</td>
<td align="right">0.262</td>
</tr>
<tr class="odd">
<td align="left">anodal_post</td>
<td align="right">-0.018</td>
<td align="right">32</td>
<td align="right">-0.103</td>
<td align="right">0.919</td>
</tr>
<tr class="even">
<td align="left">cathodal_post</td>
<td align="right">-0.062</td>
<td align="right">32</td>
<td align="right">-0.350</td>
<td align="right">0.729</td>
</tr>
</tbody>
</table>
<p>Even though three out of four conditions showed a significant negative partial correlation, none of the conditions pass the variance test, suggesting no relation between baseline and change due to tDCS.</p>
</div>
<div id="study-2-3" class="section level4">
<h4>Study 2</h4>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1"><span class="kw">kable</span>(<span class="kw">var_test</span>(ABmag_study2), <span class="dt">digits =</span> <span class="dv">3</span>, <span class="dt">caption =</span> <span class="st">&quot;Study 2: test of variance in baseline vs. retest&quot;</span>)</a></code></pre></div>
<table>
<caption>Study 2: test of variance in baseline vs. retest</caption>
<thead>
<tr class="header">
<th align="left">comparison</th>
<th align="right">r</th>
<th align="right">df</th>
<th align="right">t</th>
<th align="right">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">anodal_tDCS</td>
<td align="right">-0.106</td>
<td align="right">38</td>
<td align="right">-0.655</td>
<td align="right">0.516</td>
</tr>
<tr class="even">
<td align="left">cathodal_tDCS</td>
<td align="right">0.108</td>
<td align="right">38</td>
<td align="right">0.671</td>
<td align="right">0.507</td>
</tr>
<tr class="odd">
<td align="left">anodal_post</td>
<td align="right">0.029</td>
<td align="right">38</td>
<td align="right">0.177</td>
<td align="right">0.860</td>
</tr>
<tr class="even">
<td align="left">cathodal_post</td>
<td align="right">0.183</td>
<td align="right">38</td>
<td align="right">1.150</td>
<td align="right">0.257</td>
</tr>
</tbody>
</table>
<p>In study 2 also all variance tests are not significant, again suggesting the two significant partial correlations are spurious.</p>
</div>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>London, R. E., &amp; Slagter, H. A. (2021). No Effect of Transcranial Direct Current Stimulation over Left Dorsolateral Prefrontal Cortex on Temporal Attention. <em>Journal of Cognitive Neuroscience, 33(4)</em>, 756–768. doi: <a href="https://doi.org/10.1162/jocn_a_01679">10.1162/jocn_a_01679</a><a href="#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p>Taken from <a href="http://imaging.mrc-cbu.cam.ac.uk/statswiki/FAQ/rxxy_correction">this page</a>, which has more extensive introduction to the issue.<a href="#fnref2" class="footnote-back">↩</a></p></li>
<li id="fn3"><p>Tu, Y. K., &amp; Gilthorpe, M. S. (2007). Revisiting the relation between change and initial value: a review and evaluation. <em>Statistics in medicine, 26(2)</em>, 443-457. doi: <a href="https://doi.org/10.1002/sim.2538">10.1002/sim.2538</a><a href="#fnref3" class="footnote-back">↩</a></p></li>
<li id="fn4"><p>Maloney, C. J., &amp; Rastogi, S. C. (1970). Significance test for Grubbs’s estimators. <em>Biometrics, 26</em>, 671-676.<a href="#fnref4" class="footnote-back">↩</a></p></li>
<li id="fn5"><p>Myrtek, M., &amp; Foerster, F. (1986). The law of initial value: A rare exception. <em>Biological Psychology, 22</em>, 227-239.<a href="#fnref5" class="footnote-back">↩</a></p></li>
<li id="fn6"><p>Jin, P. (1992). Toward a reconceptualization of the law of initial value. <em>Psychological Bulletin, 111</em>, 176-184. doi: <a href="http://psycnet.apa.org/doi/10.1037/0033-2909.111.1.176">10.1037/0033-2909.111.1.176</a><a href="#fnref6" class="footnote-back">↩</a></p></li>
</ol>
</div>
</div>

   
   
      </div>
   <div class="col-md-2">
          <div id="toc">
       <button type="button" class="close">×</button>
       <ul>
       <li><a href="#setup-environment">Setup environment</a></li>
       <li><a href="#load-task-data">Load task data</a><ul>
       <li><a href="#study-2">Study 2</a></li>
       <li><a href="#study-1">Study 1</a></li>
       </ul></li>
       <li><a href="#change-from-baseline">Change from baseline</a><ul>
       <li><a href="#calculate-change-scores">Calculate change scores</a></li>
       <li><a href="#plots">Plots</a></li>
       <li><a href="#statistics">Statistics</a></li>
       </ul></li>
       </ul>
     </div>
        </div>
   </div>
   </div>
            
      

  <script>
    $(document).ready(function () {

		// add bootstrap table styles to pandoc tables
	$('tr.header').parent('thead').parent('table').addClass('table table-condensed');
		
 	 	$('#content img').addClass("image-thumb");
		
		$('#content img').addClass("image-lb");
	$('#content').magnificPopup({
	    type:'image',
	    closeOnContentClick: false,
	    closeBtnInside: false,
	    delegate: '.image-lb',
	    gallery: {enabled: true },
	    image: {
	        verticalFit: true,
		titleSrc: 'alt'
	    }
 	});
 	    });
  </script>



    <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
	var script = document.createElement("script");
	script.type = "text/javascript";
	script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
	document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>
  
</body>
</html>
