<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="pandoc" />

        <meta name="author" content="Leon Reteig" />
    
    
    <title>AB-tDCS</title>

        <script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="site_libs/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" />
    <script src="site_libs/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
    <script src="site_libs/navigation-1.1/tabsets.js"></script>
    <link href="site_libs/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
    <script src="site_libs/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
    <link href="site_libs/clean-0.1/clean.css" rel="stylesheet" />
    <script src="site_libs/clean-0.1/clean.js"></script>
    <link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
    <link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
        <br>
    <br>
    <br>
    &nbsp;
    <p style="text-align: center;"><a href="https://lcreteig.github.io/AB-tDCS">Project website</a></p>
    <p style="text-align: center;"> Data and other resources: <a href="https://osf.io/y6hsf/">Open Science Framework</a></p>
    <p style="text-align: center;"> Source code: <a href="https://github.com/lcreteig/AB-tDCS">Github</a></p>
    &nbsp;
    <hr />
    
    
        <style type="text/css">code{white-space: pre;}</style>
    <style type="text/css">
      a.sourceLine { display: inline-block; line-height: 1.25; }
      a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
      a.sourceLine:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode { white-space: pre; position: relative; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      code.sourceCode { white-space: pre-wrap; }
      a.sourceLine { text-indent: -1em; padding-left: 1em; }
      }
      pre.numberSource a.sourceLine
        { position: relative; left: -4em; }
      pre.numberSource a.sourceLine::before
        { content: attr(data-line-number);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; pointer-events: all; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
          color: #aaaaaa;
        }
      pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
      div.sourceCode
        {  }
      @media screen {
      a.sourceLine::before { text-decoration: underline; }
      }
      code span.al { color: #ff0000; font-weight: bold; } /* Alert */
      code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
      code span.at { color: #7d9029; } /* Attribute */
      code span.bn { color: #40a070; } /* BaseN */
      code span.bu { } /* BuiltIn */
      code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
      code span.ch { color: #4070a0; } /* Char */
      code span.cn { color: #880000; } /* Constant */
      code span.co { color: #60a0b0; font-style: italic; } /* Comment */
      code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
      code span.do { color: #ba2121; font-style: italic; } /* Documentation */
      code span.dt { color: #902000; } /* DataType */
      code span.dv { color: #40a070; } /* DecVal */
      code span.er { color: #ff0000; font-weight: bold; } /* Error */
      code span.ex { } /* Extension */
      code span.fl { color: #40a070; } /* Float */
      code span.fu { color: #06287e; } /* Function */
      code span.im { } /* Import */
      code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
      code span.kw { color: #007020; font-weight: bold; } /* Keyword */
      code span.op { color: #666666; } /* Operator */
      code span.ot { color: #007020; } /* Other */
      code span.pp { color: #bc7a00; } /* Preprocessor */
      code span.sc { color: #4070a0; } /* SpecialChar */
      code span.ss { color: #bb6688; } /* SpecialString */
      code span.st { color: #4070a0; } /* String */
      code span.va { color: #19177c; } /* Variable */
      code span.vs { color: #4070a0; } /* VerbatimString */
      code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    </style>
    
    
    <!-- tabsets -->
    <script>
      $(document).ready(function () {
	  window.buildTabsets("toc");
      });
      $(document).ready(function () {
	  $('.tabset-dropdown > .nav-tabs > li').click(function () {
	      $(this).parent().toggleClass('nav-tabs-open')
	  });
      });
    </script>

    <!-- code folding -->
    
    <!-- code download -->
    
    <!-- tabsets dropdown -->

    <style type="text/css">
      .tabset-dropdown > .nav-tabs {
	  display: inline-table;
	  max-height: 500px;
	  min-height: 44px;
	  overflow-y: auto;
	  background: white;
	  border: 1px solid #ddd;
	  border-radius: 4px;
      }
      
      .tabset-dropdown > .nav-tabs > li.active:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
	  content: "&#xe258;";
	  border: none;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs > li.active {
	  display: block;
      }

      .tabset-dropdown > .nav-tabs > li.active a {
  	  padding: 0 15px !important;
      }

      .tabset-dropdown > .nav-tabs > li > a,
      .tabset-dropdown > .nav-tabs > li > a:focus,
      .tabset-dropdown > .nav-tabs > li > a:hover {
	  border: none;
	  display: inline-block;
	  border-radius: 4px;
	  background-color: transparent;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li {
	  display: block;
	  float: none;
      }
      
      .tabset-dropdown > .nav-tabs > li {
	  display: none;
	  margin-left: 0 !important;
      }
    </style>
    
</head>

<body class="preload">

      <!-- html_clean start -->
   <div class="container-fluid main-container">
     <div class="row">
       <div class="col-md-10">
               
   
      
   <div class="navbar navbar-default  navbar-fixed-top" role="navigation">
     <div class="container">
       <div class="navbar-header">
         <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
           <span class="icon-bar"></span>
           <span class="icon-bar"></span>
           <span class="icon-bar"></span>
         </button>
         <a class="navbar-brand" href="index.html"></a>
       </div>
       <div id="navbar" class="navbar-collapse collapse">
         <ul class="nav navbar-nav">
           <li>
     <a href="index.html">
       <span class="fas fa-info"></span>
        
       About
     </a>
   </li>
   <li>
     <a href="AB-tDCS_paper.html">
       <span class="fas fa-newspaper"></span>
        
       Paper
     </a>
   </li>
   <li class="dropdown">
     <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
       <span class="fas fa-file-code"></span>
        
       Analyses
        
       <span class="caret"></span>
     </a>
     <ul class="dropdown-menu" role="menu">
       <li class="dropdown-header">Individual differences</li>
       <li>
         <a href="AB-tDCS_change-from-baseline.html">Change from baseline</a>
       </li>
       <li>
         <a href="AB-tDCS_anodal-vs-cathodal.html">Anodal vs. cathodal</a>
       </li>
       <li>
         <a href="AB-tDCS_replication-analyses.html">Replication analyses</a>
       </li>
       <li class="divider"></li>
       <li class="dropdown-header">Group-level</li>
       <li>
         <a href="AB-tDCS_group.html">Task</a>
       </li>
       <li>
         <a href="AB-tDCS_questionnaires.html">Questionnaires</a>
       </li>
     </ul>
   </li>
         </ul>
         <ul class="nav navbar-nav navbar-right">
           <li>
     <a href="https://github.com/lcreteig/AB-tDCS">
       <span class="fas fa-github"></span>
        
       Source
     </a>
   </li>
         </ul>
       </div><!--/.nav-collapse -->
     </div><!--/.container -->
   </div><!--/.navbar -->
        
      <h1 class="title">AB-tDCS</h1>
         <h1 class="subtitle">Replication analyses</h1>
   
      
      <!-- html_clean authors -->
         <h4 class="author"><em>Leon Reteig</em></h4>
            <h4 class="date"><em>22 May, 2021</em></h4>
      
      
   
<!-- Don't indent these lines or it will mess pre blocks indentation --> 
<div id="content">
<div id="setup-environment" class="section level1">
<h1>Setup environment</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># Load packages</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(tidyverse)  <span class="co"># importing, transforming, and visualizing data frames</span></a></code></pre></div>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.0 ──</code></pre>
<pre><code>## ✓ ggplot2 3.3.3     ✓ purrr   0.3.4
## ✓ tibble  3.0.6     ✓ dplyr   1.0.4
## ✓ tidyr   1.1.2     ✓ stringr 1.4.0
## ✓ readr   1.4.0     ✓ forcats 0.5.1</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">library</span>(here) <span class="co"># (relative) file paths</span></a></code></pre></div>
<pre><code>## here() starts at /Users/leonreteig/AB-tDCS</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">library</span>(knitr) <span class="co"># R notebook output</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw">library</span>(scales) <span class="co"># Percentage axis labels </span></a></code></pre></div>
<pre><code>## 
## Attaching package: &#39;scales&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     discard</code></pre>
<pre><code>## The following object is masked from &#39;package:readr&#39;:
## 
##     col_factor</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">library</span>(broom) <span class="co"># transform model outputs into data frames</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="kw">library</span>(ggm) <span class="co"># partial correlations</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="kw">library</span>(BayesFactor) <span class="co"># Bayesian statistics</span></a></code></pre></div>
<pre><code>## Loading required package: coda</code></pre>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## 
## Attaching package: &#39;Matrix&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:tidyr&#39;:
## 
##     expand, pack, unpack</code></pre>
<pre><code>## ************
## Welcome to BayesFactor 0.9.12-4.2. If you have questions, please contact Richard Morey (richarddmorey@gmail.com).
## 
## Type BFManual() to open the manual.
## ************</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw">library</span>(metafor) <span class="co"># meta-analysis</span></a></code></pre></div>
<pre><code>## Loading &#39;metafor&#39; package (version 2.4-0). For an overview 
## and introduction to the package please type: help(metafor).</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw">library</span>(predictionInterval) <span class="co"># prediction intervals (for correlations)</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="kw">library</span>(TOSTER) <span class="co"># equivalence tests</span></a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="kw">library</span>(pwr) <span class="co"># power analysis</span></a>
<a class="sourceLine" id="cb19-4" data-line-number="4"><span class="kw">library</span>(knitrhooks) <span class="co"># printing in rmarkdown outputs</span></a>
<a class="sourceLine" id="cb19-5" data-line-number="5">  <span class="kw">output_max_height</span>()</a>
<a class="sourceLine" id="cb19-6" data-line-number="6"><span class="co"># Source functions</span></a>
<a class="sourceLine" id="cb19-7" data-line-number="7"><span class="kw">source</span>(<span class="kw">here</span>(<span class="st">&quot;src&quot;</span>, <span class="st">&quot;func&quot;</span>, <span class="st">&quot;behavioral_analysis.R&quot;</span>)) <span class="co"># loading data and calculating measures</span></a>
<a class="sourceLine" id="cb19-8" data-line-number="8">knitr<span class="op">::</span><span class="kw">read_chunk</span>(<span class="kw">here</span>(<span class="st">&quot;src&quot;</span>, <span class="st">&quot;func&quot;</span>, <span class="st">&quot;behavioral_analysis.R&quot;</span>)) <span class="co"># display code from file in this notebook</span></a>
<a class="sourceLine" id="cb19-9" data-line-number="9">load_data_path &lt;-<span class="st"> </span><span class="kw">here</span>(<span class="st">&quot;src&quot;</span>,<span class="st">&quot;func&quot;</span>,<span class="st">&quot;load_data.Rmd&quot;</span>) <span class="co"># for rerunning and displaying</span></a>
<a class="sourceLine" id="cb19-10" data-line-number="10"><span class="kw">source</span>(<span class="kw">here</span>(<span class="st">&quot;src&quot;</span>, <span class="st">&quot;lib&quot;</span>, <span class="st">&quot;appendixCodeFunctionsJeffreys.R&quot;</span>)) <span class="co"># replication Bayes factors</span></a></code></pre></div>
<pre><code>## Loading required package: hypergeo</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="kw">print</span>(<span class="kw">sessionInfo</span>())</a></code></pre></div>
<pre style = "max-height:300px; overflow-y: auto;">## R version 3.6.2 (2019-12-12)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS Catalina 10.15.7
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices datasets  utils     methods   base     
## 
## other attached packages:
##  [1] hypergeo_1.2-13          knitrhooks_0.0.4         pwr_1.3-0               
##  [4] TOSTER_0.3.4             predictionInterval_1.0.0 metafor_2.4-0           
##  [7] BayesFactor_0.9.12-4.2   Matrix_1.3-2             coda_0.19-4             
## [10] ggm_2.5                  broom_0.7.4.9000         scales_1.1.1            
## [13] knitr_1.31               here_1.0.1               forcats_0.5.1           
## [16] stringr_1.4.0            dplyr_1.0.4              purrr_0.3.4             
## [19] readr_1.4.0              tidyr_1.1.2              tibble_3.0.6            
## [22] ggplot2_3.3.3            tidyverse_1.3.0         
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_1.0.6         lubridate_1.7.9.2  mvtnorm_1.1-1      lattice_0.20-41   
##  [5] gtools_3.8.2       assertthat_0.2.1   rprojroot_2.0.2    digest_0.6.27     
##  [9] R6_2.5.0           cellranger_1.1.0   backports_1.2.1    MatrixModels_0.5-0
## [13] reprex_1.0.0       evaluate_0.14      httr_1.4.2         pillar_1.4.7      
## [17] rlang_0.4.10       readxl_1.3.1       rstudioapi_0.13    rmarkdown_2.7     
## [21] contfrac_1.1-12    igraph_1.2.6       munsell_0.5.0      compiler_3.6.2    
## [25] modelr_0.1.8       xfun_0.21          pkgconfig_2.0.3    htmltools_0.5.1.1 
## [29] tidyselect_1.1.0   bookdown_0.21      crayon_1.4.1       dbplyr_2.1.0      
## [33] withr_2.4.1        elliptic_1.4-0     MASS_7.3-53.1      grid_3.6.2        
## [37] nlme_3.1-152       jsonlite_1.7.2     gtable_0.3.0       lifecycle_1.0.0   
## [41] DBI_1.1.1          magrittr_2.0.1     rmdformats_1.0.1   cli_2.3.0         
## [45] stringi_1.5.3      pbapply_1.4-3      renv_0.12.5-72     fs_1.5.0          
## [49] xml2_1.3.2         ellipsis_0.3.1     generics_0.1.0     vctrs_0.3.6       
## [53] deSolve_1.28       tools_3.6.2        glue_1.4.2         hms_1.0.0         
## [57] parallel_3.6.2     yaml_2.2.1         colorspace_2.0-0   MBESS_4.8.0       
## [61] rvest_0.3.6        haven_2.3.1
</pre>
</div>
<div id="load-task-data" class="section level1">
<h1>Load task data</h1>
<div id="study-2" class="section level2">
<h2>Study 2</h2>
<p>The following participants are excluded from further analysis at this point, because of incomplete data:</p>
<ul>
<li><code>S03</code>, <code>S14</code>, <code>S29</code>, <code>S38</code>, <code>S43</code>, <code>S46</code>: their T1 performance in session 1 was less than 63% correct, so they were not invited back. This cutoff was determined based on a separate pilot study with 10 participants. It is two standard deviations below the mean of that sample.</li>
<li><code>S25</code> has no data for session 2, as they stopped responding to requests for scheduling the session</li>
<li><code>S31</code> was excluded as a precaution after session 1, as they developed a severe headache and we could not rule out the possibility this was related to the tDCS</li>
</ul>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">dataDir_study2 &lt;-<span class="st"> </span><span class="kw">here</span>(<span class="st">&quot;data&quot;</span>) <span class="co"># root folder with AB task data</span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2">subs_incomplete &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;S03&quot;</span>, <span class="st">&quot;S14&quot;</span>, <span class="st">&quot;S25&quot;</span>, <span class="st">&quot;S29&quot;</span>, <span class="st">&quot;S31&quot;</span>, <span class="st">&quot;S38&quot;</span>, <span class="st">&quot;S43&quot;</span>, <span class="st">&quot;S46&quot;</span>) <span class="co"># don&#39;t try to load data from these participants</span></a>
<a class="sourceLine" id="cb22-3" data-line-number="3">df_study2 &lt;-<span class="st"> </span><span class="kw">load_data_study2</span>(dataDir_study2, subs_incomplete) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-4" data-line-number="4"><span class="st">  </span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># discard rows with data from incomplete subjects</span></a>
<a class="sourceLine" id="cb22-5" data-line-number="5"><span class="st">   </span><span class="co"># recode first.session (&quot;anodal&quot; or &quot;cathodal&quot;) to session.order (&quot;anodal first&quot;, &quot;cathodal first&quot;)</span></a>
<a class="sourceLine" id="cb22-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">first.session =</span> <span class="kw">parse_factor</span>(<span class="kw">paste</span>(first.session, <span class="st">&quot;first&quot;</span>), </a>
<a class="sourceLine" id="cb22-7" data-line-number="7">                                      <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;anodal first&quot;</span>, <span class="st">&quot;cathodal first&quot;</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-8" data-line-number="8"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">session.order =</span> first.session)</a>
<a class="sourceLine" id="cb22-9" data-line-number="9">n_study2 &lt;-<span class="st"> </span><span class="kw">n_distinct</span>(df_study2<span class="op">$</span>subject) <span class="co"># number of subjects in study 2</span></a></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw">kable</span>(<span class="kw">head</span>(df_study2,<span class="dv">13</span>), <span class="dt">digits =</span> <span class="dv">1</span>, <span class="dt">caption =</span> <span class="st">&quot;Data frame for study 2&quot;</span>)</a></code></pre></div>
<table>
<caption>Data frame for study 2</caption>
<thead>
<tr class="header">
<th align="left">subject</th>
<th align="left">session.order</th>
<th align="left">stimulation</th>
<th align="left">block</th>
<th align="left">lag</th>
<th align="right">trials</th>
<th align="right">T1</th>
<th align="right">T2</th>
<th align="right">T2.given.T1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">anodal</td>
<td align="left">pre</td>
<td align="left">3</td>
<td align="right">118</td>
<td align="right">0.8</td>
<td align="right">0.4</td>
<td align="right">0.4</td>
</tr>
<tr class="even">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">anodal</td>
<td align="left">pre</td>
<td align="left">8</td>
<td align="right">60</td>
<td align="right">0.8</td>
<td align="right">0.8</td>
<td align="right">0.8</td>
</tr>
<tr class="odd">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">anodal</td>
<td align="left">tDCS</td>
<td align="left">3</td>
<td align="right">126</td>
<td align="right">0.8</td>
<td align="right">0.3</td>
<td align="right">0.3</td>
</tr>
<tr class="even">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">anodal</td>
<td align="left">tDCS</td>
<td align="left">8</td>
<td align="right">65</td>
<td align="right">0.8</td>
<td align="right">0.7</td>
<td align="right">0.7</td>
</tr>
<tr class="odd">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">anodal</td>
<td align="left">post</td>
<td align="left">3</td>
<td align="right">122</td>
<td align="right">0.8</td>
<td align="right">0.2</td>
<td align="right">0.3</td>
</tr>
<tr class="even">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">anodal</td>
<td align="left">post</td>
<td align="left">8</td>
<td align="right">61</td>
<td align="right">0.7</td>
<td align="right">0.7</td>
<td align="right">0.7</td>
</tr>
<tr class="odd">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">cathodal</td>
<td align="left">pre</td>
<td align="left">3</td>
<td align="right">116</td>
<td align="right">0.8</td>
<td align="right">0.4</td>
<td align="right">0.4</td>
</tr>
<tr class="even">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">cathodal</td>
<td align="left">pre</td>
<td align="left">8</td>
<td align="right">60</td>
<td align="right">0.7</td>
<td align="right">0.8</td>
<td align="right">0.8</td>
</tr>
<tr class="odd">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">cathodal</td>
<td align="left">tDCS</td>
<td align="left">3</td>
<td align="right">129</td>
<td align="right">0.7</td>
<td align="right">0.4</td>
<td align="right">0.4</td>
</tr>
<tr class="even">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">cathodal</td>
<td align="left">tDCS</td>
<td align="left">8</td>
<td align="right">64</td>
<td align="right">0.7</td>
<td align="right">0.8</td>
<td align="right">0.9</td>
</tr>
<tr class="odd">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">cathodal</td>
<td align="left">post</td>
<td align="left">3</td>
<td align="right">128</td>
<td align="right">0.6</td>
<td align="right">0.4</td>
<td align="right">0.4</td>
</tr>
<tr class="even">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">cathodal</td>
<td align="left">post</td>
<td align="left">8</td>
<td align="right">62</td>
<td align="right">0.7</td>
<td align="right">0.8</td>
<td align="right">0.8</td>
</tr>
<tr class="odd">
<td align="left">S02</td>
<td align="left">cathodal first</td>
<td align="left">anodal</td>
<td align="left">pre</td>
<td align="left">3</td>
<td align="right">124</td>
<td align="right">1.0</td>
<td align="right">0.8</td>
<td align="right">0.8</td>
</tr>
</tbody>
</table>
<p>The data has the following columns:</p>
<ul>
<li><strong>subject</strong>: Participant ID, e.g. <code>S01</code>, <code>S12</code></li>
<li><strong>session.order</strong>: Whether participant received <code>anodal</code> or <code>cathodal</code> tDCS in the first session (<code>anodal_first</code> vs. <code>cathodal_first</code>).</li>
<li><strong>stimulation</strong>: Whether participant received <code>anodal</code> or <code>cathodal</code> tDCS</li>
<li><strong>block</strong>: Whether data is before (<code>pre), during (</code>tDCS<code>) or after (</code>post`) tDCS</li>
<li><strong>lag</strong>: Whether T2 followed T1 after two distractors (lag <code>3</code>) or after 7 distractors (lag <code>8</code>)</li>
<li><strong>trials</strong>: Number of trials per lag that the participant completed in this block</li>
<li><strong>T1</strong>: Proportion of trials (out of <code>trials</code>) in which T1 was identified correctly</li>
<li><strong>T2</strong>: Proportion of trials (out of <code>trials</code>) in which T2 was identified correctly</li>
<li><strong>T2.given.T1</strong>: Proportion of trials which T2 was identified correctly, out of the trials in which T1 was idenitified correctly (T2|T1).</li>
</ul>
<p>The number of trials vary from person-to-person, as some completed more trials in a 20-minute block than others (because responses were self-paced):</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1">df_study2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(lag) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-3" data-line-number="3"><span class="st">  </span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(trials), <span class="kw">funs</span>(mean, min, max, sd)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-4" data-line-number="4"><span class="st">  </span><span class="kw">kable</span>(<span class="dt">caption =</span> <span class="st">&quot;Descriptive statistics for trial counts per lag&quot;</span>, <span class="dt">digits =</span> <span class="dv">0</span>)</a></code></pre></div>
<pre><code>## Warning: `funs()` was deprecated in dplyr 0.8.0.
## Please use a list of either functions or lambdas: 
## 
##   # Simple named list: 
##   list(mean = mean, median = median)
## 
##   # Auto named with `tibble::lst()`: 
##   tibble::lst(mean, median)
## 
##   # Using lambdas
##   list(~ mean(., trim = .2), ~ median(., na.rm = TRUE))</code></pre>
<table>
<caption>Descriptive statistics for trial counts per lag</caption>
<thead>
<tr class="header">
<th align="left">lag</th>
<th align="right">mean</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">3</td>
<td align="right">130</td>
<td align="right">78</td>
<td align="right">163</td>
<td align="right">17</td>
</tr>
<tr class="even">
<td align="left">8</td>
<td align="right">65</td>
<td align="right">39</td>
<td align="right">87</td>
<td align="right">9</td>
</tr>
</tbody>
</table>
</div>
<div id="study-1" class="section level2">
<h2>Study 1</h2>
<p>These data were used for statistical analysis in London &amp; Slagter (2021)<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>, and were processed by the lead author:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1">dataPath_study1 &lt;-<span class="st"> </span><span class="kw">here</span>(<span class="st">&quot;data&quot;</span>,<span class="st">&quot;AB-tDCS_study1.txt&quot;</span>)</a>
<a class="sourceLine" id="cb26-2" data-line-number="2">data_study1_fromDisk &lt;-<span class="st"> </span><span class="kw">read.table</span>(dataPath_study1, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">dec =</span> <span class="st">&quot;,&quot;</span>)</a>
<a class="sourceLine" id="cb26-3" data-line-number="3"><span class="kw">glimpse</span>(data_study1_fromDisk)</a></code></pre></div>
<pre style = "max-height:300px; overflow-y: auto;">## Rows: 34
## Columns: 120
## $ SD_T1                           <dbl> 0.3313, 0.0289, -0.8027, -0.5381, -2.…
## $ MeanBLT1Acc                     <dbl> 0.8800, 0.8600, 0.8050, 0.8225, 0.665…
## $ First_Session                   <int> 1, 2, 1, 1, 2, 1, 2, 1, 2, 2, 1, 2, 1…
## $ fileno                          <fct> pp4, pp6, pp7, pp9, pp10, pp11, pp12,…
## $ AB_HighLow                      <dbl> 2, 1, 2, 1, 1, 1, 1, 1, 2, 1, 1, 2, 1…
## $ vb_T1_2_NP                      <dbl> 0.925, 0.875, 0.825, 0.625, 0.650, 0.…
## $ vb_T1_4_NP                      <dbl> 0.800, 0.825, 0.825, 0.825, 0.675, 0.…
## $ vb_T1_10_NP                     <dbl> 0.925, 0.925, 0.800, 0.775, 0.825, 0.…
## $ vb_T1_4_P                       <dbl> 0.850, 0.900, 0.825, 0.775, 0.625, 0.…
## $ vb_T1_10_P                      <dbl> 0.825, 0.900, 0.775, 0.825, 0.625, 0.…
## $ vb_NB_2_NP                      <dbl> 0.1351, 0.3429, 0.3636, 0.3600, 0.346…
## $ vb_NB_4_NP                      <dbl> 0.3125, 0.5455, 0.5455, 0.3030, 0.296…
## $ vb_NB_10_NP                     <dbl> 0.8378, 0.8108, 0.9688, 0.6129, 0.727…
## $ vb_NB_4_P                       <dbl> 0.2941, 0.5278, 0.6061, 0.3226, 0.520…
## $ vb_NB_10_P                      <dbl> 0.8485, 0.7778, 0.9032, 0.8182, 0.680…
## $ VB_AB                           <dbl> 0.7027, 0.4680, 0.6051, 0.2529, 0.381…
## $ VB_REC                          <dbl> 0.5253, 0.2654, 0.4233, 0.3099, 0.431…
## $ VB_PE                           <dbl> -0.0184, -0.0177, 0.0606, 0.0196, 0.2…
## $ tb_T1_2_NP                      <dbl> 0.775, 0.875, 0.675, 0.725, 0.475, 0.…
## $ tb_T1_4_NP                      <dbl> 0.825, 0.825, 0.700, 0.750, 0.675, 0.…
## $ tb_T1_10_NP                     <dbl> 0.875, 0.900, 0.700, 0.825, 0.500, 0.…
## $ tb_T1_4_P                       <dbl> 0.875, 0.800, 0.700, 0.775, 0.650, 0.…
## $ tb_T1_10_P                      <dbl> 0.850, 0.925, 0.800, 0.825, 0.625, 0.…
## $ tb_NB_2_NP                      <dbl> 0.1290, 0.5143, 0.2222, 0.0690, 0.315…
## $ tb_NB_4_NP                      <dbl> 0.3333, 0.5455, 0.6071, 0.1333, 0.370…
## $ tb_NB_10_NP                     <dbl> 0.8286, 0.8611, 0.8571, 0.5152, 0.850…
## $ tb_NB_4_P                       <dbl> 0.3143, 0.6250, 0.5357, 0.4839, 0.538…
## $ tb_NB_10_P                      <dbl> 0.8529, 0.7568, 0.9375, 0.6667, 0.680…
## $ TB_AB                           <dbl> 0.6995, 0.3468, 0.6349, 0.4462, 0.534…
## $ TB_REC                          <dbl> 0.4952, 0.3157, 0.2500, 0.3818, 0.479…
## $ TB_PE                           <dbl> -0.0190, 0.0795, -0.0714, 0.3505, 0.1…
## $ nb_T1_2_NP                      <dbl> 0.850, 0.850, 0.650, 0.725, 0.675, 0.…
## $ nb_T1_4_NP                      <dbl> 0.800, 0.850, 0.725, 0.675, 0.575, 0.…
## $ nb_T1_10_NP                     <dbl> 0.925, 0.825, 0.750, 0.850, 0.725, 0.…
## $ nb_T1_4_P                       <dbl> 0.850, 0.900, 0.675, 0.750, 0.875, 0.…
## $ nb_T1_10_P                      <dbl> 0.900, 0.825, 0.750, 0.800, 0.550, 0.…
## $ nb_NB_2_NP                      <dbl> 0.0588, 0.4412, 0.4615, 0.1034, 0.296…
## $ nb_NB_4_NP                      <dbl> 0.0938, 0.4412, 0.2414, 0.1481, 0.478…
## $ nb_NB_10_NP                     <dbl> 0.8649, 0.7576, 0.9667, 0.6765, 0.896…
## $ nb_NB_4_P                       <dbl> 0.4118, 0.7222, 0.4815, 0.3667, 0.685…
## $ nb_NB_10_P                      <dbl> 0.8333, 0.8485, 0.8333, 0.7188, 0.818…
## $ NB_AB                           <dbl> 0.8060, 0.3164, 0.5051, 0.5730, 0.600…
## $ NB_REC                          <dbl> 0.7711, 0.3164, 0.7253, 0.5283, 0.418…
## $ NB_PE                           <dbl> 0.3180, 0.2810, 0.2401, 0.2185, 0.207…
## $ vd_T1_2_NP                      <dbl> 0.925, 0.875, 0.800, 0.850, 0.575, 0.…
## $ vd_T1_4_NP                      <dbl> 0.850, 0.825, 0.825, 0.925, 0.700, 0.…
## $ vd_T1_10_NP                     <dbl> 0.850, 0.900, 0.825, 0.925, 0.750, 0.…
## $ vd_T1_4_P                       <dbl> 0.925, 0.775, 0.825, 0.750, 0.650, 0.…
## $ vd_T1_10_P                      <dbl> 0.925, 0.800, 0.725, 0.950, 0.575, 0.…
## $ vd_NB_2_NP                      <dbl> 0.0541, 0.2857, 0.3125, 0.1765, 0.173…
## $ vd_NB_4_NP                      <dbl> 0.2941, 0.4848, 0.4545, 0.2432, 0.428…
## $ vd_NB_10_NP                     <dbl> 1.0000, 0.6667, 0.9394, 0.7838, 0.766…
## $ vd_NB_4_P                       <dbl> 0.5135, 0.6774, 0.4848, 0.5000, 0.500…
## $ vd_NB_10_P                      <dbl> 0.8919, 0.8125, 0.9310, 0.8421, 0.608…
## $ VD_AB                           <dbl> 0.9459, 0.3810, 0.6269, 0.6073, 0.592…
## $ VD_REC                          <dbl> 0.7059, 0.1818, 0.4848, 0.5405, 0.338…
## $ VD_PE                           <dbl> 0.2194, 0.1926, 0.0303, 0.2568, 0.071…
## $ td_T1_2_NP                      <dbl> 0.950, 0.775, 0.625, 0.775, 0.525, 0.…
## $ td_T1_4_NP                      <dbl> 0.975, 0.800, 0.800, 0.750, 0.625, 0.…
## $ td_T1_10_NP                     <dbl> 0.975, 0.900, 0.800, 0.850, 0.575, 0.…
## $ td_T1_4_P                       <dbl> 0.875, 0.800, 0.800, 0.800, 0.600, 0.…
## $ td_T1_10_P                      <dbl> 0.875, 0.800, 0.850, 0.700, 0.525, 0.…
## $ td_NB_2_NP                      <dbl> 0.1579, 0.3226, 0.5200, 0.1290, 0.142…
## $ td_NB_4_NP                      <dbl> 0.4615, 0.4375, 0.3750, 0.2333, 0.320…
## $ td_NB_10_NP                     <dbl> 0.9487, 0.6944, 0.9375, 0.6471, 0.826…
## $ td_NB_4_P                       <dbl> 0.4571, 0.3750, 0.5625, 0.4063, 0.583…
## $ td_NB_10_P                      <dbl> 0.8857, 0.6875, 0.8529, 0.7143, 0.666…
## $ TD_AB                           <dbl> 0.7908, 0.3719, 0.4175, 0.5180, 0.683…
## $ TD_REC                          <dbl> 0.4872, 0.2569, 0.5625, 0.4137, 0.506…
## $ TD_PE                           <dbl> -0.0044, -0.0625, 0.1875, 0.1729, 0.2…
## $ nd_T1_2_NP                      <dbl> 0.700, 0.800, 0.650, 0.775, 0.425, 0.…
## $ nd_T1_4_NP                      <dbl> 0.850, 0.850, 0.725, 0.850, 0.650, 0.…
## $ nd_T1_10_NP                     <dbl> 0.800, 0.825, 0.800, 0.850, 0.600, 0.…
## $ nd_T1_4_P                       <dbl> 0.850, 0.800, 0.775, 0.775, 0.725, 0.…
## $ nd_T1_10_P                      <dbl> 0.850, 0.750, 0.800, 0.850, 0.675, 0.…
## $ nd_NB_2_NP                      <dbl> 0.0000, 0.2188, 0.2692, 0.0968, 0.235…
## $ nd_NB_4_NP                      <dbl> 0.3824, 0.5000, 0.5172, 0.2353, 0.384…
## $ nd_NB_10_NP                     <dbl> 0.8750, 0.5758, 0.8125, 0.7941, 0.708…
## $ nd_NB_4_P                       <dbl> 0.4118, 0.5000, 0.5806, 0.5484, 0.482…
## $ nd_NB_10_P                      <dbl> 0.9118, 0.7667, 0.8438, 0.8235, 0.629…
## $ ND_AB                           <dbl> 0.8750, 0.3570, 0.5433, 0.6973, 0.473…
## $ ND_REC                          <dbl> 0.4926, 0.0758, 0.2953, 0.5588, 0.323…
## $ ND_PE                           <dbl> 0.0294, 0.0000, 0.0634, 0.3131, 0.098…
## $ AnoMinBl_Lag2_NP                <dbl> -0.01, 0.17, -0.14, -0.29, -0.03, 0.0…
## $ AnoMinBl_Lag10_NP               <dbl> -0.01, 0.05, -0.11, -0.10, 0.12, -0.0…
## $ CathoMinBl_Lag2_NP              <dbl> 0.10, 0.04, 0.21, -0.05, -0.03, 0.09,…
## $ CathoMinBl_Lag10_NP             <dbl> -0.05, 0.03, 0.00, -0.14, 0.06, 0.00,…
## $ Tijdens_AnoMinBl_Lag2_NP        <dbl> -0.01, 0.17, -0.14, -0.29, -0.03, 0.0…
## $ Tijdens_AnoMinBl_Lag10_NP       <dbl> -0.01, 0.05, -0.11, -0.10, 0.12, -0.0…
## $ Tijdens_CathoMinBl_Lag2_NP      <dbl> 0.10, 0.04, 0.21, -0.05, -0.03, 0.09,…
## $ Tijdens_CathoMinBl_Lag10_NP     <dbl> -0.05, 0.03, 0.00, -0.14, 0.06, 0.00,…
## $ Tijdens_AnoMinBL_AB             <dbl> 0.00, -0.12, 0.03, 0.19, 0.15, -0.08,…
## $ Tijdens_CathoMinBL_AB           <dbl> -0.16, -0.01, -0.21, -0.09, 0.09, -0.…
## $ Na_AnoMinBL_AB                  <dbl> 0.10, -0.15, -0.10, 0.32, 0.22, -0.04…
## $ Na_CathoMinBL_AB                <dbl> -0.07, -0.02, -0.08, 0.09, -0.12, -0.…
## $ Tijdens_AnoMinBL_PE             <dbl> 0.00, 0.10, -0.13, 0.33, -0.06, -0.06…
## $ Tijdens_CathoMinBL_PE           <dbl> -0.22, -0.26, 0.16, -0.08, 0.19, -0.0…
## $ Na_CathoMinBL_PE                <dbl> -0.19, -0.19, 0.03, 0.06, 0.03, 0.31,…
## $ Na_AnoMinBL_PE                  <dbl> 0.34, 0.30, 0.18, 0.20, -0.02, 0.06, …
## $ Tijdens_AnoMinBL_REC            <dbl> -0.03, 0.05, -0.17, 0.07, 0.05, 0.07,…
## $ Tijdens_CathoMinBL_REC          <dbl> -0.22, 0.08, 0.08, -0.13, 0.17, -0.03…
## $ Na_CathoMinBL_REC               <dbl> -0.21, -0.11, -0.19, 0.02, -0.01, 0.1…
## $ Na_AnoMinBL_REC                 <dbl> 0.25, 0.05, 0.30, 0.22, -0.01, 0.13, …
## $ T1_Lag2_Tijdens_Ano_Min_BL_NP   <dbl> -0.15, 0.00, -0.15, 0.10, -0.18, 0.00…
## $ T1_Lag2_Tijdens_Catho_Min_BL_NP <dbl> 0.02, -0.10, -0.18, -0.08, -0.05, -0.…
## $ T1_Lag2_Na_Ano_Min_BL_NP        <dbl> -0.08, -0.03, -0.18, 0.10, 0.03, -0.1…
## $ T1_Lag2_Na_Catho_Min_BL_NP      <dbl> -0.23, -0.08, -0.15, -0.08, -0.15, -0…
## $ T1_Lag4_Tijdens_Ano_Min_BL_NP   <dbl> 0.02, 0.00, -0.13, -0.08, 0.00, 0.05,…
## $ T1_Lag4_Tijdens_Catho_Min_BL_NP <dbl> 0.13, -0.02, -0.02, -0.18, -0.08, 0.0…
## $ T1_Lag4_Na_Catho_Min_BL_NP      <dbl> 0.00, 0.03, -0.10, -0.08, -0.05, 0.13…
## $ T1_Lag4_Na_Ano_Min_BL_NP        <dbl> 0.00, 0.03, -0.10, -0.15, -0.10, 0.02…
## $ Mean_BL_PE                      <dbl> 0.10, 0.09, 0.05, 0.14, 0.15, -0.13, …
## $ ZVB_AB                          <dbl> 0.72613, -0.71847, 0.12559, -2.04185,…
## $ ZTB_AB                          <dbl> 0.97738, -1.74477, 0.47867, -0.97793,…
## $ ZNB_AB                          <dbl> 1.24043, -1.72891, -0.58440, -0.17267…
## $ ZVD_AB                          <dbl> 2.47191, -1.64491, 0.14714, 0.00446, …
## $ ZTD_AB                          <dbl> 1.39518, -1.23661, -0.94993, -0.31845…
## $ ZND_AB                          <dbl> 2.00765, -1.59142, -0.29725, 0.77327,…
## $ VB_T1_Acc_                      <dbl> 0.87, 0.89, 0.81, 0.77, 0.68, 0.95, 0…
## $ VD_T1_Acc_                      <dbl> 0.90, 0.84, 0.80, 0.88, 0.65, 0.90, 0…
</pre>
<p>We’ll use only a subset of columns, with the header structure <code>block/stim</code>_<code>target</code>_<code>lag</code>_<code>prime</code>, where:</p>
<ul>
<li><strong>block/stim</strong> is either:
<ol style="list-style-type: decimal">
<li><code>vb</code>: “anodal” tDCS, “pre” block (before tDCS)</li>
<li><code>tb</code>: “anodal” tDCS, “tDCS” block (during tDCS)</li>
<li><code>nb</code>: “anodal” tDCS, “post” block (after tDCS)</li>
<li><code>vd</code>: “cathodal” tDCS, “pre” block (before tDCS)</li>
<li><code>td</code>: “cathodal” tDCS, “tDCS” block (during tDCS)</li>
<li><code>nd</code>: “cathodal” tDCS, “post” block (after tDCS)</li>
</ol></li>
<li><strong>target</strong> is either:
<ol style="list-style-type: decimal">
<li><code>T1</code> (T1 accuracy): proportion of trials in which T1 was identified correctly</li>
<li><code>NB</code> (T2|T1 accuracy): proportion of trials in which T2 was identified correctly, given T1 was identified correctly</li>
</ol></li>
<li><strong>lag</strong> is either:
<ol style="list-style-type: decimal">
<li><code>2</code> (lag 2), when T2 followed T1 after 1 distractor</li>
<li><code>4</code> (lag 4), when T2 followed T1 after 3 distractors</li>
<li><code>10</code>, (lag 10), when T2 followed T1 after 9 distractors</li>
</ol></li>
<li><strong>prime</strong> is either:
<ol style="list-style-type: decimal">
<li><code>P</code> (prime): when the stimulus at lag 2 (in lag 4 or lag 10 trials) had the same identity as T2</li>
<li><code>NP</code> (no prime) when this was not the case. Study 2 had no primes, so we’ll only keep these.</li>
</ol></li>
</ul>
<p>We’ll also keep two more columns: <code>fileno</code> (participant ID) and <code>First_Session</code> (<code>1</code> meaning participants received anodal tDCS in the first session, <code>2</code> meaning participants received cathodal tDCS in the first session).</p>
<div id="reformat" class="section level3">
<h3>Reformat</h3>
<p>Now we’ll reformat the data to match the data frame for study 2:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">format_study2 &lt;-<span class="st"> </span><span class="cf">function</span>(df) {</a>
<a class="sourceLine" id="cb27-2" data-line-number="2">  df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb27-3" data-line-number="3"><span class="st">    </span><span class="kw">select</span>(fileno, First_Session, <span class="kw">ends_with</span>(<span class="st">&quot;_NP&quot;</span>), <span class="op">-</span><span class="kw">contains</span>(<span class="st">&quot;Min&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># keep only relevant columns</span></a>
<a class="sourceLine" id="cb27-4" data-line-number="4"><span class="st">    </span><span class="kw">gather</span>(key, accuracy, <span class="op">-</span>fileno, <span class="op">-</span>First_Session) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># make long form</span></a>
<a class="sourceLine" id="cb27-5" data-line-number="5"><span class="st">    </span><span class="co"># split key column to create separate columns for each factor</span></a>
<a class="sourceLine" id="cb27-6" data-line-number="6"><span class="st">    </span><span class="kw">separate</span>(key, <span class="kw">c</span>(<span class="st">&quot;block&quot;</span>, <span class="st">&quot;stimulation&quot;</span>, <span class="st">&quot;target&quot;</span>, <span class="st">&quot;lag&quot;</span>), <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># split after 1st, 3rd, and 5th character</span></a>
<a class="sourceLine" id="cb27-7" data-line-number="7"><span class="st">    </span><span class="co"># convert to factors, relabel levels to match those in study 2</span></a>
<a class="sourceLine" id="cb27-8" data-line-number="8"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">block =</span> <span class="kw">factor</span>(block, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;v&quot;</span>, <span class="st">&quot;t&quot;</span>, <span class="st">&quot;n&quot;</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;pre&quot;</span>, <span class="st">&quot;tDCS&quot;</span>, <span class="st">&quot;post&quot;</span>)),</a>
<a class="sourceLine" id="cb27-9" data-line-number="9">           <span class="dt">stimulation =</span> <span class="kw">factor</span>(stimulation, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;b_&quot;</span>, <span class="st">&quot;d_&quot;</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;anodal&quot;</span>, <span class="st">&quot;cathodal&quot;</span>)),</a>
<a class="sourceLine" id="cb27-10" data-line-number="10">           <span class="dt">lag =</span> <span class="kw">factor</span>(lag, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;_2_NP&quot;</span>, <span class="st">&quot;_4_NP&quot;</span>, <span class="st">&quot;_10_NP&quot;</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">10</span>)),</a>
<a class="sourceLine" id="cb27-11" data-line-number="11">           <span class="dt">First_Session =</span> <span class="kw">factor</span>(First_Session, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;anodal first&quot;</span>,<span class="st">&quot;cathodal first&quot;</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb27-12" data-line-number="12"><span class="st">    </span><span class="kw">spread</span>(target, accuracy) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># create separate columns for T2.given.T1 and T1 performance</span></a>
<a class="sourceLine" id="cb27-13" data-line-number="13"><span class="st">    </span><span class="kw">rename</span>(<span class="dt">T2.given.T1 =</span> NB, <span class="dt">session.order =</span> First_Session, <span class="dt">subject =</span> fileno)<span class="co"># rename columns to match those in study 2</span></a>
<a class="sourceLine" id="cb27-14" data-line-number="14">}</a></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1">df_study1 &lt;-<span class="st"> </span><span class="kw">format_study2</span>(data_study1_fromDisk)</a>
<a class="sourceLine" id="cb28-2" data-line-number="2">n_study1 &lt;-<span class="st"> </span><span class="kw">n_distinct</span>(df_study1<span class="op">$</span>subject) <span class="co"># number of subjects in study 1</span></a></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="kw">kable</span>(<span class="kw">head</span>(df_study1,<span class="dv">19</span>), <span class="dt">digits =</span> <span class="dv">1</span>, <span class="dt">caption =</span> <span class="st">&quot;Data frame for study 1&quot;</span>)</a></code></pre></div>
<table>
<caption>Data frame for study 1</caption>
<thead>
<tr class="header">
<th align="left">subject</th>
<th align="left">session.order</th>
<th align="left">block</th>
<th align="left">stimulation</th>
<th align="left">lag</th>
<th align="right">T2.given.T1</th>
<th align="right">T1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">pre</td>
<td align="left">anodal</td>
<td align="left">2</td>
<td align="right">0.3</td>
<td align="right">0.6</td>
</tr>
<tr class="even">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">pre</td>
<td align="left">anodal</td>
<td align="left">4</td>
<td align="right">0.3</td>
<td align="right">0.7</td>
</tr>
<tr class="odd">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">pre</td>
<td align="left">anodal</td>
<td align="left">10</td>
<td align="right">0.7</td>
<td align="right">0.8</td>
</tr>
<tr class="even">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">pre</td>
<td align="left">cathodal</td>
<td align="left">2</td>
<td align="right">0.2</td>
<td align="right">0.6</td>
</tr>
<tr class="odd">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">pre</td>
<td align="left">cathodal</td>
<td align="left">4</td>
<td align="right">0.4</td>
<td align="right">0.7</td>
</tr>
<tr class="even">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">pre</td>
<td align="left">cathodal</td>
<td align="left">10</td>
<td align="right">0.8</td>
<td align="right">0.8</td>
</tr>
<tr class="odd">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">tDCS</td>
<td align="left">anodal</td>
<td align="left">2</td>
<td align="right">0.3</td>
<td align="right">0.5</td>
</tr>
<tr class="even">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">tDCS</td>
<td align="left">anodal</td>
<td align="left">4</td>
<td align="right">0.4</td>
<td align="right">0.7</td>
</tr>
<tr class="odd">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">tDCS</td>
<td align="left">anodal</td>
<td align="left">10</td>
<td align="right">0.8</td>
<td align="right">0.5</td>
</tr>
<tr class="even">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">tDCS</td>
<td align="left">cathodal</td>
<td align="left">2</td>
<td align="right">0.1</td>
<td align="right">0.5</td>
</tr>
<tr class="odd">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">tDCS</td>
<td align="left">cathodal</td>
<td align="left">4</td>
<td align="right">0.3</td>
<td align="right">0.6</td>
</tr>
<tr class="even">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">tDCS</td>
<td align="left">cathodal</td>
<td align="left">10</td>
<td align="right">0.8</td>
<td align="right">0.6</td>
</tr>
<tr class="odd">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">post</td>
<td align="left">anodal</td>
<td align="left">2</td>
<td align="right">0.3</td>
<td align="right">0.7</td>
</tr>
<tr class="even">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">post</td>
<td align="left">anodal</td>
<td align="left">4</td>
<td align="right">0.5</td>
<td align="right">0.6</td>
</tr>
<tr class="odd">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">post</td>
<td align="left">anodal</td>
<td align="left">10</td>
<td align="right">0.9</td>
<td align="right">0.7</td>
</tr>
<tr class="even">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">post</td>
<td align="left">cathodal</td>
<td align="left">2</td>
<td align="right">0.2</td>
<td align="right">0.4</td>
</tr>
<tr class="odd">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">post</td>
<td align="left">cathodal</td>
<td align="left">4</td>
<td align="right">0.4</td>
<td align="right">0.6</td>
</tr>
<tr class="even">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">post</td>
<td align="left">cathodal</td>
<td align="left">10</td>
<td align="right">0.7</td>
<td align="right">0.6</td>
</tr>
<tr class="odd">
<td align="left">pp11</td>
<td align="left">anodal first</td>
<td align="left">pre</td>
<td align="left">anodal</td>
<td align="left">2</td>
<td align="right">0.5</td>
<td align="right">1.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="replication-analyses" class="section level1">
<h1>Replication analyses</h1>
<p>Recreate data from the previous notebook:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="co"># Recreate data</span></a>
<a class="sourceLine" id="cb30-2" data-line-number="2">ABmagChange_study1 &lt;-<span class="st"> </span>df_study1 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb30-3" data-line-number="3"><span class="st">  </span><span class="kw">calc_ABmag</span>() <span class="op">%&gt;%</span><span class="co"># from the aggregated data, calculate AB magnitude</span></a>
<a class="sourceLine" id="cb30-4" data-line-number="4"><span class="st">  </span><span class="kw">calc_change_scores</span>() <span class="co"># from the AB magnitude, calculate change scores</span></a></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;subject&#39;, &#39;session.order&#39;, &#39;stimulation&#39;. You can override using the `.groups` argument.
## `summarise()` has grouped output by &#39;subject&#39;, &#39;session.order&#39;, &#39;stimulation&#39;. You can override using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1">p_r_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">pcorr_anodal_cathodal</span>(ABmagChange_study1)</a>
<a class="sourceLine" id="cb32-2" data-line-number="2">r_study1 &lt;-<span class="st"> </span>p_r_<span class="dv">1</span><span class="op">$</span>r[p_r_<span class="dv">1</span><span class="op">$</span>change <span class="op">==</span><span class="st"> &quot;tDCS - baseline&quot;</span>] <span class="co"># r-value in study 1</span></a>
<a class="sourceLine" id="cb32-3" data-line-number="3">n_study1 &lt;-<span class="st"> </span><span class="kw">n_distinct</span>(df_study1<span class="op">$</span>subject)</a>
<a class="sourceLine" id="cb32-4" data-line-number="4">n_study1_pc &lt;-<span class="st"> </span>n_study1<span class="dv">-1</span> <span class="co"># one less due to additional variable in partial correlation</span></a>
<a class="sourceLine" id="cb32-5" data-line-number="5">  </a>
<a class="sourceLine" id="cb32-6" data-line-number="6">ABmagChange_study2 &lt;-<span class="st"> </span>df_study2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb32-7" data-line-number="7"><span class="st">  </span><span class="kw">calc_ABmag</span>() <span class="op">%&gt;%</span><span class="co"># from the aggregated data, calculate AB magnitude</span></a>
<a class="sourceLine" id="cb32-8" data-line-number="8"><span class="st">  </span><span class="kw">calc_change_scores</span>() <span class="co"># from the AB magnitude, calculate change scores</span></a></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;subject&#39;, &#39;session.order&#39;, &#39;stimulation&#39;. You can override using the `.groups` argument.
## `summarise()` has grouped output by &#39;subject&#39;, &#39;session.order&#39;, &#39;stimulation&#39;. You can override using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1">p_r_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">pcorr_anodal_cathodal</span>(ABmagChange_study2)</a>
<a class="sourceLine" id="cb34-2" data-line-number="2">r_study2 &lt;-<span class="st"> </span>p_r_<span class="dv">2</span><span class="op">$</span>r[p_r_<span class="dv">2</span><span class="op">$</span>change <span class="op">==</span><span class="st"> &quot;tDCS - baseline&quot;</span>] <span class="co"># r-value in study 2</span></a>
<a class="sourceLine" id="cb34-3" data-line-number="3">n_study2_pc &lt;-<span class="st"> </span>n_study2<span class="dv">-1</span> <span class="co"># one less due to additional variable in partial correlation</span></a></code></pre></div>
<div id="pool-study-1-and-2" class="section level2">
<h2>Pool study 1 and 2</h2>
<p>As the samples in study 1 (n = 34) and 2 (n = 40) are on the smaller side, pooling the data from both studies might allow us to infer with more confidence whether the effect exists.</p>
<p>The main difference is that study 1 presented T2 at lag 2, 4 or 10, whereas study 2 used lags 3 and 8. The long lags should be fairly comparable, as they are both well outside the attentional blink window. T2|T1 performance for both is between 80-90 % at the group level (although performance is a little better for lag 10).</p>
<p>However, there is a big difference at the short lags: group-level performance at lag 3 (study 2) is 10-15 percentage points higher than at lag 2. Therefore, when comparing both studies, the best bet is to also create a “lag 3” condition in study 1, by imputing lag 2 and lag 4.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1">create_lag3_study1 &lt;-<span class="st"> </span><span class="cf">function</span>(df) {</a>
<a class="sourceLine" id="cb35-2" data-line-number="2">  df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-3" data-line-number="3"><span class="st">  </span><span class="kw">group_by</span>(subject, session.order, block, stimulation) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># for each condition</span></a>
<a class="sourceLine" id="cb35-4" data-line-number="4"><span class="st">    </span><span class="co"># calculate lag 3 as mean of 2 and 4; keep lag 10</span></a>
<a class="sourceLine" id="cb35-5" data-line-number="5"><span class="st">    </span><span class="kw">summarise</span>(<span class="dt">lag3_T2.given.T1 =</span> (<span class="kw">first</span>(T2.given.T1) <span class="op">+</span><span class="st"> </span><span class="kw">nth</span>(T2.given.T1,<span class="dv">2</span>)) <span class="op">/</span><span class="st"> </span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb35-6" data-line-number="6">              <span class="dt">lag3_T1 =</span> (<span class="kw">first</span>(T1) <span class="op">+</span><span class="st"> </span><span class="kw">nth</span>(T1,<span class="dv">2</span>)) <span class="op">/</span><span class="st"> </span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb35-7" data-line-number="7">              <span class="dt">lag10_T2.given.T1 =</span> <span class="kw">last</span>(T2.given.T1), </a>
<a class="sourceLine" id="cb35-8" data-line-number="8">              <span class="dt">lag10_T1 =</span> <span class="kw">last</span>(T1)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-9" data-line-number="9"><span class="st">    </span><span class="kw">gather</span>(condition, score, <span class="op">-</span>subject, <span class="op">-</span>session.order, <span class="op">-</span>block, <span class="op">-</span>stimulation) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># gather the 4 columns we created</span></a>
<a class="sourceLine" id="cb35-10" data-line-number="10"><span class="st">    </span><span class="kw">separate</span>(condition, <span class="kw">c</span>(<span class="st">&quot;lag&quot;</span>, <span class="st">&quot;measure&quot;</span>), <span class="st">&quot;_&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># separate lag and T1/T2|T1</span></a>
<a class="sourceLine" id="cb35-11" data-line-number="11"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">lag =</span> <span class="kw">str_remove</span>(lag,<span class="st">&quot;lag&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-12" data-line-number="12"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">lag =</span> <span class="kw">fct_relevel</span>(lag, <span class="st">&quot;3&quot;</span>,<span class="st">&quot;10&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#remake the lag factor</span></a>
<a class="sourceLine" id="cb35-13" data-line-number="13"><span class="st">    </span><span class="kw">spread</span>(measure, score) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># make a column of T1 and T2|T1</span></a>
<a class="sourceLine" id="cb35-14" data-line-number="14"><span class="st">    </span><span class="kw">ungroup</span>() <span class="co"># remove grouping to match original df from study 1</span></a>
<a class="sourceLine" id="cb35-15" data-line-number="15">}</a></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1">df_study1_lag3 &lt;-<span class="st"> </span><span class="kw">create_lag3_study1</span>(df_study1) </a>
<a class="sourceLine" id="cb36-2" data-line-number="2"><span class="kw">kable</span>(<span class="kw">head</span>(df_study1_lag3,<span class="dv">9</span>), <span class="dt">digits =</span> <span class="dv">1</span>, <span class="dt">caption =</span> <span class="st">&quot;Data frame for study 1 with lag 3 as the short lag&quot;</span>)</a></code></pre></div>
<table>
<caption>Data frame for study 1 with lag 3 as the short lag</caption>
<thead>
<tr class="header">
<th align="left">subject</th>
<th align="left">session.order</th>
<th align="left">block</th>
<th align="left">stimulation</th>
<th align="left">lag</th>
<th align="right">T1</th>
<th align="right">T2.given.T1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">pre</td>
<td align="left">anodal</td>
<td align="left">3</td>
<td align="right">0.7</td>
<td align="right">0.3</td>
</tr>
<tr class="even">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">pre</td>
<td align="left">anodal</td>
<td align="left">10</td>
<td align="right">0.8</td>
<td align="right">0.7</td>
</tr>
<tr class="odd">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">pre</td>
<td align="left">cathodal</td>
<td align="left">3</td>
<td align="right">0.6</td>
<td align="right">0.3</td>
</tr>
<tr class="even">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">pre</td>
<td align="left">cathodal</td>
<td align="left">10</td>
<td align="right">0.8</td>
<td align="right">0.8</td>
</tr>
<tr class="odd">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">tDCS</td>
<td align="left">anodal</td>
<td align="left">3</td>
<td align="right">0.6</td>
<td align="right">0.3</td>
</tr>
<tr class="even">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">tDCS</td>
<td align="left">anodal</td>
<td align="left">10</td>
<td align="right">0.5</td>
<td align="right">0.8</td>
</tr>
<tr class="odd">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">tDCS</td>
<td align="left">cathodal</td>
<td align="left">3</td>
<td align="right">0.6</td>
<td align="right">0.2</td>
</tr>
<tr class="even">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">tDCS</td>
<td align="left">cathodal</td>
<td align="left">10</td>
<td align="right">0.6</td>
<td align="right">0.8</td>
</tr>
<tr class="odd">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">post</td>
<td align="left">anodal</td>
<td align="left">3</td>
<td align="right">0.6</td>
<td align="right">0.4</td>
</tr>
</tbody>
</table>
<p>Then we redo the further processing, and combine with the data from study 2:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1">ABmagChange_pooled &lt;-<span class="st"> </span>df_study1_lag3 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb37-2" data-line-number="2"><span class="st">  </span><span class="kw">calc_ABmag</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># calculate AB mangnitude</span></a>
<a class="sourceLine" id="cb37-3" data-line-number="3"><span class="st">  </span><span class="kw">calc_change_scores</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># calculate change from baseline</span></a>
<a class="sourceLine" id="cb37-4" data-line-number="4"><span class="st">  </span><span class="kw">bind_rows</span>(.,ABmagChange_study2) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># combine with study 2</span></a>
<a class="sourceLine" id="cb37-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">study =</span> <span class="kw">ifelse</span>(<span class="kw">grepl</span>(<span class="st">&quot;^pp&quot;</span>,subject), <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>)) <span class="co"># add a &quot;study&quot; column, based on subject ID formatting</span></a></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;subject&#39;, &#39;session.order&#39;, &#39;stimulation&#39;. You can override using the `.groups` argument.
## `summarise()` has grouped output by &#39;subject&#39;, &#39;session.order&#39;, &#39;stimulation&#39;. You can override using the `.groups` argument.</code></pre>
<div id="plot" class="section level3">
<h3>Plot</h3>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1">plot_anodalVScathodal &lt;-<span class="st"> </span><span class="cf">function</span>(df) {</a>
<a class="sourceLine" id="cb39-2" data-line-number="2">  df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb39-3" data-line-number="3"><span class="st">    </span><span class="co"># create two columns of AB magnitude change score during tDCS: for anodal and cathodal</span></a>
<a class="sourceLine" id="cb39-4" data-line-number="4"><span class="st">    </span><span class="kw">filter</span>(measure <span class="op">==</span><span class="st"> &quot;AB.magnitude&quot;</span>, change <span class="op">==</span><span class="st"> &quot;tDCS - baseline&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb39-5" data-line-number="5"><span class="st">    </span><span class="kw">select</span>(<span class="op">-</span>baseline) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb39-6" data-line-number="6"><span class="st">    </span><span class="kw">spread</span>(stimulation, change.score) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb39-7" data-line-number="7"><span class="st">    </span></a>
<a class="sourceLine" id="cb39-8" data-line-number="8"><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(anodal, cathodal)) <span class="op">+</span></a>
<a class="sourceLine" id="cb39-9" data-line-number="9"><span class="st">    </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb39-10" data-line-number="10"><span class="st">    </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb39-11" data-line-number="11"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb39-12" data-line-number="12"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb39-13" data-line-number="13"><span class="st">    </span><span class="kw">geom_rug</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb39-14" data-line-number="14"><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;Effect of anodal tDCS (%)&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span>.<span class="dv">4</span>,.<span class="dv">4</span>), <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span>.<span class="dv">4</span>,.<span class="dv">4</span>,.<span class="dv">1</span>), <span class="dt">labels =</span> scales<span class="op">::</span><span class="kw">percent_format</span>(<span class="dt">accuracy =</span> <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb39-15" data-line-number="15"><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;Effect of cathodal tDCS (%)&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span>.<span class="dv">4</span>,.<span class="dv">4</span>), <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span>.<span class="dv">4</span>,.<span class="dv">4</span>,.<span class="dv">1</span>), <span class="dt">labels =</span> scales<span class="op">::</span><span class="kw">percent_format</span>(<span class="dt">accuracy =</span> <span class="dv">1</span>) ) <span class="op">+</span></a>
<a class="sourceLine" id="cb39-16" data-line-number="16"><span class="st">    </span><span class="kw">coord_equal</span>()</a>
<a class="sourceLine" id="cb39-17" data-line-number="17">}</a></code></pre></div>
<p>Recreate the scatter plot with data from both studies:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="kw">plot_anodalVScathodal</span>(ABmagChange_pooled) <span class="op">+</span></a>
<a class="sourceLine" id="cb40-2" data-line-number="2"><span class="st"> </span><span class="kw">aes</span>(<span class="dt">colour =</span> study)</a></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<div class="figure">
<img src="AB-tDCS_replication-analyses_files/figure-html/anodal%20vs.%20cathodal%20plot%20pooled-1.png" alt="Effect of anodal vs. effect of cathodal pooled across studies" width="576" />
<p class="caption">
Effect of anodal vs. effect of cathodal pooled across studies
</p>
</div>
<p>The negative correlation is larger in study 1, and the data points from study 1 have a bigger spread. But overall it doesn’t look very convincing still.</p>
</div>
<div id="statistics" class="section level3">
<h3>Statistics</h3>
<p>Partial correlation between anodal and cathodal AB magnitude change score (tDCS - baseline), attempting to adjust for session order:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1"><span class="kw">pcorr_anodal_cathodal</span>(<span class="kw">filter</span>(ABmagChange_pooled, change <span class="op">==</span><span class="st"> &quot;tDCS - baseline&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb42-2" data-line-number="2"><span class="kw">kable</span>(<span class="dt">digits =</span> <span class="dv">3</span>, <span class="dt">caption =</span> <span class="st">&quot;Pooled data from studies 1 and 2: Partial correlation anodal vs. cathodal&quot;</span>)</a></code></pre></div>
<table>
<caption>Pooled data from studies 1 and 2: Partial correlation anodal vs. cathodal</caption>
<thead>
<tr class="header">
<th align="left">change</th>
<th align="right">r</th>
<th align="right">tval</th>
<th align="right">df</th>
<th align="right">pvalue</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">tDCS - baseline</td>
<td align="right">-0.176</td>
<td align="right">-1.509</td>
<td align="right">71</td>
<td align="right">0.136</td>
</tr>
</tbody>
</table>
<p>Zero-order correlation:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1"><span class="kw">tidy</span>(<span class="kw">cor.test</span>(</a>
<a class="sourceLine" id="cb43-2" data-line-number="2">  <span class="kw">pull</span>(<span class="kw">filter</span>(ABmagChange_pooled, stimulation <span class="op">==</span><span class="st"> &quot;anodal&quot;</span>, measure <span class="op">==</span><span class="st"> &quot;AB.magnitude&quot;</span>, change <span class="op">==</span><span class="st"> &quot;tDCS - baseline&quot;</span>), change.score),</a>
<a class="sourceLine" id="cb43-3" data-line-number="3">  <span class="kw">pull</span>(<span class="kw">filter</span>(ABmagChange_pooled, stimulation <span class="op">==</span><span class="st"> &quot;cathodal&quot;</span>, measure <span class="op">==</span><span class="st"> &quot;AB.magnitude&quot;</span>, change <span class="op">==</span><span class="st"> &quot;tDCS - baseline&quot;</span>), change.score),</a>
<a class="sourceLine" id="cb43-4" data-line-number="4">  <span class="dt">method =</span> <span class="st">&quot;pearson&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb43-5" data-line-number="5"><span class="kw">kable</span>(., <span class="dt">digits =</span> <span class="dv">3</span>, <span class="dt">caption =</span> <span class="st">&quot;Pooled data from studies 1 and 2: Zero-order correlation anodal vs. cathodal&quot;</span>)</a></code></pre></div>
<table>
<caption>Pooled data from studies 1 and 2: Zero-order correlation anodal vs. cathodal</caption>
<colgroup>
<col width="8%" />
<col width="9%" />
<col width="7%" />
<col width="9%" />
<col width="8%" />
<col width="9%" />
<col width="35%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">estimate</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">parameter</th>
<th align="right">conf.low</th>
<th align="right">conf.high</th>
<th align="left">method</th>
<th align="left">alternative</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-0.158</td>
<td align="right">-1.354</td>
<td align="right">0.18</td>
<td align="right">72</td>
<td align="right">-0.373</td>
<td align="right">0.074</td>
<td align="left">Pearson’s product-moment correlation</td>
<td align="left">two.sided</td>
</tr>
</tbody>
</table>
<p>Bayes factor:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1"><span class="kw">extractBF</span>(<span class="kw">correlationBF</span>(</a>
<a class="sourceLine" id="cb44-2" data-line-number="2">  <span class="kw">pull</span>(<span class="kw">filter</span>(ABmagChange_pooled, stimulation <span class="op">==</span><span class="st"> &quot;anodal&quot;</span>, measure <span class="op">==</span><span class="st"> &quot;AB.magnitude&quot;</span>, change <span class="op">==</span><span class="st"> &quot;tDCS - baseline&quot;</span>), change.score),</a>
<a class="sourceLine" id="cb44-3" data-line-number="3">  <span class="kw">pull</span>(<span class="kw">filter</span>(ABmagChange_pooled, stimulation <span class="op">==</span><span class="st"> &quot;cathodal&quot;</span>, measure <span class="op">==</span><span class="st"> &quot;AB.magnitude&quot;</span>, change <span class="op">==</span><span class="st"> &quot;tDCS - baseline&quot;</span>), change.score))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb44-4" data-line-number="4"><span class="st">  </span><span class="kw">select</span>(bf) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># keep only the Bayes Factor</span></a>
<a class="sourceLine" id="cb44-5" data-line-number="5"><span class="st">  </span><span class="kw">kable</span>(<span class="dt">digits =</span> <span class="dv">3</span>, <span class="dt">caption =</span> <span class="st">&quot;Pooled data from studies 1 and 2: Bayesian correlation&quot;</span>)</a></code></pre></div>
<table>
<caption>Pooled data from studies 1 and 2: Bayesian correlation</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">bf</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Alt., r=0.333</td>
<td align="right">0.613</td>
</tr>
</tbody>
</table>
<p>Neither correlation is significant. The Bayes factor favors the null, but only slightly, and less so than in study 2.</p>
</div>
</div>
<div id="meta-analysis" class="section level2">
<h2>Meta-analysis</h2>
<p>For a more orthodox look on the pooled effect from both studies, let’s perform a meta-analysis of the correlation coefficients.</p>
<p>First, create a new data frame with all the information:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1">df_meta &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">authors =</span> <span class="kw">c</span>(<span class="st">&quot;London &amp; Slagter&quot;</span>,<span class="st">&quot;Reteig et al.&quot;</span>), <span class="dt">year =</span> <span class="kw">c</span>(<span class="dv">2021</span>,<span class="dv">2021</span>), </a>
<a class="sourceLine" id="cb45-2" data-line-number="2">                  <span class="dt">ni =</span> <span class="kw">c</span>(n_study1_pc, n_study2_pc), </a>
<a class="sourceLine" id="cb45-3" data-line-number="3">                  <span class="dt">ri =</span> <span class="kw">c</span>(r_study1, r_study2))</a>
<a class="sourceLine" id="cb45-4" data-line-number="4"><span class="kw">kable</span>(df_meta)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">authors</th>
<th align="right">year</th>
<th align="right">ni</th>
<th align="right">ri</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">London &amp; Slagter</td>
<td align="right">2021</td>
<td align="right">33</td>
<td align="right">-0.4453648</td>
</tr>
<tr class="even">
<td align="left">Reteig et al.</td>
<td align="right">2021</td>
<td align="right">39</td>
<td align="right">0.0209995</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>ni</strong> is the sample size in each study</li>
<li><strong>ri</strong> is the correlation coefficient (Pearson’s <em>r</em>)</li>
</ul>
<p>We’ll specify the meta-analysis as a fixed effects model, as both studies were highly similar and from the same population (same lab, same university student sample). This does mean our inferences are limited to this particular set of two studies, but that’s also what we want to know in this case (“how large is the effect when we pool both studies”), not necessarily “how large is the true effect in the population” (which would be a random-effects meta-analysis).</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1">res &lt;-<span class="st"> </span><span class="kw">rma</span>(<span class="dt">ri =</span> ri, <span class="dt">ni =</span> ni, <span class="dt">data =</span> df_meta, </a>
<a class="sourceLine" id="cb46-2" data-line-number="2">           <span class="dt">measure =</span> <span class="st">&quot;ZCOR&quot;</span>, <span class="dt">method =</span> <span class="st">&quot;FE&quot;</span>, <span class="co"># Fisher-z tranform of r values, fixed effects method</span></a>
<a class="sourceLine" id="cb46-3" data-line-number="3">           <span class="dt">slab =</span> <span class="kw">paste</span>(authors, year, <span class="dt">sep =</span> <span class="st">&quot;, &quot;</span>)) <span class="co"># add study info to &quot;res&quot; list</span></a>
<a class="sourceLine" id="cb46-4" data-line-number="4">res</a></code></pre></div>
<pre>## 
## Fixed-Effects Model (k = 2)
## 
## I^2 (total heterogeneity / total variability):   75.55%
## H^2 (total variability / sampling variability):  4.09
## 
## Test for Heterogeneity:
## Q(df = 1) = 4.0894, p-val = 0.0432
## 
## Model Results:
## 
## estimate      se     zval    pval    ci.lb   ci.ub 
##  -0.2062  0.1231  -1.6754  0.0939  -0.4475  0.0350  . 
## 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
</pre>
<p>The overall effect is not significant: <em>p</em> = 0.094.</p>
<p>The effect size and confidence intervals printed above are <em>z</em>-values, as the meta-analysis was performed on Fisher’s <em>r</em>-to-<em>z</em> transformed correlation coefficients. Now we transform them back to <em>r</em>-values:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1"><span class="kw">kable</span>(<span class="kw">predict</span>(res, <span class="dt">transf =</span> transf.ztor))</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">pred</th>
<th align="right">ci.lb</th>
<th align="right">ci.ub</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"></td>
<td align="right">-0.2033526</td>
<td align="right">-0.4198272</td>
<td align="right">0.0350132</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>pred</strong> is the correlation coefficient <em>r</em></li>
<li><strong>ci.lb</strong> and <strong>ci.ub</strong> are the upper and lower bounds of the confidence interval around <em>r</em></li>
</ul>
<p>We can also visualize all of this in a forest plot:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1"><span class="kw">forest</span>(res, <span class="dt">transf =</span> transf.ztor)</a></code></pre></div>
<div class="figure">
<img src="AB-tDCS_replication-analyses_files/figure-html/forest%20plot-1.png" alt="Fixed-effects meta-analysis of the anodal vs. cathodal correlation in study 1 and 2" width="576" />
<p class="caption">
Fixed-effects meta-analysis of the anodal vs. cathodal correlation in study 1 and 2
</p>
</div>
<p>This shows the r-values (squares) and CIs (error bars) of the individual studies, as well as the meta-analytic effect size (middle of the diamond) and CI (ends of the diamond). The CIs of the meta-analytic effect just overlap zero, so the overall effect is not significant.</p>
</div>
<div id="prediction-intervals" class="section level2">
<h2>Prediction intervals</h2>
<p>To evaluate whether the result observed in study 2 is consistent with study 1, we can construct a <em>prediction interval</em>. A prediction interval contains the range of correlation coefficients we can expect to see in study 2, based on the original correlation in study 1, and the sample sizes of both study 1 and 2.</p>
<p>If the original study were replicated 100 times, 95 of the observed correlation coefficients would fall within the 95% prediction interval. Note that this is different from a <em>confidence interval</em>, which quantifies uncertainty about the (unknown) true correlation in the population (95 out of every hundred 95% CIs contain the true population parameter).</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1"><span class="kw">pi.r</span>(<span class="dt">r =</span> r_study1, <span class="dt">n =</span> n_study1_pc, <span class="dt">rep.n =</span> n_study2_pc)</a></code></pre></div>
<pre>## 
## Original study: r = -0.45, N = 33, 95% CI[-0.68, -0.12]
## Replication study: N = 39
## Prediction interval: 95% PI[-0.82,-0.05].
## 
## 
## Interpretation:
## The original correlation is -0.45 - with a prediction interval 95% PI[-0.82, -0.05] based a replication sample size of N = 39. If the replication correlation differs from the original correlation only due to sampling error, there is a 95% chance the replication result will fall in this interval. If the replication correlation falls outside of this range, factors beyond sampling error are likely also responsible for the difference.
</pre>
<p>The observed correlation in study 2 (<em>r</em> = 0.02) falls outside the 95% PI. Therefore, the results of study 2 are not consistent with study 1, so we could conclude that study 2 was a succesful replication.</p>
<p>However, the 95% PI is so wide that almost any negative correlation of a realistic size would fall inside it. So above all it illustrates that we cannot draw strong conclusions based on the results of either study.</p>
</div>
<div id="bayes-factors-with-informed-priors" class="section level2">
<h2>Bayes Factors with informed priors</h2>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1">bf_study2 &lt;-<span class="st"> </span><span class="kw">extractBF</span>(<span class="kw">correlationBF</span>(</a>
<a class="sourceLine" id="cb50-2" data-line-number="2">  <span class="kw">pull</span>(<span class="kw">filter</span>(ABmagChange_study2, stimulation <span class="op">==</span><span class="st"> &quot;anodal&quot;</span>, measure <span class="op">==</span><span class="st"> &quot;AB.magnitude&quot;</span>, change <span class="op">==</span><span class="st"> &quot;tDCS - baseline&quot;</span>), change.score),</a>
<a class="sourceLine" id="cb50-3" data-line-number="3">  <span class="kw">pull</span>(<span class="kw">filter</span>(ABmagChange_study2, stimulation <span class="op">==</span><span class="st"> &quot;cathodal&quot;</span>, measure <span class="op">==</span><span class="st"> &quot;AB.magnitude&quot;</span>, change <span class="op">==</span><span class="st"> &quot;tDCS - baseline&quot;</span>), change.score))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb50-4" data-line-number="4"><span class="st">  </span><span class="kw">select</span>(bf) <span class="co"># keep only the Bayes Factor</span></a>
<a class="sourceLine" id="cb50-5" data-line-number="5"></a>
<a class="sourceLine" id="cb50-6" data-line-number="6">  <span class="kw">kable</span>(bf_study2)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">bf</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Alt., r=0.333</td>
<td align="right">0.3969199</td>
</tr>
</tbody>
</table>
<div id="one-sided" class="section level3">
<h3>One-sided</h3>
<p>The default Bayes Factor uses a prior that assigns equal weight to positive and negative effect sizes (correlation coefficients in our case). However, we can also “fold” all the prior mass to one side, thereby effectively testing a directional hypothesis.</p>
<p>In our case, based on study 1, we expect a negative correlation, so we evaluate the prior only over negative effect sizes (<code>-1</code> to <code>0</code>)</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1">bf_one_sided &lt;-<span class="st"> </span><span class="kw">extractBF</span>(<span class="kw">correlationBF</span>(</a>
<a class="sourceLine" id="cb51-2" data-line-number="2">  <span class="kw">pull</span>(<span class="kw">filter</span>(ABmagChange_study2, stimulation <span class="op">==</span><span class="st"> &quot;anodal&quot;</span>, measure <span class="op">==</span><span class="st"> &quot;AB.magnitude&quot;</span>, change <span class="op">==</span><span class="st"> &quot;tDCS - baseline&quot;</span>), change.score),</a>
<a class="sourceLine" id="cb51-3" data-line-number="3">  <span class="kw">pull</span>(<span class="kw">filter</span>(ABmagChange_study2, stimulation <span class="op">==</span><span class="st"> &quot;cathodal&quot;</span>, measure <span class="op">==</span><span class="st"> &quot;AB.magnitude&quot;</span>, change <span class="op">==</span><span class="st"> &quot;tDCS - baseline&quot;</span>), change.score),</a>
<a class="sourceLine" id="cb51-4" data-line-number="4">  <span class="dt">nullInterval =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">0</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb51-5" data-line-number="5"><span class="st">  </span><span class="kw">select</span>(bf) <span class="co"># keep only the Bayes Factor</span></a>
<a class="sourceLine" id="cb51-6" data-line-number="6"></a>
<a class="sourceLine" id="cb51-7" data-line-number="7">  <span class="kw">kable</span>(bf_one_sided)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">bf</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Alt., r=0.333 -1&lt;rho&lt;0</td>
<td align="right">0.5446767</td>
</tr>
<tr class="even">
<td align="left">Alt., r=0.333 !(-1&lt;rho&lt;0)</td>
<td align="right">0.2491474</td>
</tr>
</tbody>
</table>
<p>This Bayes Factor still provides more evidence for the null than for the alternative, but does provide less evidence for the null (BF<sub>01</sub> = 1 / 0.54 = 1.84) than the regular Bayes Factor (BF<sub>01</sub> = 1 / 0.4 = 2.52)</p>
</div>
<div id="replication-bayes-factor" class="section level3">
<h3>“Replication Bayes Factor”</h3>
<p>While a default Bayes factor adresses the question (“Is there more evidence that the effect is absent (H<sub>0</sub>) vs. present (H<sub>1</sub>), this Bayes factors adresses the question (”Is there more evidence that the effect is absent (the “skeptic’s hypothesis”) vs. similar to what was found before ( the “proponent’s hypothesis”). The “replication Bayes factor” adresses this latter question by using the posterior of study 1 as a prior in the analysis of study 2, i.e. as the proponent’s hypothesis.</p>
<p>This Bayes factor was proposed by Wagenmakers, Verhagen &amp; Ly (2016)<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> and is computed using <a href="https://osf.io/9d4ip/">their provided code</a>. Note that it does not “directly” compute a Bayesian correlation, but uses the effect sizes (partial correlations) from both studies.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1">bf0RStudy1 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="kw">repBfR0</span>(<span class="dt">nOri =</span> n_study1_pc, <span class="dt">rOri =</span> r_study1,</a>
<a class="sourceLine" id="cb52-2" data-line-number="2">                        <span class="dt">nRep =</span> n_study2_pc, <span class="dt">rRep =</span> r_study2)</a>
<a class="sourceLine" id="cb52-3" data-line-number="3">bf0RStudy1</a></code></pre></div>
<pre>## [1] 9.657519
</pre>
<p>This BF expresses that the data are 9.66 times more likely under the skeptic’s hypothesis, than under the proponent’s hypothesis.</p>
</div>
</div>
<div id="equivalence-tests" class="section level2 tabset tabset-fade tabset-pills">
<h2>Equivalence tests</h2>
<p>Equivalence tests allow you to test for the <em>absence</em> of an effect of a specific size. Usually this is the smallest effect size of interest (the SESOI). We’ll use three different specifications of the SESOI.</p>
<div id="small-telescopes" class="section level3">
<h3>Small telescopes</h3>
<p>The “Small Telescopes” approach (Simonsohn, 2015)<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a> suggests that the SESOI should be the effect size the original study had 33% power to detect, the idea being that anything smaller than that could not have been properly investigated in the original study in the first place (as the odds were already stacked 2:1 against finding the effect).</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" data-line-number="1">small_telescopes &lt;-<span class="st"> </span><span class="kw">pwr.r.test</span>(n_study1_pc, <span class="dt">power =</span> <span class="fl">0.33</span>) <span class="co"># r value with 33% power in study 1</span></a>
<a class="sourceLine" id="cb53-2" data-line-number="2"><span class="kw">TOSTr</span>(<span class="dt">n =</span> n_study2_pc, <span class="dt">r =</span> r_study2, </a>
<a class="sourceLine" id="cb53-3" data-line-number="3">      <span class="dt">high_eqbound_r =</span> small_telescopes<span class="op">$</span>r, </a>
<a class="sourceLine" id="cb53-4" data-line-number="4">      <span class="dt">low_eqbound_r =</span> <span class="op">-</span>small_telescopes<span class="op">$</span>r, <span class="dt">alpha =</span> <span class="fl">0.05</span>) <span class="co"># equivalence test</span></a></code></pre></div>
<pre>## TOST results:
## p-value lower bound: 0.038
## p-value upper bound: 0.065
## 
## Equivalence bounds (r):
## low eqbound: -0.2673 
## high eqbound: 0.2673
## 
## TOST confidence interval:
## lower bound 90% CI: -0.248
## upper bound 90% CI:  0.287
## 
## NHST confidence interval:
## lower bound 95% CI: -0.296
## upper bound 95% CI:  0.334
## 
## Equivalence Test Result:
## The equivalence test was non-significant, p = 0.0645, given equivalence bounds of -0.267 and 0.267 and an alpha of 0.05.
</pre>
<pre><code>## </code></pre>
<pre>## 
## Null Hypothesis Test Result:
## The null hypothesis test was non-significant, p = 0.899, given an alpha of 0.05.
</pre>
<pre><code>## </code></pre>
<pre>## 
## Based on the equivalence test and the null-hypothesis test combined, we can conclude that the observed effect is statistically not different from zero and statistically not equivalent to zero.
</pre>
<pre><code>## </code></pre>
<div class="figure">
<img src="AB-tDCS_replication-analyses_files/figure-html/small%20telescopes%20test-1.png" alt="test for equivalence to 33% power effect size" width="576" />
<p class="caption">
test for equivalence to 33% power effect size
</p>
</div>
<p>The overall equivalence test is not significant, so we cannot conclude that the effect is smaller than the SESOI. However, given the original study found a negative effect, it makes sense to only look at the lower equivalence bound. The results of this <em>inferiority</em> test is in fact significant, so we can reject the hypothesis that the effect size is at least that negative.</p>
</div>
<div id="critical-effect-size" class="section level3">
<h3>Critical effect size</h3>
<p>Others (e.g. in the paper accompanying the R package for equivalence test, by Lakens et al. (2018)<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a>) argue that a more appropriate SESOI would be the smallest effect size that would still be significant in the original study. This usually corresponds to the effect size the study had 50% power to detect.</p>
<p>First we derive the critical r-value for the original sample size (function below from <a href="https://www.researchgate.net/post/What_is_the_formula_to_calculate_the_critical_value_of_correlation" class="uri">https://www.researchgate.net/post/What_is_the_formula_to_calculate_the_critical_value_of_correlation</a>).</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" data-line-number="1">critical.r &lt;-<span class="st"> </span><span class="cf">function</span>(n, <span class="dt">alpha =</span> <span class="fl">.05</span> ) {</a>
<a class="sourceLine" id="cb57-2" data-line-number="2">    df &lt;-<span class="st"> </span>n <span class="op">-</span><span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb57-3" data-line-number="3">    critical.t &lt;-<span class="st"> </span><span class="kw">qt</span>( alpha<span class="op">/</span><span class="dv">2</span>, df, <span class="dt">lower.tail =</span> F )</a>
<a class="sourceLine" id="cb57-4" data-line-number="4">    critical.r &lt;-<span class="st"> </span><span class="kw">sqrt</span>( (critical.t<span class="op">^</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span>( (critical.t<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>df ) )</a>
<a class="sourceLine" id="cb57-5" data-line-number="5">    <span class="kw">return</span>( critical.r )</a>
<a class="sourceLine" id="cb57-6" data-line-number="6">}</a>
<a class="sourceLine" id="cb57-7" data-line-number="7"><span class="kw">critical.r</span>(n_study1_pc)</a></code></pre></div>
<pre>## [1] 0.3439573
</pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" data-line-number="1"><span class="kw">TOSTr</span>(<span class="dt">n =</span> n_study2_pc, <span class="dt">r =</span> r_study2, </a>
<a class="sourceLine" id="cb58-2" data-line-number="2">      <span class="dt">high_eqbound_r =</span> <span class="kw">critical.r</span>(n_study1_pc), </a>
<a class="sourceLine" id="cb58-3" data-line-number="3">      <span class="dt">low_eqbound_r =</span> <span class="op">-</span><span class="kw">critical.r</span>(n_study1_pc), </a>
<a class="sourceLine" id="cb58-4" data-line-number="4">      <span class="dt">alpha =</span> <span class="fl">0.05</span>)</a></code></pre></div>
<pre>## TOST results:
## p-value lower bound: 0.011
## p-value upper bound: 0.021
## 
## Equivalence bounds (r):
## low eqbound: -0.344 
## high eqbound: 0.344
## 
## TOST confidence interval:
## lower bound 90% CI: -0.248
## upper bound 90% CI:  0.287
## 
## NHST confidence interval:
## lower bound 95% CI: -0.296
## upper bound 95% CI:  0.334
## 
## Equivalence Test Result:
## The equivalence test was significant, p = 0.0214, given equivalence bounds of -0.344 and 0.344 and an alpha of 0.05.
</pre>
<pre><code>## </code></pre>
<pre>## 
## Null Hypothesis Test Result:
## The null hypothesis test was non-significant, p = 0.899, given an alpha of 0.05.
</pre>
<pre><code>## </code></pre>
<pre>## 
## Based on the equivalence test and the null-hypothesis test combined, we can conclude that the observed effect is statistically not different from zero and statistically equivalent to zero.
</pre>
<pre><code>## </code></pre>
<div class="figure">
<img src="AB-tDCS_replication-analyses_files/figure-html/critical%20r%20test-1.png" alt="test for equivalence to critical effect size" width="576" />
<p class="caption">
test for equivalence to critical effect size
</p>
</div>
<p>When we specify the SESOI like this, the CIs do fall within both equivalence bounds.</p>
</div>
<div id="original-effect-size" class="section level3">
<h3>Original effect size</h3>
<p>Finally, we can also take the original effect size as the SESOI.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" data-line-number="1"><span class="kw">TOSTr</span>(<span class="dt">n =</span> n_study2_pc, <span class="dt">r =</span> r_study2, <span class="dt">high_eqbound_r =</span>  <span class="op">-</span>r_study1, <span class="dt">low_eqbound_r =</span> r_study1, <span class="dt">alpha =</span> <span class="fl">0.05</span>)</a></code></pre></div>
<pre>## TOST results:
## p-value lower bound: 0.001
## p-value upper bound: 0.003
## 
## Equivalence bounds (r):
## low eqbound: -0.4454 
## high eqbound: 0.4454
## 
## TOST confidence interval:
## lower bound 90% CI: -0.248
## upper bound 90% CI:  0.287
## 
## NHST confidence interval:
## lower bound 95% CI: -0.296
## upper bound 95% CI:  0.334
## 
## Equivalence Test Result:
## The equivalence test was significant, p = 0.003, given equivalence bounds of -0.445 and 0.445 and an alpha of 0.05.
</pre>
<pre><code>## </code></pre>
<pre>## 
## Null Hypothesis Test Result:
## The null hypothesis test was non-significant, p = 0.899, given an alpha of 0.05.
</pre>
<pre><code>## </code></pre>
<pre>## 
## Based on the equivalence test and the null-hypothesis test combined, we can conclude that the observed effect is statistically not different from zero and statistically equivalent to zero.
</pre>
<pre><code>## </code></pre>
<div class="figure">
<img src="AB-tDCS_replication-analyses_files/figure-html/original%20effect%20size-1.png" alt="test for equivalence to original effect size" width="576" />
<p class="caption">
test for equivalence to original effect size
</p>
</div>
<p>This is the least stringent criterion, so naturally this test is also significant, meaning that based on study 2 we can reject the presence of a correlation at least as large as in study 1.</p>
<p>However, given that the original correlation was not very precisely estimated (the confidence intervals were very wide), this is not really a reasonable SESOI.</p>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>London, R. E., &amp; Slagter, H. A. (2021). No Effect of Transcranial Direct Current Stimulation over Left Dorsolateral Prefrontal Cortex on Temporal Attention. <em>Journal of Cognitive Neuroscience, 33(4)</em>, 756–768. doi: <a href="https://doi.org/10.1162/jocn_a_01679">10.1162/jocn_a_01679</a><a href="#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p>Wagenmakers, E. J., Verhagen, J., &amp; Ly, A. (2016). How to quantify the evidence for the absence of a correlation. <em>Behavior Research Methods, 48(2)</em>, 413-426. doi: <a href="https://doi.org/10.3758/s13428-015-0593-0">10.3758/s13428-015-0593-0</a><a href="#fnref2" class="footnote-back">↩</a></p></li>
<li id="fn3"><p>Simonsohn, U. (2015). Small telescopes: Detectability and the evaluation of replication results. <em>Psychological Science, 26(5),</em>, 1–11. doi: <a href="https://doi.org/10.1177/0956797614567341">10.1177/0956797614567341</a><a href="#fnref3" class="footnote-back">↩</a></p></li>
<li id="fn4"><p>Lakens, D., Scheel, A. M., &amp; Isager, P. M. (2018). Equivalence Testing for Psychological Research: A Tutorial. <em>Advances in Methods and Practices in Psychological Science, 1(2)</em>, 259–269. doi: <a href="http://doi.org/10.1177/2515245918770963">10.1177/2515245918770963</a><a href="#fnref4" class="footnote-back">↩</a></p></li>
</ol>
</div>
</div>

   
   
      </div>
   <div class="col-md-2">
          <div id="toc">
       <button type="button" class="close">×</button>
       <ul>
       <li><a href="#setup-environment">Setup environment</a></li>
       <li><a href="#load-task-data">Load task data</a><ul>
       <li><a href="#study-2">Study 2</a></li>
       <li><a href="#study-1">Study 1</a></li>
       </ul></li>
       <li><a href="#replication-analyses">Replication analyses</a><ul>
       <li><a href="#pool-study-1-and-2">Pool study 1 and 2</a></li>
       <li><a href="#meta-analysis">Meta-analysis</a></li>
       <li><a href="#prediction-intervals">Prediction intervals</a></li>
       <li><a href="#bayes-factors-with-informed-priors">Bayes Factors with informed priors</a></li>
       <li><a href="#equivalence-tests">Equivalence tests</a></li>
       </ul></li>
       </ul>
     </div>
        </div>
   </div>
   </div>
            
      

  <script>
    $(document).ready(function () {

		// add bootstrap table styles to pandoc tables
	$('tr.header').parent('thead').parent('table').addClass('table table-condensed');
		
 	 	$('#content img').addClass("image-thumb");
		
		$('#content img').addClass("image-lb");
	$('#content').magnificPopup({
	    type:'image',
	    closeOnContentClick: false,
	    closeBtnInside: false,
	    delegate: '.image-lb',
	    gallery: {enabled: true },
	    image: {
	        verticalFit: true,
		titleSrc: 'alt'
	    }
 	});
 	    });
  </script>



    <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
	var script = document.createElement("script");
	script.type = "text/javascript";
	script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
	document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>
  
</body>
</html>
