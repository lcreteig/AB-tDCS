<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="Leon Reteig" />


<title>AB-tDCS</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.6/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.6/js/bootstrap.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
<script src="site_libs/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
<link href="site_libs/clean-0.1/clean.css" rel="stylesheet" />
<script src="site_libs/clean-0.1/clean.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<br>
<br>
<br>
&nbsp;
<p style="text-align: center;"><a href="https://lcreteig.github.io/AB-tDCS">Project website</a></p>
<p style="text-align: center;"> Data and other resources: <a href="https://osf.io/y6hsf/">Open Science Framework</a></p>
<p style="text-align: center;"> Source code: <a href="https://github.com/lcreteig/AB-tDCS">Github</a></p>
&nbsp;
<hr />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>



<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
</style>
<div class="container-fluid main-container">
  <div class="row">
     <div class="col-md-10">



<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-info"></span>
     
    About
  </a>
</li>
<li>
  <a href="AB-tDCS_paper.html">
    <span class="fa fa-newspaper"></span>
     
    Paper
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-file-code"></span>
     
    Analyses
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Individual differences</li>
    <li>
      <a href="AB-tDCS_change-from-baseline.html">Change from baseline</a>
    </li>
    <li>
      <a href="AB-tDCS_anodal-vs-cathodal.html">Anodal vs. cathodal</a>
    </li>
    <li>
      <a href="AB-tDCS_replication-analyses.html">Replication analyses</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Group-level</li>
    <li>
      <a href="AB-tDCS_group.html">Task</a>
    </li>
    <li>
      <a href="AB-tDCS_questionnaires.html">Questionnaires</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/lcreteig/AB-tDCS">
    <span class="fa fa-github"></span>
     
    Source
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->


<div id="header">
<h1 class="title">AB-tDCS</h1>
<h1 class="subtitle">Questionnaires</h1>
<h4 class="author"><em>Leon Reteig</em></h4>
<h4 class="date"><em>26 March, 2019</em></h4>
</div>

<div id="content">
<div id="setup-environment" class="section level1">
<h1>Setup environment</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># Load packages</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(tidyverse)  <span class="co"># importing, transforming, and visualizing data frames</span></a></code></pre></div>
<pre><code>## ── Attaching packages ────────────────────────────────────────────────────────────────────────────────────────────── tidyverse 1.2.1 ──</code></pre>
<pre><code>## ✔ ggplot2 3.1.0     ✔ purrr   0.2.5
## ✔ tibble  1.4.2     ✔ dplyr   0.7.8
## ✔ tidyr   0.8.2     ✔ stringr 1.3.1
## ✔ readr   1.1.1     ✔ forcats 0.3.0</code></pre>
<pre><code>## ── Conflicts ───────────────────────────────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">library</span>(here) <span class="co"># (relative) file paths</span></a></code></pre></div>
<pre><code>## here() starts at /Volumes/psychology$/Researchers/reteig/AB_tDCS-EEG</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">library</span>(knitr) <span class="co"># R notebook output</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw">library</span>(broom) <span class="co"># transform model outputs into data frames</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="kw">library</span>(knitrhooks) <span class="co"># printing in rmarkdown outputs</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4">  <span class="kw">output_max_height</span>()</a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co"># Source functions</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="kw">source</span>(<span class="kw">here</span>(<span class="st">&quot;src&quot;</span>, <span class="st">&quot;func&quot;</span>, <span class="st">&quot;behavioral_analysis.R&quot;</span>)) <span class="co"># loading data and calculating measures</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7">knitr<span class="op">::</span><span class="kw">read_chunk</span>(<span class="kw">here</span>(<span class="st">&quot;src&quot;</span>, <span class="st">&quot;func&quot;</span>, <span class="st">&quot;behavioral_analysis.R&quot;</span>)) <span class="co"># display code from file in this</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8">load_data_path &lt;-<span class="st"> </span><span class="kw">here</span>(<span class="st">&quot;src&quot;</span>,<span class="st">&quot;func&quot;</span>,<span class="st">&quot;load_data.Rmd&quot;</span>) <span class="co"># for rerunning and displayingnotebook</span></a></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw">print</span>(<span class="kw">sessionInfo</span>())</a></code></pre></div>
<pre style = "max-height:300px; overflow-y: auto;">## R version 3.5.1 (2018-07-02)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: OS X El Capitan 10.11.6
## 
## Matrix products: default
## BLAS: /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] knitrhooks_0.0.4 broom_0.5.1      knitr_1.21       here_0.1        
##  [5] forcats_0.3.0    stringr_1.3.1    dplyr_0.7.8      purrr_0.2.5     
##  [9] readr_1.1.1      tidyr_0.8.2      tibble_1.4.2     ggplot2_3.1.0   
## [13] tidyverse_1.2.1 
## 
## loaded via a namespace (and not attached):
##  [1] tidyselect_0.2.5 xfun_0.4         haven_1.1.2      lattice_0.20-35 
##  [5] colorspace_1.3-2 generics_0.0.2   miniUI_0.1.1.1   htmltools_0.3.6 
##  [9] yaml_2.2.0       rlang_0.3.0.1    later_0.7.5      pillar_1.3.1    
## [13] withr_2.1.2      glue_1.3.0       readxl_1.1.0     modelr_0.1.2    
## [17] bindrcpp_0.2.2   bindr_0.1.1      questionr_0.6.3  plyr_1.8.4      
## [21] cellranger_1.1.0 munsell_0.5.0    gtable_0.2.0     rvest_0.3.2     
## [25] evaluate_0.12    rmdformats_0.3.3 httpuv_1.4.5     highr_0.7       
## [29] Rcpp_1.0.0       xtable_1.8-3     promises_1.0.1   backports_1.1.3 
## [33] scales_1.0.0     jsonlite_1.6     mime_0.6         hms_0.4.2       
## [37] digest_0.6.18    stringi_1.2.4    bookdown_0.9     shiny_1.2.0     
## [41] rprojroot_1.3-2  grid_3.5.1       cli_1.0.1        tools_3.5.1     
## [45] magrittr_1.5     lazyeval_0.2.1   crayon_1.3.4     pkgconfig_2.0.2 
## [49] xml2_1.2.0       lubridate_1.7.4  assertthat_0.2.0 rmarkdown_1.11  
## [53] httr_1.3.1       rstudioapi_0.8   R6_2.3.0         nlme_3.1-137    
## [57] compiler_3.5.1
</pre>
</div>
<div id="load-task-data" class="section level1">
<h1>Load task data</h1>
<div id="study-2" class="section level2">
<h2>Study 2</h2>
<p>The following participants are excluded from further analysis at this point, because of incomplete data:</p>
<ul>
<li><code>S03</code>, <code>S14</code>, <code>S29</code>, <code>S38</code>, <code>S43</code>, <code>S46</code>: their T1 performance in session 1 was less than 63% correct, so they were not invited back. This cutoff was determined based on a separate pilot study with 10 participants. It is two standard deviations below the mean of that sample.</li>
<li><code>S25</code> has no data for session 2, as they stopped responding to requests for scheduling the session</li>
<li><code>S31</code> was excluded as a precaution after session 1, as they developed a severe headache and we could not rule out the possibility this was related to the tDCS</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">dataDir_study2 &lt;-<span class="st"> </span><span class="kw">here</span>(<span class="st">&quot;data&quot;</span>) <span class="co"># root folder with AB task data</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2">subs_incomplete &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;S03&quot;</span>, <span class="st">&quot;S14&quot;</span>, <span class="st">&quot;S25&quot;</span>, <span class="st">&quot;S29&quot;</span>, <span class="st">&quot;S31&quot;</span>, <span class="st">&quot;S38&quot;</span>, <span class="st">&quot;S43&quot;</span>, <span class="st">&quot;S46&quot;</span>) <span class="co"># don&#39;t try to load data from these participants</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3">df_study2 &lt;-<span class="st"> </span><span class="kw">load_data_study2</span>(dataDir_study2, subs_incomplete) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="st">  </span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># discard rows with data from incomplete subjects</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="st">   </span><span class="co"># recode first.session (&quot;anodal&quot; or &quot;cathodal&quot;) to session.order (&quot;anodal first&quot;, &quot;cathodal first&quot;)</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">first.session =</span> <span class="kw">parse_factor</span>(<span class="kw">paste</span>(first.session, <span class="st">&quot;first&quot;</span>), </a>
<a class="sourceLine" id="cb9-7" data-line-number="7">                                      <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;anodal first&quot;</span>, <span class="st">&quot;cathodal first&quot;</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">session.order =</span> first.session)</a>
<a class="sourceLine" id="cb9-9" data-line-number="9">n_study2 &lt;-<span class="st"> </span><span class="kw">n_distinct</span>(df_study2<span class="op">$</span>subject) <span class="co"># number of subjects in study 2</span></a></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">kable</span>(<span class="kw">head</span>(df_study2,<span class="dv">13</span>), <span class="dt">digits =</span> <span class="dv">1</span>, <span class="dt">caption =</span> <span class="st">&quot;Data frame for study 2&quot;</span>)</a></code></pre></div>
<table>
<caption>Data frame for study 2</caption>
<thead>
<tr class="header">
<th align="left">subject</th>
<th align="left">session.order</th>
<th align="left">stimulation</th>
<th align="left">block</th>
<th align="left">lag</th>
<th align="right">trials</th>
<th align="right">T1</th>
<th align="right">T2</th>
<th align="right">T2.given.T1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">anodal</td>
<td align="left">pre</td>
<td align="left">3</td>
<td align="right">118</td>
<td align="right">0.8</td>
<td align="right">0.4</td>
<td align="right">0.4</td>
</tr>
<tr class="even">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">anodal</td>
<td align="left">pre</td>
<td align="left">8</td>
<td align="right">60</td>
<td align="right">0.8</td>
<td align="right">0.8</td>
<td align="right">0.8</td>
</tr>
<tr class="odd">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">anodal</td>
<td align="left">tDCS</td>
<td align="left">3</td>
<td align="right">126</td>
<td align="right">0.8</td>
<td align="right">0.3</td>
<td align="right">0.3</td>
</tr>
<tr class="even">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">anodal</td>
<td align="left">tDCS</td>
<td align="left">8</td>
<td align="right">65</td>
<td align="right">0.8</td>
<td align="right">0.7</td>
<td align="right">0.7</td>
</tr>
<tr class="odd">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">anodal</td>
<td align="left">post</td>
<td align="left">3</td>
<td align="right">122</td>
<td align="right">0.8</td>
<td align="right">0.2</td>
<td align="right">0.3</td>
</tr>
<tr class="even">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">anodal</td>
<td align="left">post</td>
<td align="left">8</td>
<td align="right">61</td>
<td align="right">0.7</td>
<td align="right">0.7</td>
<td align="right">0.7</td>
</tr>
<tr class="odd">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">cathodal</td>
<td align="left">pre</td>
<td align="left">3</td>
<td align="right">116</td>
<td align="right">0.8</td>
<td align="right">0.4</td>
<td align="right">0.4</td>
</tr>
<tr class="even">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">cathodal</td>
<td align="left">pre</td>
<td align="left">8</td>
<td align="right">60</td>
<td align="right">0.7</td>
<td align="right">0.8</td>
<td align="right">0.8</td>
</tr>
<tr class="odd">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">cathodal</td>
<td align="left">tDCS</td>
<td align="left">3</td>
<td align="right">129</td>
<td align="right">0.7</td>
<td align="right">0.4</td>
<td align="right">0.4</td>
</tr>
<tr class="even">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">cathodal</td>
<td align="left">tDCS</td>
<td align="left">8</td>
<td align="right">64</td>
<td align="right">0.7</td>
<td align="right">0.8</td>
<td align="right">0.9</td>
</tr>
<tr class="odd">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">cathodal</td>
<td align="left">post</td>
<td align="left">3</td>
<td align="right">128</td>
<td align="right">0.6</td>
<td align="right">0.4</td>
<td align="right">0.4</td>
</tr>
<tr class="even">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">cathodal</td>
<td align="left">post</td>
<td align="left">8</td>
<td align="right">62</td>
<td align="right">0.7</td>
<td align="right">0.8</td>
<td align="right">0.8</td>
</tr>
<tr class="odd">
<td align="left">S02</td>
<td align="left">cathodal first</td>
<td align="left">anodal</td>
<td align="left">pre</td>
<td align="left">3</td>
<td align="right">124</td>
<td align="right">1.0</td>
<td align="right">0.8</td>
<td align="right">0.8</td>
</tr>
</tbody>
</table>
<p>The data has the following columns:</p>
<ul>
<li><strong>subject</strong>: Participant ID, e.g. <code>S01</code>, <code>S12</code></li>
<li><strong>session.order</strong>: Whether participant received <code>anodal</code> or <code>cathodal</code> tDCS in the first session (<code>anodal_first</code> vs. <code>cathodal_first</code>).</li>
<li><strong>stimulation</strong>: Whether participant received <code>anodal</code> or <code>cathodal</code> tDCS</li>
<li><strong>block</strong>: Whether data is before (<code>pre), during (</code>tDCS<code>) or after (</code>post`) tDCS</li>
<li><strong>lag</strong>: Whether T2 followed T1 after two distractors (lag <code>3</code>) or after 7 distractors (lag <code>8</code>)</li>
<li><strong>trials</strong>: Number of trials per lag that the participant completed in this block</li>
<li><strong>T1</strong>: Proportion of trials (out of <code>trials</code>) in which T1 was identified correctly</li>
<li><strong>T2</strong>: Proportion of trials (out of <code>trials</code>) in which T2 was identified correctly</li>
<li><strong>T2.given.T1</strong>: Proportion of trials which T2 was identified correctly, out of the trials in which T1 was idenitified correctly (T2|T1).</li>
</ul>
<p>The number of trials vary from person-to-person, as some completed more trials in a 20-minute block than others (because responses were self-paced):</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">df_study2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(lag) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="st">  </span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(trials), <span class="kw">funs</span>(mean, min, max, sd)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="st">  </span><span class="kw">kable</span>(<span class="dt">caption =</span> <span class="st">&quot;Descriptive statistics for trial counts per lag&quot;</span>, <span class="dt">digits =</span> <span class="dv">0</span>)</a></code></pre></div>
<table>
<caption>Descriptive statistics for trial counts per lag</caption>
<thead>
<tr class="header">
<th align="left">lag</th>
<th align="right">mean</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">3</td>
<td align="right">130</td>
<td align="right">78</td>
<td align="right">163</td>
<td align="right">17</td>
</tr>
<tr class="even">
<td align="left">8</td>
<td align="right">65</td>
<td align="right">39</td>
<td align="right">87</td>
<td align="right">9</td>
</tr>
</tbody>
</table>
</div>
<div id="study-1" class="section level2">
<h2>Study 1</h2>
<p>These data were used for statistical analysis in London &amp; Slagter (2015)<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>, and were processed by the lead author:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">dataPath_study1 &lt;-<span class="st"> </span><span class="kw">here</span>(<span class="st">&quot;data&quot;</span>,<span class="st">&quot;AB-tDCS_study1.txt&quot;</span>)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2">data_study1_fromDisk &lt;-<span class="st"> </span><span class="kw">read.table</span>(dataPath_study1, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">dec =</span> <span class="st">&quot;,&quot;</span>)</a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="kw">glimpse</span>(data_study1_fromDisk)</a></code></pre></div>
<pre style = "max-height:300px; overflow-y: auto;">## Observations: 34
## Variables: 120
## $ SD_T1                           <dbl> 0.3313, 0.0289, -0.8027, -0.53...
## $ MeanBLT1Acc                     <dbl> 0.8800, 0.8600, 0.8050, 0.8225...
## $ First_Session                   <int> 1, 2, 1, 1, 2, 1, 2, 1, 2, 2, ...
## $ fileno                          <fct> pp4, pp6, pp7, pp9, pp10, pp11...
## $ AB_HighLow                      <dbl> 2, 1, 2, 1, 1, 1, 1, 1, 2, 1, ...
## $ vb_T1_2_NP                      <dbl> 0.925, 0.875, 0.825, 0.625, 0....
## $ vb_T1_4_NP                      <dbl> 0.800, 0.825, 0.825, 0.825, 0....
## $ vb_T1_10_NP                     <dbl> 0.925, 0.925, 0.800, 0.775, 0....
## $ vb_T1_4_P                       <dbl> 0.850, 0.900, 0.825, 0.775, 0....
## $ vb_T1_10_P                      <dbl> 0.825, 0.900, 0.775, 0.825, 0....
## $ vb_NB_2_NP                      <dbl> 0.1351, 0.3429, 0.3636, 0.3600...
## $ vb_NB_4_NP                      <dbl> 0.3125, 0.5455, 0.5455, 0.3030...
## $ vb_NB_10_NP                     <dbl> 0.8378, 0.8108, 0.9688, 0.6129...
## $ vb_NB_4_P                       <dbl> 0.2941, 0.5278, 0.6061, 0.3226...
## $ vb_NB_10_P                      <dbl> 0.8485, 0.7778, 0.9032, 0.8182...
## $ VB_AB                           <dbl> 0.7027, 0.4680, 0.6051, 0.2529...
## $ VB_REC                          <dbl> 0.5253, 0.2654, 0.4233, 0.3099...
## $ VB_PE                           <dbl> -0.0184, -0.0177, 0.0606, 0.01...
## $ tb_T1_2_NP                      <dbl> 0.775, 0.875, 0.675, 0.725, 0....
## $ tb_T1_4_NP                      <dbl> 0.825, 0.825, 0.700, 0.750, 0....
## $ tb_T1_10_NP                     <dbl> 0.875, 0.900, 0.700, 0.825, 0....
## $ tb_T1_4_P                       <dbl> 0.875, 0.800, 0.700, 0.775, 0....
## $ tb_T1_10_P                      <dbl> 0.850, 0.925, 0.800, 0.825, 0....
## $ tb_NB_2_NP                      <dbl> 0.1290, 0.5143, 0.2222, 0.0690...
## $ tb_NB_4_NP                      <dbl> 0.3333, 0.5455, 0.6071, 0.1333...
## $ tb_NB_10_NP                     <dbl> 0.8286, 0.8611, 0.8571, 0.5152...
## $ tb_NB_4_P                       <dbl> 0.3143, 0.6250, 0.5357, 0.4839...
## $ tb_NB_10_P                      <dbl> 0.8529, 0.7568, 0.9375, 0.6667...
## $ TB_AB                           <dbl> 0.6995, 0.3468, 0.6349, 0.4462...
## $ TB_REC                          <dbl> 0.4952, 0.3157, 0.2500, 0.3818...
## $ TB_PE                           <dbl> -0.0190, 0.0795, -0.0714, 0.35...
## $ nb_T1_2_NP                      <dbl> 0.850, 0.850, 0.650, 0.725, 0....
## $ nb_T1_4_NP                      <dbl> 0.800, 0.850, 0.725, 0.675, 0....
## $ nb_T1_10_NP                     <dbl> 0.925, 0.825, 0.750, 0.850, 0....
## $ nb_T1_4_P                       <dbl> 0.850, 0.900, 0.675, 0.750, 0....
## $ nb_T1_10_P                      <dbl> 0.900, 0.825, 0.750, 0.800, 0....
## $ nb_NB_2_NP                      <dbl> 0.0588, 0.4412, 0.4615, 0.1034...
## $ nb_NB_4_NP                      <dbl> 0.0938, 0.4412, 0.2414, 0.1481...
## $ nb_NB_10_NP                     <dbl> 0.8649, 0.7576, 0.9667, 0.6765...
## $ nb_NB_4_P                       <dbl> 0.4118, 0.7222, 0.4815, 0.3667...
## $ nb_NB_10_P                      <dbl> 0.8333, 0.8485, 0.8333, 0.7188...
## $ NB_AB                           <dbl> 0.8060, 0.3164, 0.5051, 0.5730...
## $ NB_REC                          <dbl> 0.7711, 0.3164, 0.7253, 0.5283...
## $ NB_PE                           <dbl> 0.3180, 0.2810, 0.2401, 0.2185...
## $ vd_T1_2_NP                      <dbl> 0.925, 0.875, 0.800, 0.850, 0....
## $ vd_T1_4_NP                      <dbl> 0.850, 0.825, 0.825, 0.925, 0....
## $ vd_T1_10_NP                     <dbl> 0.850, 0.900, 0.825, 0.925, 0....
## $ vd_T1_4_P                       <dbl> 0.925, 0.775, 0.825, 0.750, 0....
## $ vd_T1_10_P                      <dbl> 0.925, 0.800, 0.725, 0.950, 0....
## $ vd_NB_2_NP                      <dbl> 0.0541, 0.2857, 0.3125, 0.1765...
## $ vd_NB_4_NP                      <dbl> 0.2941, 0.4848, 0.4545, 0.2432...
## $ vd_NB_10_NP                     <dbl> 1.0000, 0.6667, 0.9394, 0.7838...
## $ vd_NB_4_P                       <dbl> 0.5135, 0.6774, 0.4848, 0.5000...
## $ vd_NB_10_P                      <dbl> 0.8919, 0.8125, 0.9310, 0.8421...
## $ VD_AB                           <dbl> 0.9459, 0.3810, 0.6269, 0.6073...
## $ VD_REC                          <dbl> 0.7059, 0.1818, 0.4848, 0.5405...
## $ VD_PE                           <dbl> 0.2194, 0.1926, 0.0303, 0.2568...
## $ td_T1_2_NP                      <dbl> 0.950, 0.775, 0.625, 0.775, 0....
## $ td_T1_4_NP                      <dbl> 0.975, 0.800, 0.800, 0.750, 0....
## $ td_T1_10_NP                     <dbl> 0.975, 0.900, 0.800, 0.850, 0....
## $ td_T1_4_P                       <dbl> 0.875, 0.800, 0.800, 0.800, 0....
## $ td_T1_10_P                      <dbl> 0.875, 0.800, 0.850, 0.700, 0....
## $ td_NB_2_NP                      <dbl> 0.1579, 0.3226, 0.5200, 0.1290...
## $ td_NB_4_NP                      <dbl> 0.4615, 0.4375, 0.3750, 0.2333...
## $ td_NB_10_NP                     <dbl> 0.9487, 0.6944, 0.9375, 0.6471...
## $ td_NB_4_P                       <dbl> 0.4571, 0.3750, 0.5625, 0.4063...
## $ td_NB_10_P                      <dbl> 0.8857, 0.6875, 0.8529, 0.7143...
## $ TD_AB                           <dbl> 0.7908, 0.3719, 0.4175, 0.5180...
## $ TD_REC                          <dbl> 0.4872, 0.2569, 0.5625, 0.4137...
## $ TD_PE                           <dbl> -0.0044, -0.0625, 0.1875, 0.17...
## $ nd_T1_2_NP                      <dbl> 0.700, 0.800, 0.650, 0.775, 0....
## $ nd_T1_4_NP                      <dbl> 0.850, 0.850, 0.725, 0.850, 0....
## $ nd_T1_10_NP                     <dbl> 0.800, 0.825, 0.800, 0.850, 0....
## $ nd_T1_4_P                       <dbl> 0.850, 0.800, 0.775, 0.775, 0....
## $ nd_T1_10_P                      <dbl> 0.850, 0.750, 0.800, 0.850, 0....
## $ nd_NB_2_NP                      <dbl> 0.0000, 0.2188, 0.2692, 0.0968...
## $ nd_NB_4_NP                      <dbl> 0.3824, 0.5000, 0.5172, 0.2353...
## $ nd_NB_10_NP                     <dbl> 0.8750, 0.5758, 0.8125, 0.7941...
## $ nd_NB_4_P                       <dbl> 0.4118, 0.5000, 0.5806, 0.5484...
## $ nd_NB_10_P                      <dbl> 0.9118, 0.7667, 0.8438, 0.8235...
## $ ND_AB                           <dbl> 0.8750, 0.3570, 0.5433, 0.6973...
## $ ND_REC                          <dbl> 0.4926, 0.0758, 0.2953, 0.5588...
## $ ND_PE                           <dbl> 0.0294, 0.0000, 0.0634, 0.3131...
## $ AnoMinBl_Lag2_NP                <dbl> -0.01, 0.17, -0.14, -0.29, -0....
## $ AnoMinBl_Lag10_NP               <dbl> -0.01, 0.05, -0.11, -0.10, 0.1...
## $ CathoMinBl_Lag2_NP              <dbl> 0.10, 0.04, 0.21, -0.05, -0.03...
## $ CathoMinBl_Lag10_NP             <dbl> -0.05, 0.03, 0.00, -0.14, 0.06...
## $ Tijdens_AnoMinBl_Lag2_NP        <dbl> -0.01, 0.17, -0.14, -0.29, -0....
## $ Tijdens_AnoMinBl_Lag10_NP       <dbl> -0.01, 0.05, -0.11, -0.10, 0.1...
## $ Tijdens_CathoMinBl_Lag2_NP      <dbl> 0.10, 0.04, 0.21, -0.05, -0.03...
## $ Tijdens_CathoMinBl_Lag10_NP     <dbl> -0.05, 0.03, 0.00, -0.14, 0.06...
## $ Tijdens_AnoMinBL_AB             <dbl> 0.00, -0.12, 0.03, 0.19, 0.15,...
## $ Tijdens_CathoMinBL_AB           <dbl> -0.16, -0.01, -0.21, -0.09, 0....
## $ Na_AnoMinBL_AB                  <dbl> 0.10, -0.15, -0.10, 0.32, 0.22...
## $ Na_CathoMinBL_AB                <dbl> -0.07, -0.02, -0.08, 0.09, -0....
## $ Tijdens_AnoMinBL_PE             <dbl> 0.00, 0.10, -0.13, 0.33, -0.06...
## $ Tijdens_CathoMinBL_PE           <dbl> -0.22, -0.26, 0.16, -0.08, 0.1...
## $ Na_CathoMinBL_PE                <dbl> -0.19, -0.19, 0.03, 0.06, 0.03...
## $ Na_AnoMinBL_PE                  <dbl> 0.34, 0.30, 0.18, 0.20, -0.02,...
## $ Tijdens_AnoMinBL_REC            <dbl> -0.03, 0.05, -0.17, 0.07, 0.05...
## $ Tijdens_CathoMinBL_REC          <dbl> -0.22, 0.08, 0.08, -0.13, 0.17...
## $ Na_CathoMinBL_REC               <dbl> -0.21, -0.11, -0.19, 0.02, -0....
## $ Na_AnoMinBL_REC                 <dbl> 0.25, 0.05, 0.30, 0.22, -0.01,...
## $ T1_Lag2_Tijdens_Ano_Min_BL_NP   <dbl> -0.15, 0.00, -0.15, 0.10, -0.1...
## $ T1_Lag2_Tijdens_Catho_Min_BL_NP <dbl> 0.02, -0.10, -0.18, -0.08, -0....
## $ T1_Lag2_Na_Ano_Min_BL_NP        <dbl> -0.08, -0.03, -0.18, 0.10, 0.0...
## $ T1_Lag2_Na_Catho_Min_BL_NP      <dbl> -0.23, -0.08, -0.15, -0.08, -0...
## $ T1_Lag4_Tijdens_Ano_Min_BL_NP   <dbl> 0.02, 0.00, -0.13, -0.08, 0.00...
## $ T1_Lag4_Tijdens_Catho_Min_BL_NP <dbl> 0.13, -0.02, -0.02, -0.18, -0....
## $ T1_Lag4_Na_Catho_Min_BL_NP      <dbl> 0.00, 0.03, -0.10, -0.08, -0.0...
## $ T1_Lag4_Na_Ano_Min_BL_NP        <dbl> 0.00, 0.03, -0.10, -0.15, -0.1...
## $ Mean_BL_PE                      <dbl> 0.10, 0.09, 0.05, 0.14, 0.15, ...
## $ ZVB_AB                          <dbl> 0.72613, -0.71847, 0.12559, -2...
## $ ZTB_AB                          <dbl> 0.97738, -1.74477, 0.47867, -0...
## $ ZNB_AB                          <dbl> 1.24043, -1.72891, -0.58440, -...
## $ ZVD_AB                          <dbl> 2.47191, -1.64491, 0.14714, 0....
## $ ZTD_AB                          <dbl> 1.39518, -1.23661, -0.94993, -...
## $ ZND_AB                          <dbl> 2.00765, -1.59142, -0.29725, 0...
## $ VB_T1_Acc_                      <dbl> 0.87, 0.89, 0.81, 0.77, 0.68, ...
## $ VD_T1_Acc_                      <dbl> 0.90, 0.84, 0.80, 0.88, 0.65, ...
</pre>
<p>We’ll use only a subset of columns, with the header structure <code>block/stim</code>_<code>target</code>_<code>lag</code>_<code>prime</code>, where:</p>
<ul>
<li><strong>block/stim</strong> is either:
<ol style="list-style-type: decimal">
<li><code>vb</code>: “anodal” tDCS, “pre” block (before tDCS)</li>
<li><code>tb</code>: “anodal” tDCS, “tDCS” block (during tDCS)</li>
<li><code>nb</code>: “anodal” tDCS, “post” block (after tDCS)</li>
<li><code>vd</code>: “cathodal” tDCS, “pre” block (before tDCS)</li>
<li><code>td</code>: “cathodal” tDCS, “tDCS” block (during tDCS)</li>
<li><code>nd</code>: “cathodal” tDCS, “post” block (after tDCS)</li>
</ol></li>
<li><strong>target</strong> is either:
<ol style="list-style-type: decimal">
<li><code>T1</code> (T1 accuracy): proportion of trials in which T1 was identified correctly</li>
<li><code>NB</code> (T2|T1 accuracy): proportion of trials in which T2 was identified correctly, given T1 was identified correctly</li>
</ol></li>
<li><strong>lag</strong> is either:
<ol style="list-style-type: decimal">
<li><code>2</code> (lag 2), when T2 followed T1 after 1 distractor</li>
<li><code>4</code> (lag 4), when T2 followed T1 after 3 distractors</li>
<li><code>10</code>, (lag 10), when T2 followed T1 after 9 distractors</li>
</ol></li>
<li><strong>prime</strong> is either:
<ol style="list-style-type: decimal">
<li><code>P</code> (prime): when the stimulus at lag 2 (in lag 4 or lag 10 trials) had the same identity as T2</li>
<li><code>NP</code> (no prime) when this was not the case. Study 2 had no primes, so we’ll only keep these.</li>
</ol></li>
</ul>
<p>We’ll also keep two more columns: <code>fileno</code> (participant ID) and <code>First_Session</code> (<code>1</code> meaning participants received anodal tDCS in the first session, <code>2</code> meaning participants received cathodal tDCS in the first session).</p>
<div id="reformat" class="section level3">
<h3>Reformat</h3>
<p>Now we’ll reformat the data to match the data frame for study 2:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">format_study2 &lt;-<span class="st"> </span><span class="cf">function</span>(df) {</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">  df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="st">    </span><span class="kw">select</span>(fileno, First_Session, <span class="kw">ends_with</span>(<span class="st">&quot;_NP&quot;</span>), <span class="op">-</span><span class="kw">contains</span>(<span class="st">&quot;Min&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># keep only relevant columns</span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="st">    </span><span class="kw">gather</span>(key, accuracy, <span class="op">-</span>fileno, <span class="op">-</span>First_Session) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># make long form</span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="st">    </span><span class="co"># split key column to create separate columns for each factor</span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="st">    </span><span class="kw">separate</span>(key, <span class="kw">c</span>(<span class="st">&quot;block&quot;</span>, <span class="st">&quot;stimulation&quot;</span>, <span class="st">&quot;target&quot;</span>, <span class="st">&quot;lag&quot;</span>), <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># split after 1st, 3rd, and 5th character</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="st">    </span><span class="co"># convert to factors, relabel levels to match those in study 2</span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">block =</span> <span class="kw">factor</span>(block, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;v&quot;</span>, <span class="st">&quot;t&quot;</span>, <span class="st">&quot;n&quot;</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;pre&quot;</span>, <span class="st">&quot;tDCS&quot;</span>, <span class="st">&quot;post&quot;</span>)),</a>
<a class="sourceLine" id="cb13-9" data-line-number="9">           <span class="dt">stimulation =</span> <span class="kw">factor</span>(stimulation, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;b_&quot;</span>, <span class="st">&quot;d_&quot;</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;anodal&quot;</span>, <span class="st">&quot;cathodal&quot;</span>)),</a>
<a class="sourceLine" id="cb13-10" data-line-number="10">           <span class="dt">lag =</span> <span class="kw">factor</span>(lag, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;_2_NP&quot;</span>, <span class="st">&quot;_4_NP&quot;</span>, <span class="st">&quot;_10_NP&quot;</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">10</span>)),</a>
<a class="sourceLine" id="cb13-11" data-line-number="11">           <span class="dt">First_Session =</span> <span class="kw">factor</span>(First_Session, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;anodal first&quot;</span>,<span class="st">&quot;cathodal first&quot;</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-12" data-line-number="12"><span class="st">    </span><span class="kw">spread</span>(target, accuracy) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># create separate columns for T2.given.T1 and T1 performance</span></a>
<a class="sourceLine" id="cb13-13" data-line-number="13"><span class="st">    </span><span class="kw">rename</span>(<span class="dt">T2.given.T1 =</span> NB, <span class="dt">session.order =</span> First_Session, <span class="dt">subject =</span> fileno)<span class="co"># rename columns to match those in study 2</span></a>
<a class="sourceLine" id="cb13-14" data-line-number="14">}</a></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">df_study1 &lt;-<span class="st"> </span><span class="kw">format_study2</span>(data_study1_fromDisk)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2">n_study1 &lt;-<span class="st"> </span><span class="kw">n_distinct</span>(df_study1<span class="op">$</span>subject) <span class="co"># number of subjects in study 1</span></a></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw">kable</span>(<span class="kw">head</span>(df_study1,<span class="dv">19</span>), <span class="dt">digits =</span> <span class="dv">1</span>, <span class="dt">caption =</span> <span class="st">&quot;Data frame for study 1&quot;</span>)</a></code></pre></div>
<table>
<caption>Data frame for study 1</caption>
<thead>
<tr class="header">
<th align="left">subject</th>
<th align="left">session.order</th>
<th align="left">block</th>
<th align="left">stimulation</th>
<th align="left">lag</th>
<th align="right">T2.given.T1</th>
<th align="right">T1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">pre</td>
<td align="left">anodal</td>
<td align="left">2</td>
<td align="right">0.3</td>
<td align="right">0.6</td>
</tr>
<tr class="even">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">pre</td>
<td align="left">anodal</td>
<td align="left">4</td>
<td align="right">0.3</td>
<td align="right">0.7</td>
</tr>
<tr class="odd">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">pre</td>
<td align="left">anodal</td>
<td align="left">10</td>
<td align="right">0.7</td>
<td align="right">0.8</td>
</tr>
<tr class="even">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">pre</td>
<td align="left">cathodal</td>
<td align="left">2</td>
<td align="right">0.2</td>
<td align="right">0.6</td>
</tr>
<tr class="odd">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">pre</td>
<td align="left">cathodal</td>
<td align="left">4</td>
<td align="right">0.4</td>
<td align="right">0.7</td>
</tr>
<tr class="even">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">pre</td>
<td align="left">cathodal</td>
<td align="left">10</td>
<td align="right">0.8</td>
<td align="right">0.8</td>
</tr>
<tr class="odd">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">tDCS</td>
<td align="left">anodal</td>
<td align="left">2</td>
<td align="right">0.3</td>
<td align="right">0.5</td>
</tr>
<tr class="even">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">tDCS</td>
<td align="left">anodal</td>
<td align="left">4</td>
<td align="right">0.4</td>
<td align="right">0.7</td>
</tr>
<tr class="odd">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">tDCS</td>
<td align="left">anodal</td>
<td align="left">10</td>
<td align="right">0.8</td>
<td align="right">0.5</td>
</tr>
<tr class="even">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">tDCS</td>
<td align="left">cathodal</td>
<td align="left">2</td>
<td align="right">0.1</td>
<td align="right">0.5</td>
</tr>
<tr class="odd">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">tDCS</td>
<td align="left">cathodal</td>
<td align="left">4</td>
<td align="right">0.3</td>
<td align="right">0.6</td>
</tr>
<tr class="even">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">tDCS</td>
<td align="left">cathodal</td>
<td align="left">10</td>
<td align="right">0.8</td>
<td align="right">0.6</td>
</tr>
<tr class="odd">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">post</td>
<td align="left">anodal</td>
<td align="left">2</td>
<td align="right">0.3</td>
<td align="right">0.7</td>
</tr>
<tr class="even">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">post</td>
<td align="left">anodal</td>
<td align="left">4</td>
<td align="right">0.5</td>
<td align="right">0.6</td>
</tr>
<tr class="odd">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">post</td>
<td align="left">anodal</td>
<td align="left">10</td>
<td align="right">0.9</td>
<td align="right">0.7</td>
</tr>
<tr class="even">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">post</td>
<td align="left">cathodal</td>
<td align="left">2</td>
<td align="right">0.2</td>
<td align="right">0.4</td>
</tr>
<tr class="odd">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">post</td>
<td align="left">cathodal</td>
<td align="left">4</td>
<td align="right">0.4</td>
<td align="right">0.6</td>
</tr>
<tr class="even">
<td align="left">pp10</td>
<td align="left">cathodal first</td>
<td align="left">post</td>
<td align="left">cathodal</td>
<td align="left">10</td>
<td align="right">0.7</td>
<td align="right">0.6</td>
</tr>
<tr class="odd">
<td align="left">pp11</td>
<td align="left">anodal first</td>
<td align="left">pre</td>
<td align="left">anodal</td>
<td align="left">2</td>
<td align="right">0.5</td>
<td align="right">1.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="questionnaires" class="section level1">
<h1>Questionnaires</h1>
<div id="demographics-study-2" class="section level2">
<h2>Demographics (study 2)</h2>
<p>Load and clean (exclude subjects with incomplete data, and S42 (who did not pass the screening, so had no data)):</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">subject_info &lt;-<span class="st"> </span><span class="kw">read_csv2</span>(<span class="kw">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;subject_info.csv&quot;</span>), <span class="dt">col_names =</span> <span class="ot">TRUE</span>, <span class="dt">progress =</span> <span class="ot">FALSE</span>, <span class="dt">col_types =</span> <span class="kw">cols</span>(</a>
<a class="sourceLine" id="cb16-2" data-line-number="2">  <span class="dt">first.session =</span> readr<span class="op">::</span><span class="kw">col_factor</span>(<span class="kw">c</span>(<span class="st">&quot;anodal&quot;</span>, <span class="st">&quot;cathodal&quot;</span>)),</a>
<a class="sourceLine" id="cb16-3" data-line-number="3">  <span class="dt">gender =</span> readr<span class="op">::</span><span class="kw">col_factor</span>(<span class="kw">c</span>(<span class="st">&quot;male&quot;</span>, <span class="st">&quot;female&quot;</span>)),</a>
<a class="sourceLine" id="cb16-4" data-line-number="4">  <span class="dt">age =</span> <span class="kw">col_integer</span>())) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span>(subject <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(subs_incomplete, <span class="st">&quot;S42&quot;</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-6" data-line-number="6"><span class="st">   </span><span class="co"># recode first.session (&quot;anodal&quot; or &quot;cathodal&quot;) to session.order (&quot;anodal first&quot;, &quot;cathodal first&quot;)</span></a>
<a class="sourceLine" id="cb16-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">first.session =</span> <span class="kw">parse_factor</span>(<span class="kw">paste</span>(first.session, <span class="st">&quot;first&quot;</span>), </a>
<a class="sourceLine" id="cb16-8" data-line-number="8">                                      <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;anodal first&quot;</span>, <span class="st">&quot;cathodal first&quot;</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-9" data-line-number="9"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">session.order =</span> first.session)</a></code></pre></div>
<pre><code>## Using &#39;,&#39; as decimal and &#39;.&#39; as grouping mark. Use read_delim() for more control.</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw">kable</span>(<span class="kw">head</span>(subject_info,<span class="dv">5</span>), <span class="dt">caption =</span> <span class="st">&quot;Demographics in study 2&quot;</span>)</a></code></pre></div>
<table>
<caption>Demographics in study 2</caption>
<thead>
<tr class="header">
<th align="left">subject</th>
<th align="left">session.order</th>
<th align="left">gender</th>
<th align="right">age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">S01</td>
<td align="left">anodal first</td>
<td align="left">female</td>
<td align="right">20</td>
</tr>
<tr class="even">
<td align="left">S02</td>
<td align="left">cathodal first</td>
<td align="left">female</td>
<td align="right">19</td>
</tr>
<tr class="odd">
<td align="left">S04</td>
<td align="left">anodal first</td>
<td align="left">female</td>
<td align="right">21</td>
</tr>
<tr class="even">
<td align="left">S05</td>
<td align="left">anodal first</td>
<td align="left">female</td>
<td align="right">18</td>
</tr>
<tr class="odd">
<td align="left">S06</td>
<td align="left">cathodal first</td>
<td align="left">female</td>
<td align="right">20</td>
</tr>
</tbody>
</table>
<p>Analyze:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">subject_info <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="st"> </span><span class="kw">count</span>(gender) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="st">  </span><span class="kw">kable</span>(<span class="dt">caption =</span> <span class="st">&quot;Gender breakdown in study 2&quot;</span>)</a></code></pre></div>
<table>
<caption>Gender breakdown in study 2</caption>
<thead>
<tr class="header">
<th align="left">gender</th>
<th align="right">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">male</td>
<td align="right">11</td>
</tr>
<tr class="even">
<td align="left">female</td>
<td align="right">29</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">subject_info <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="st">  </span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(age), <span class="kw">funs</span>(mean, min, max, sd), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># apply summary functions to age column</span></a>
<a class="sourceLine" id="cb20-3" data-line-number="3"><span class="st">  </span><span class="kw">kable</span>(<span class="dt">digits =</span> <span class="dv">2</span>, <span class="dt">caption =</span> <span class="st">&quot;Age descriptives in study 2&quot;</span>)</a></code></pre></div>
<table>
<caption>Age descriptives in study 2</caption>
<thead>
<tr class="header">
<th align="right">mean</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">20.94</td>
<td align="right">18</td>
<td align="right">28</td>
<td align="right">2.48</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">subject_info <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="st"> </span><span class="kw">count</span>(session.order) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-3" data-line-number="3"><span class="st">  </span><span class="kw">kable</span>(<span class="dt">caption =</span> <span class="st">&quot;Session order breakdown in study 2&quot;</span>)</a></code></pre></div>
<table>
<caption>Session order breakdown in study 2</caption>
<thead>
<tr class="header">
<th align="left">session.order</th>
<th align="right">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">anodal first</td>
<td align="right">18</td>
</tr>
<tr class="even">
<td align="left">cathodal first</td>
<td align="right">22</td>
</tr>
</tbody>
</table>
</div>
<div id="tdcs-adverse-events-study-2" class="section level2">
<h2>tDCS adverse events (study 2)</h2>
<div id="data" class="section level3">
<h3>Data</h3>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">tDCS_AE &lt;-<span class="st"> </span><span class="kw">read_csv2</span>(<span class="kw">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;tDCS_AE.csv&quot;</span>), <span class="dt">col_names =</span> <span class="ot">TRUE</span>, <span class="dt">progress =</span> <span class="ot">FALSE</span>, <span class="dt">col_types =</span> <span class="kw">cols</span>(</a>
<a class="sourceLine" id="cb22-2" data-line-number="2">  <span class="dt">session =</span> readr<span class="op">::</span><span class="kw">col_factor</span>(<span class="kw">c</span>(<span class="st">&quot;first&quot;</span>, <span class="st">&quot;second&quot;</span>)), </a>
<a class="sourceLine" id="cb22-3" data-line-number="3">  <span class="dt">stimulation =</span> readr<span class="op">::</span><span class="kw">col_factor</span>(<span class="kw">c</span>(<span class="st">&quot;anodal&quot;</span>, <span class="st">&quot;cathodal&quot;</span>))))</a></code></pre></div>
<pre><code>## Using &#39;,&#39; as decimal and &#39;.&#39; as grouping mark. Use read_delim() for more control.</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw">glimpse</span>(tDCS_AE)</a></code></pre></div>
<pre>## Observations: 98
## Variables: 20
## $ subject        <chr> "S01", "S01", "S02", "S02", "S03", "S03", "S04"...
## $ session        <fct> first, second, first, second, first, second, fi...
## $ stimulation    <fct> anodal, cathodal, cathodal, anodal, cathodal, a...
## $ itching        <int> 1, 1, 0, 0, 0, 2, 1, 2, 1, 1, 1, 1, 2, 1, 0, 0,...
## $ tingling       <int> 1, 1, 3, 1, 1, 1, 3, 0, 2, 2, 0, 1, 2, 1, 1, 1,...
## $ burning        <int> 2, 0, 3, 0, 0, 0, 1, 0, 2, 2, 0, 0, 1, 0, 1, 1,...
## $ pain           <int> 0, 0, 1, 0, 0, 0, 1, 1, 0, 0, 3, 0, 0, 0, 0, 0,...
## $ headache       <int> 1, 0, 2, 1, 1, 0, 0, 3, 1, 1, 2, 4, 0, 0, 0, 1,...
## $ fatigue        <int> 1, 0, 1, 0, 0, 0, 2, 3, 2, 2, 2, 4, 1, 1, 2, 2,...
## $ dizziness      <int> 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0,...
## $ nausea         <int> 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0,...
## $ conf.itching   <int> 3, 3, 0, 0, 0, 4, 3, 3, 3, 3, 4, 4, 4, 3, 0, 0,...
## $ conf.tingling  <int> 2, 3, 4, 4, 4, 3, 4, 0, 3, 3, 0, 4, 4, 3, 4, 4,...
## $ conf.burning   <int> 3, 0, 4, 0, 0, 0, 3, 0, 4, 3, 0, 0, 4, 0, 4, 4,...
## $ conf.pain      <int> 0, 0, 3, 0, 0, 0, 3, 3, 0, 0, 4, 0, 0, 0, 0, 0,...
## $ conf.headache  <int> 2, 0, 3, 2, 2, 0, 0, 2, 2, 2, 0, 0, 0, 0, 0, 2,...
## $ conf.fatigue   <int> 1, 0, 1, 0, 0, 0, 0, 1, 2, 2, 0, 0, 2, 1, 3, 3,...
## $ conf.dizziness <int> 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0,...
## $ conf.nausea    <int> 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 2, 0, 0, 0,...
## $ notes          <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, "During...
</pre>
<p>Participants were asked to which degree the following sensations were present during stimulation: <em>tingling</em>, <em>itching sensation</em>, <em>burning sensation</em>, <em>pain</em>, <em>headache</em>, <em>fatigue</em>, <em>dizziness</em> and <em>nausea</em>. Each was rated on a scale from 0-4:</p>
<ol start="0" style="list-style-type: decimal">
<li>none</li>
<li>a little</li>
<li>moderate</li>
<li>strong</li>
<li>very strong</li>
</ol>
<p>They also rated their confidence <em>that the sensations were caused by the stimulation</em> on a scale from 0-4 (columns starting with <code>conf.</code>):</p>
<ol start="0" style="list-style-type: decimal">
<li>n/a (meaning they rated the sensation a 0 on the previous scale)</li>
<li>unlikely</li>
<li>possibly</li>
<li>likely</li>
<li>very likely</li>
</ol>
<p><strong>Factors</strong>:</p>
<ul>
<li><em>subject</em>: subject ID (<code>S01</code>, <code>S02</code>, etc)</li>
<li><em>session</em>: Whether data are from the <code>first</code> or <code>second</code> session</li>
<li><em>stimulation</em>: Whether data are from the <code>anodal</code> or <code>cathodal</code> session</li>
</ul>
<p>Let’s see how many data points we have:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">tDCS_AE <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb25-2" data-line-number="2"><span class="st">  </span><span class="kw">count</span>(stimulation) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb25-3" data-line-number="3"><span class="st">  </span><span class="kw">kable</span>(<span class="dt">caption =</span> <span class="st">&quot;number of completed questionnaires per stimulation type&quot;</span>)</a></code></pre></div>
<table>
<caption>number of completed questionnaires per stimulation type</caption>
<thead>
<tr class="header">
<th align="left">stimulation</th>
<th align="right">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">anodal</td>
<td align="right">46</td>
</tr>
<tr class="even">
<td align="left">cathodal</td>
<td align="right">43</td>
</tr>
<tr class="odd">
<td align="left">NA</td>
<td align="right">9</td>
</tr>
</tbody>
</table>
<p>This is more than the number of subjects (and not the same for anodal and cathodal), because there are a few subjects that only did one session.</p>
<p>For further analysis, make the data long form to easily analyse sensations separately:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="co"># Make long form data frame of sensation intensity</span></a>
<a class="sourceLine" id="cb26-2" data-line-number="2">intensity &lt;-<span class="st"> </span>tDCS_AE <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb26-3" data-line-number="3"><span class="st">  </span><span class="kw">select</span>(<span class="kw">everything</span>(), <span class="op">-</span><span class="kw">contains</span>(<span class="st">&quot;conf&quot;</span>), <span class="op">-</span>notes) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># drop other columns</span></a>
<a class="sourceLine" id="cb26-4" data-line-number="4"><span class="st">  </span><span class="kw">gather</span>(sensation, intensity, itching<span class="op">:</span>nausea) <span class="co"># make long form </span></a>
<a class="sourceLine" id="cb26-5" data-line-number="5"></a>
<a class="sourceLine" id="cb26-6" data-line-number="6"><span class="co"># Make long form data frame of sensation confidence</span></a>
<a class="sourceLine" id="cb26-7" data-line-number="7">confidence &lt;-<span class="st"> </span>tDCS_AE <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb26-8" data-line-number="8"><span class="st">  </span><span class="kw">select</span>(<span class="kw">contains</span>(<span class="st">&quot;conf&quot;</span>), subject, session, stimulation) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb26-9" data-line-number="9"><span class="st">  </span><span class="kw">gather</span>(sensation, confidence, conf.itching<span class="op">:</span>conf.nausea) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb26-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sensation =</span> <span class="kw">str_replace</span>(sensation, <span class="st">&quot;conf.&quot;</span>, <span class="st">&quot;&quot;</span>)) <span class="co"># get rid of &quot;conf.&quot; prefix so it matches the sensation intensity table</span></a></code></pre></div>
<p>Let’s see which sensations are reported most frequently, along with their mean level of confidence:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="kw">full_join</span>(intensity,confidence) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb27-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(sensation) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb27-3" data-line-number="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">count =</span> <span class="kw">sum</span>(intensity <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="co"># count all occurences (rating &quot;0&quot; means no occurence)</span></a>
<a class="sourceLine" id="cb27-4" data-line-number="4">            <span class="dt">mean =</span> <span class="kw">mean</span>(confidence, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb27-5" data-line-number="5"><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(count)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># most frequent at the top</span></a>
<a class="sourceLine" id="cb27-6" data-line-number="6"><span class="st">  </span><span class="kw">kable</span>(<span class="dt">digits =</span> <span class="dv">1</span>)</a></code></pre></div>
<pre><code>## Joining, by = c(&quot;subject&quot;, &quot;session&quot;, &quot;stimulation&quot;, &quot;sensation&quot;)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">sensation</th>
<th align="right">count</th>
<th align="right">mean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">tingling</td>
<td align="right">73</td>
<td align="right">2.9</td>
</tr>
<tr class="even">
<td align="left">itching</td>
<td align="right">53</td>
<td align="right">2.0</td>
</tr>
<tr class="odd">
<td align="left">fatigue</td>
<td align="right">52</td>
<td align="right">0.8</td>
</tr>
<tr class="even">
<td align="left">burning</td>
<td align="right">40</td>
<td align="right">1.6</td>
</tr>
<tr class="odd">
<td align="left">headache</td>
<td align="right">27</td>
<td align="right">0.6</td>
</tr>
<tr class="even">
<td align="left">pain</td>
<td align="right">11</td>
<td align="right">0.4</td>
</tr>
<tr class="odd">
<td align="left">dizziness</td>
<td align="right">6</td>
<td align="right">0.2</td>
</tr>
<tr class="even">
<td align="left">nausea</td>
<td align="right">5</td>
<td align="right">0.2</td>
</tr>
</tbody>
</table>
<p>Plot all of the data:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="kw">full_join</span>(intensity,confidence)  <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb29-2" data-line-number="2"><span class="st">  </span><span class="kw">gather</span>(measure, rating, intensity, confidence) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># gather confidence/intensity to make one plot for each</span></a>
<a class="sourceLine" id="cb29-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">measure =</span> <span class="kw">factor</span>(measure, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;intensity&quot;</span>, <span class="st">&quot;confidence&quot;</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb29-4" data-line-number="4"><span class="st">  </span></a>
<a class="sourceLine" id="cb29-5" data-line-number="5"><span class="st">   </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> rating, <span class="dt">fill =</span> stimulation)) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-6" data-line-number="6"><span class="st">     </span><span class="kw">facet_grid</span>(measure <span class="op">~</span><span class="st"> </span><span class="kw">fct_reorder</span>(sensation, rating, <span class="dt">.fun =</span> <span class="cf">function</span>(x) <span class="kw">sum</span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dt">.desc =</span> <span class="ot">TRUE</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-7" data-line-number="7"><span class="st">    </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="st">&quot;stack&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-8" data-line-number="8"><span class="st">    </span><span class="kw">stat_bin</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">size =</span> <span class="fl">2.5</span>, <span class="kw">aes</span>(<span class="dt">label =</span> ..count..), <span class="dt">position =</span> <span class="kw">position_stack</span>(<span class="dt">vjust =</span> <span class="fl">0.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-9" data-line-number="9"><span class="st">    </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#F25F5C&quot;</span>, <span class="st">&quot;#4B93B1&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-10" data-line-number="10"><span class="st">    </span><span class="kw">xlim</span>(<span class="fl">0.5</span>,<span class="fl">4.5</span>) <span class="op">+</span><span class="st"> </span><span class="co"># exclude &quot;0&quot; ratings that were not present</span></a>
<a class="sourceLine" id="cb29-11" data-line-number="11"><span class="st">    </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(tDCS_AE<span class="op">$</span>stimulation))) <span class="op">+</span><span class="st"> </span><span class="co"># bound plot at max number of ratings</span></a>
<a class="sourceLine" id="cb29-12" data-line-number="12"><span class="st">    </span><span class="kw">ylab</span>(<span class="st">&quot;number of sessions&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-13" data-line-number="13"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;tDCS adverse events&quot;</span>, <span class="dt">subtitle =</span> <span class="st">&quot;sensations arranged in descending order of frequency&quot;</span>)</a></code></pre></div>
<pre><code>## Joining, by = c(&quot;subject&quot;, &quot;session&quot;, &quot;stimulation&quot;, &quot;sensation&quot;)</code></pre>
<pre><code>## Warning: Removed 1037 rows containing non-finite values (stat_count).</code></pre>
<pre><code>## Warning: Removed 1037 rows containing non-finite values (stat_bin).</code></pre>
<pre><code>## Warning: position_stack requires non-overlapping x intervals</code></pre>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_bar).</code></pre>
<p><img src="AB-tDCS_questionnaires_files/figure-html/plot%20AE%20data-1.png" width="576" /></p>
<p>The physical and local sensations (tingling, itching, burning) are most frequent, but these are fairly common and innocuous. Fatigue is also frequent, but there the confidence ratings are highly skewed: participants don’t seem to attribute it to the tDCS. This makes sense as they’ve just done a task for an hour. Headache is still fairly frequent, and has confidence ratings in the middle, which makes sense as headaches often feel “diffuse”. Pain, dizziness and nausea are very rare, and generally low in intensity.</p>
</div>
</div>
<div id="statistics" class="section level2">
<h2>Statistics</h2>
<p>Paired Wilcoxon tests for each sensation:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1">intensity <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span>(subject <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(subs_incomplete, <span class="st">&quot;S42&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># set of subjects for which task data are analyzed</span></a>
<a class="sourceLine" id="cb35-3" data-line-number="3"><span class="st">  </span><span class="kw">group_by</span>(sensation) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-4" data-line-number="4"><span class="st">  </span><span class="kw">nest</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">stats =</span> <span class="kw">map</span>(data, <span class="op">~</span><span class="kw">tidy</span>(<span class="kw">wilcox.test</span>(intensity <span class="op">~</span><span class="st"> </span>stimulation, <span class="dt">paired =</span> <span class="ot">TRUE</span>, <span class="dt">data =</span> .)))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-6" data-line-number="6"><span class="st">  </span><span class="kw">unnest</span>(stats, <span class="dt">.drop =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-7" data-line-number="7"><span class="st">  </span><span class="kw">kable</span>(<span class="dt">digits =</span> <span class="dv">3</span>, <span class="dt">caption =</span> <span class="st">&quot;Paired tests of anodal vs. cathodal for each sensation intensity&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in wilcox.test.default(x = c(1L, 0L, 1L, 1L, 1L, 2L, 0L, 1L, 1L, :
## cannot compute exact p-value with ties</code></pre>
<pre><code>## Warning in wilcox.test.default(x = c(1L, 0L, 1L, 1L, 1L, 2L, 0L, 1L, 1L, :
## cannot compute exact p-value with zeroes</code></pre>
<pre><code>## Warning in wilcox.test.default(x = c(1L, 1L, 3L, 2L, 1L, 2L, 1L, 0L, 1L, :
## cannot compute exact p-value with ties</code></pre>
<pre><code>## Warning in wilcox.test.default(x = c(1L, 1L, 3L, 2L, 1L, 2L, 1L, 0L, 1L, :
## cannot compute exact p-value with zeroes</code></pre>
<pre><code>## Warning in wilcox.test.default(x = c(2L, 0L, 1L, 2L, 0L, 1L, 1L, 0L, 0L, :
## cannot compute exact p-value with ties</code></pre>
<pre><code>## Warning in wilcox.test.default(x = c(2L, 0L, 1L, 2L, 0L, 1L, 1L, 0L, 0L, :
## cannot compute exact p-value with zeroes</code></pre>
<pre><code>## Warning in wilcox.test.default(x = c(0L, 0L, 1L, 0L, 0L, 0L, 0L, 0L, 0L, :
## cannot compute exact p-value with ties</code></pre>
<pre><code>## Warning in wilcox.test.default(x = c(0L, 0L, 1L, 0L, 0L, 0L, 0L, 0L, 0L, :
## cannot compute exact p-value with zeroes</code></pre>
<pre><code>## Warning in wilcox.test.default(x = c(1L, 1L, 0L, 1L, 4L, 0L, 0L, 3L, 0L, :
## cannot compute exact p-value with ties</code></pre>
<pre><code>## Warning in wilcox.test.default(x = c(1L, 1L, 0L, 1L, 4L, 0L, 0L, 3L, 0L, :
## cannot compute exact p-value with zeroes</code></pre>
<pre><code>## Warning in wilcox.test.default(x = c(1L, 0L, 2L, 2L, 4L, 1L, 2L, 2L, 0L, :
## cannot compute exact p-value with ties</code></pre>
<pre><code>## Warning in wilcox.test.default(x = c(1L, 0L, 2L, 2L, 4L, 1L, 2L, 2L, 0L, :
## cannot compute exact p-value with zeroes</code></pre>
<pre><code>## Warning in wilcox.test.default(x = c(0L, 0L, 0L, 0L, 0L, 1L, 0L, 0L, 0L, :
## cannot compute exact p-value with ties</code></pre>
<pre><code>## Warning in wilcox.test.default(x = c(0L, 0L, 0L, 0L, 0L, 1L, 0L, 0L, 0L, :
## cannot compute exact p-value with zeroes</code></pre>
<pre><code>## Warning in wilcox.test.default(x = c(0L, 0L, 0L, 0L, 0L, 1L, 0L, 0L, 0L, :
## cannot compute exact p-value with ties</code></pre>
<pre><code>## Warning in wilcox.test.default(x = c(0L, 0L, 0L, 0L, 0L, 1L, 0L, 0L, 0L, :
## cannot compute exact p-value with zeroes</code></pre>
<table>
<caption>Paired tests of anodal vs. cathodal for each sensation intensity</caption>
<thead>
<tr class="header">
<th align="left">sensation</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="left">method</th>
<th align="left">alternative</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">itching</td>
<td align="right">97.0</td>
<td align="right">0.949</td>
<td align="left">Wilcoxon signed rank test with continuity correction</td>
<td align="left">two.sided</td>
</tr>
<tr class="even">
<td align="left">tingling</td>
<td align="right">113.0</td>
<td align="right">0.942</td>
<td align="left">Wilcoxon signed rank test with continuity correction</td>
<td align="left">two.sided</td>
</tr>
<tr class="odd">
<td align="left">burning</td>
<td align="right">131.0</td>
<td align="right">0.591</td>
<td align="left">Wilcoxon signed rank test with continuity correction</td>
<td align="left">two.sided</td>
</tr>
<tr class="even">
<td align="left">pain</td>
<td align="right">6.0</td>
<td align="right">0.395</td>
<td align="left">Wilcoxon signed rank test with continuity correction</td>
<td align="left">two.sided</td>
</tr>
<tr class="odd">
<td align="left">headache</td>
<td align="right">49.5</td>
<td align="right">0.871</td>
<td align="left">Wilcoxon signed rank test with continuity correction</td>
<td align="left">two.sided</td>
</tr>
<tr class="even">
<td align="left">fatigue</td>
<td align="right">82.5</td>
<td align="right">0.232</td>
<td align="left">Wilcoxon signed rank test with continuity correction</td>
<td align="left">two.sided</td>
</tr>
<tr class="odd">
<td align="left">dizziness</td>
<td align="right">1.5</td>
<td align="right">1.000</td>
<td align="left">Wilcoxon signed rank test with continuity correction</td>
<td align="left">two.sided</td>
</tr>
<tr class="even">
<td align="left">nausea</td>
<td align="right">2.0</td>
<td align="right">0.773</td>
<td align="left">Wilcoxon signed rank test with continuity correction</td>
<td align="left">two.sided</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>London, R. E., &amp; Slagter, H. A. (2015). Effects of transcranial direct current stimulation over left dorsolateral pFC on the attentional blink depend on individual baseline performance. <em>Journal of Cognitive Neuroscience, 27(12)</em>, 2382-2393. doi: <a href="https://doi.org/10.1162/jocn_a_00867">10.1162/jocn_a_00867</a><a href="#fnref1" class="footnote-back">↩</a></p></li>
</ol>
</div>
</div>


    </div>
    <div class="col-md-2">
      <div id="toc">
      	<button type="button" class="close">×</button>
        <ul>
        <li><a href="#setup-environment">Setup environment</a></li>
        <li><a href="#load-task-data">Load task data</a><ul>
        <li><a href="#study-2">Study 2</a></li>
        <li><a href="#study-1">Study 1</a></li>
        </ul></li>
        <li><a href="#questionnaires">Questionnaires</a><ul>
        <li><a href="#demographics-study-2">Demographics (study 2)</a></li>
        <li><a href="#tdcs-adverse-events-study-2">tDCS adverse events (study 2)</a></li>
        <li><a href="#statistics">Statistics</a></li>
        </ul></li>
        </ul>
      </div>
    </div>
  </div>
</div>

<script>
$(document).ready(function () {

  // add bootstrap table styles to pandoc tables
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');

});
</script>

<script>
$(document).ready(function () {
 	 	$('#content img')
 	  .addClass("image-thumb");
      $('#content img')
 	  .addClass("image-lb");
  $('#content').magnificPopup({
	      type:'image',
	      closeOnContentClick: false,
	      delegate: 'img',
	      gallery: {enabled: true },
	      image: {
	        verticalFit: true,
          titleSrc: 'alt'
	      }
 	    });
 	});
</script>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
